<plain_text><page sequence="1">871111 Establishing Initial Equilibrium Positions for Crash Victim Simulators E. Debra O'Leary Transportation Systems Center Research &amp; Special Programs Administration U.S. Department of Transportation ABSTRACT In the utilization of crash victim com- puter simulations, the task of establishing the initial equilibrium position of the seated occupant or anthropomorphic dummy is usually tedious. This paper presents the derivation of the system of nonlinear equations required for obtaining equilibrium, the computer code for the solution of these equations, and a number of sample solutions for various vehicle interior geometries using a typical seat force- deflection curve and occupant size. A sensi- tivity study that shows the effect of devia- tions from equilibrium on results obtained from simulations utilizing the MVMA 2-D crash victim simulation program (1)* is also presented. The computer code was tested in conjunction with MVMA 2-D simulations and was found to be advantageous as compared to manual methods, in terms of establishing standardized procedures and saving time. IN THE UTILIZATION of crash victim simulators such as MVMA 2-D, it is required that the occupant (or anthropomorphic dummy) used in the simulation be in equilibrium at the start of the crash event. Lack of equilibrium will cause spurious forces to be exerted by the seat and floorboard on the occupant. These spurious forces may affect the computed kine- matics and the resulting impact forces on the occupant. This paper presents an automated method to replace the more tedious iterative techniques generally used for the determina- tion of initial equilibrium when utilizing crash victim simulators. The paper also provides code for estab- lishing the initial trial values for the 61 unknown variables in the nonlinear equations. These are derived from the user's initial guess of the position of the center of gravity ♦Numbers in parenthesis designate references at the end of the pa~y of the occupant's chest and four limb angles. The method allows for bilinear force- deflection characteristics of the seat cushion and seat back and for the restoring moments at the joints. (Limb 6 top-angles are defined as in MVMA 2-D. ) Friction between the seat and the occupant is also allowed if desired. The program utilizes the IMSL subroutine ZSCNT(2). However, the computer code can be modified to utilize other subroutines that solve large systems of nonlinear algebraic equations. THE MODEL The formulation and code presented in this paper was primarily designed for the user of the MVMA 2-D crash victim simulator. However, it could be adapted for use with other simulators. Figure 1 describes the model utilized for deriving the equilibrium equations. The occupant is represented by five body links. The body segments and the identi- fying numbers of the joints these links con- nect (Fig. 1) are: upper torso 2,3 lower torso 3 , 4 hip 4,5 upper leg 5,6 lower leg 6 , 7 The head and neck are treated as a com- bined weight (WH and WN, Fig. A-l) acting on joint 2. Similarly, the occupant's arms are represented as a weight (W22, Fig. A-l) acting on link 2-3 through a moment arm. The body segments that contact the seat and the floor (Fig. 1) are represented by the upper torso ellipse, the hip circle, the upper leg el- lipse, and the foot circle. These accommodate five contact points as shown. Figures A-l through A-5 in Appendix A show the free body diagrams for each link. It is also to be noted that for clarity in Figures A-l and A-4 the links have been drawn outside the el- lipses. In addition to the internal forces acting on the joints, torsional springs can be 3 299 0096-736X/88/9603-0299$02.50 Copyright 1988 Society of Automotive Engineers, Inc.</page><page sequence="2">UPPER TORSO ^ UPPER LEG 't '. 7T ^ r""^ I CUSHION ' / CONTACT FORCES V J s' ' ' ' I T0EB0AR0 FLOORBOARD | Figure 1 - Occupant Model specified at joints 3, 4, and 5. These are defined by bilinear torque vs. relative angle curves and joint stop angles (Fig. 2) Ē The seat back and seat cushion are also repre- sented as initially planar surfaces with bilinear load-deflection characteristics (Fig. 3) while the body segments are represented as rigid ellipses (user-defined minor and major semi-axes). If desired, the compliance of the ellipses can be included in the force- deflection characteristics of the seat, and the inclusion of seat friction is optional. The equilibrium equations for the model are given in Appendix A. (In Figures A-l through A-5, several dimension arrowheads were deleted in order to indicate positive directions . ) COMPUTER CODES The computer codes given in Appendices B and C solve the set of the 61 nonlinear trans- cendental equations given in Appendix A. Appendix B provides the code for the solution of these equations utilizing the subroutine ZSCNT from the IMSL Library. Appendix C provides a preprocessor for obtaining initial values required for the computations . The user must supply 6 guesses for the angles of the upper torso, lower torso, hip, and upper leg, and the location of the X and Z coordi- nates of the upper torso center of gravity to obtain consistent initial guesses for all 61 variables . The organization of the two computer codes requires the following input files: A. Main program (Appendix B) 1. File 1 (user defined name): a) occupant characteristics b) seat and floor geometry c) seat and floor force- deflection characteristics 2ā File 2 (XEQU.DAT): output from preprocessor (see B. , below) B. Preprocessor (Appendix C) 1. File 1 (same as in A. 1 above) 2. Initial estimate of four limb angles and two coordinates for chest center of gravity TORQUE /jK2 LOWER STOP ^ ! ^^ZERO TORQUE UPPER RELATIVE ANGLE j ANGLE STOP A K2 ♦SYMBOLS DEFINED IN APPENDIX A Figure 2 - Relationship Between Joint Torques and Relative Link Angles FORCE i i F9 -Tļ 1 1 ► D8 * D9 DEFLECTION ♦SYMBOLS DEFINED IN APPENDIX A Figure 3 - Seat Force-Deflection Curve The occupant characteristics are derived from the MVMA-2D occupant file and include body segment masses and lengths, contact el- lipse specifications, joint parameters, and link angles of zero torque. Table B-l, Appen- dix B, shows the correspondence between MVMA 2-D variables and the variables used herein. The output of the main program provides the coordinates of the center of gravity of the upper torso and the five link angles required for equilibrium. Table 1 shows a segment of the output. TYPICAL RESULTS AND DISCUSSION Table 2 shows the typical variation of link angles and chest coordinates as a func- tion of variations in seat geometry. The occu- pant characteristics, the seat and floor load- 3.300</page><page sequence="3">871111 Table 1 - Program Output Segment (angles in degrees; distances in Inches; forces in lb*) UPPER TORSO LONER TORSO HIP UPPER LE6 LONER LEO AN6LE 7.103 39.018 64.304 21.794 47.002 HVHA AN6LE 97.103 129.018 1S4.384 21.794 -42.918 SEAT BACK FORCE 41.093 0.000 SEAT CUSH. FORCE 132.919 16.296 FLOORBOARD FORCE 10.148 SEAT BACK DEFL 1.898 0.000 SEAT CUSH. OEFL 3.216 0.798 FLOORBOARD DEFL 0.010 LIHB Ï COORD 21.413 22.964 26.583 29.955 44.651 LIHB I COORD -33.327 -21.022 -16.556 -14.939 -20.815 LIHB FORCE -1 0.000 38.615 38.615 4.217 0.000 LIHB FORCE -Z 13.513 56.600 63.550 -21.214 9.929 UPPER TORSO C.G. I 6 I COORDS ARE: 22.117 -27.741 Table 2 - Typical Equilibrium Positions for Various Seat Geometries (50TH Percentile Oocupant) AN6LES, DEGREES ! DISTANCES, INCHES, . food INTERSECTION OF SEAT SEAT UPPER LONER HIP UPPER LONER ! SEAT RACK t SEAT CUSHION SACK CUSHION TORSO TORSO LE6 LE6 ! Xl ZI H 15. 17. -7.59 24.77 52.10 16.62 37.80 0.63 15.42 7.84 16. 15. -7.98 24.39 51.25 15.46 42.51 0.75 15.27 7.46 19. 8. -9.94 22.60 48.17 11.46 45.65 0.28 14.81 8.62 21. 13. -3.68 28.41 53.55 16.79 37.19 1.66 14.72 8.38 23. 12. -1.65 30.31 54.73 17.57 44.19 2.01 14.45 6.91 23. 15. 0.04 31.89 56.58 19.65 42.27 2.45 14.51 6.47 24. 12. -0.20 31.67 55.76 18.44 36.37 2.28 14.29 8.21 24. 13. 0.31 32.14 56.32 19.08 32.70 2.42 14.33 8.57 25. 17. 3.59 35.24 59.52 22.46 28.88 3.22 14.28 7.91 25. 18. 4.06 35.69 60.09 23.11 31.90 3.35 14.29 7.19 26. 16. 4.46 36.05 59.92 22.63 34.07 3.33 14.11 7.14 27. 14. 5.20 36.74 60.08 22.46 34.24 3.32 13.86 7.34 30. 13. 20.17 51.28 72.56 34.20 20.75 4.35 11.88 6.10 Xl - horizontal distance froa chest e.g. to intersection of seat back t seat cushion Zi - vertical distance froa chest e.g. to intersection of seat back I seat cushion H - height froa floorboard to intersection of seat back I seat cushion Table 3 - Center of Mass Displacement Computed from MVMA 2-D (Zero Crash Pulse for a 100 ms. IXiration) RESULTANT ! HEAD ¡ CHEST ! HIP PORCE ' 1 1 IMBALANCE ! AX AZ ! AX AZ ! AX AZ (lbe.) ! (in.) | (in.) ! (in.) O. J .20 .07 ! .03 .09 ! .04 .05 20. ¡ .31 .18 ! .14 .19 ! .09 .19 30. ! .36 .24 ! .17 .23 ! .15 .29 deflection characteristics and the coeffi- cients of friction were maintained constant. Table 3 shows the typical migration of the occupant's head, chest, and hip centers of mass In an MVMA 2-D simulation run with a prescribed zero acceleration crash pulse and the initial position obtained from the equilibrium program. For comparison, Table 3 also shows the migrations with imbalances of 20 and 30 pounds. Figures 4, 5, and 6 show the effects of a 25 pound imbalance in the horizontal direction and a 25 pound imbalance in the vertical direction in an MVMA 2-D simulation. In the latter simulation run the 100.0.« , , , , , . . 90.0. ° ® Wi librili» ff I ° force i** lance I A 70.0- - I ¡i €0.0. I A - F w/Ť / - ~ , I w/Ť - ł!'!1 - - „ /Jl , V " 0-0 ^ » 40.0 A 80.0 -120.0 Al*0.0jaA 180.0 . ^ 20.0 » €0.0 A 100.0 140.0 180.0 . tine (MS) Figure 4 - Resultant Head Acceleration oo. o^ , 80.0. ° equilibrium fl ° force ¡«balance Jj €0.0. j/| 9 Ml 5 ^0,0' 1 1 30.0- // 1 20.0. m tí r ' O.Of -, ,B "f , , , , , « A 40«0 €0.0 ¿A A 80. 0 100.0 . aa A120,04*A 140.0 A1€0'°ifiA 180.0 A « 20.0 A ¿A €0.0 A 100.0 . aa 140.0 180.0 A time &lt;ms&gt; Figure 5 - Resultant Chest Acceleration 40. 0-j , , , , , , i i 'H: 35.0- 40. 0-j , , , fc A , i ° o , equilibrium force , i iit&gt;alance.. i A o equilibrium 35.0- fc A i ° force iit&gt;alance.. 0.0 ^ _ 40.0 „y _ 80.0 ... 120.0 Al€0.0jaA _ ^ 20.0 _ „y €0.0 _ 100.0 ... 140.0 180.0 _ time (MS) Figure 6 - Resultant Hip Acceleration imbalance caused a change in the kinematics of the occupant, and in turn contributed to the change in the occupant response. SUMMARY AND CONCLUSIONS This paper described and provided a computer code that aids in the use of crash victim simulators. Typical outputs from the code have been presented, and it was shown 3.301</page><page sequence="4">that the code iß compatible with MVMA 2-D requirements. It was also shown that large departures from initial equilibrium may effect the responses obtained from crash victim simulators . ACKN0WLEK31ENTS The work described herein was supported by the Vehicle Systems Division, Office of Crashworthiness Research, National Highway Traffic Safety Administration. REFERENCES (1) MVMA Two Dimensional Crash Victim Simula- tiOQ, Highway Safety Research Institute, Uni- versity of Michigan, Ann Arbor, MI, 1979. (Report No. UM-HSRI-79-5-1,2,3) (2) IMSL Library - FORTRAN Subroutines for Mathematics and Statistics . IMSL, Inc., Houston, TX, 1984. Appendix A - Equilibrium Equations Sum of Forces in X and Z Directions 1. F21*coscx^ - Fri* F21* sina^ - Rxb2 = 0 2. -F21' sinaļ - Fri*F21* cosaļ - Rzb2 + W2 + W22 + WH + WN = 0 3. Rxa3 - Rxb3 = 0 4. Rza3 + W3 - Rzb3 = 0 5. F41*(cosa^ - Fri»sina^) + F42"(-sina2 - y-cosa^) - Rxb4 + Rxa4 = 0 6. F41*(-sinoiļ - Fri*cosa^) + F42*(-cosa2 + ysino^) - Rzb4 + W4 + Rza4 = 0 7. Rxa5 + F52*(-sina2 - ycoso^) ~ Rxb5 = 0 8. Rza5 + W5 + FKK + F52*(-cosa2 + ysino^) = 0 9. FH + FKK - WL = 0 Sum of Moments 10. (F21*sina^ + Fri*F21*cosa^) • [ g2 «sii^ + ze2*cos02 - XX22] + (F21*cosa^ - Fri*F21* sina^) • [g2*cos02 - ze2*sin02 - ZZ22] - W2 • (xe2 + g2) • sin02 - (WH + WN) *L23 *sin02 - W22 • [zs2 *cos02 + (xs2 + xe2 + g2)*sin02] - t(0^ - ©2) ~ TH(3) ] *K1 (3)= 0 11. W3®L3*śiti0 - Rzb3*L34* sin03 + Rxb3*L34- cos03 + [ (0 - 0^) - TH(3)]-Kl(3) - [(©4 - 03) - TH(4) ] • K1 (4) = 0 12. (-F42*sina22 " V '7^2* coscl^)'(XK2) - (F42«cosa22 " V *F42* sino^MZZZ) + (F41*sina^ + Fri*F41* cosa^M-XXl) - (F41*cosa^ - Fri*F41# sina^MZZl) - Rzb4*[(L45 - L4 - xe4)*sin04 + ze4*cos04] + Rxb4*[(L45 - L4 - xe4)*cos0^ - ze4*sin0^] 4- W4 • [ze4 %cos0^ - xe4*siń0^] + Rxa4*[(L4 + xe4)»cos04 + ze4*sin0^] + Rza4 • [ze4 »cos04 - (L4 + xe4)*sin04] - + [(0 - 03) - TH(4)]-Kl(4)-[((05 + tt/2.) - 0^) - TH(5)]-K1(5) = 0 where + tt/2. 3.302</page><page sequence="5">871111 13. (-F52-cosa22 + y-F52*sina22) • [ZZ55 + ze5*sin0^^ + (L5 + xe5)*cos0^^] + (-F52* sirios ~ P •F52*cosa22)#[XX55 - ze5*cos0^^ + (L5 + xe5) • sin0,_ ,. ] + W5*L5«cos05 + FKK-L56-COS05 + [ ( (©5 + ^/2.) - ©4&gt; - TH(5)]»K1(5) = 0 where = a2 + ^/2.» ö,-&lt;- = ^5 + 14. WL • (L6/ (L6 + xe6) ) - FH = O Relations for Ellipse Contact Points For equations 15 through 33 MM2 = (GZ - DZ) / (GX - DX) MM5 = (HZ - GZ) / (HX - GX) 2 2 15. S2 = (2 * B22*MM2#cos a2^ - 2 • B22# cosa2^* sino^) /ae2 2 2 + (2 • B22'MM2*sin + 2 • B22*cosa2^# sina2^) /ce2 2 2 16. S41 = (2 • Bl*MM2#cos a, - 2 • Bl* cosa. . • sina. , ) /ae4 41 41 41 , 2 2 + (2 • Bl«MM2*sin + 2 • Bl^cosa^* sina^) /ce4 17. S42 = (2 • B2*MM5#cos^a. - 2 • B2* cosa t • sina ) /ae4^ 41 41 t 41 2 2 + (2 • B2*MM5# sin ex. . + 2 • B2 «cosa. . • sina. ) /ce4 41 41 41 2 2 18. S5 = (2 •B55*MM5*cos - 2 • B55#cosa^2* sina^) /ae5 2 2 + (2 • B55*MM5*sin + 2 • B55* cosa^^* sina^) /ce5 s 2 2 2 2 19. XX22 = -S2/^2-[(sin + MM2 • cos - 2 • MM2*cosa2^# sina^) /ae2 2 2 2 2 + (cos (*21 + MM2 »sin + 2 • MM2#cosa2^# sino^) /ce2 ]j 20. XXI = -S41/^2 • [(sin^a^ + MM2^*cos^a^ - 2 • MM2#cosa4^* sina^) /ae4^ 2 2 2 2 ' + (cos a. - + MM2 • sin a, . + 2 • MM2*cosa, , • sina ) /ce4 ] j 41 41 a i 4 1 21. XX2 = -S42/^2.[fein2a41 + MM52»cos2a4I - 2 • MM5*cosa4ļ. sina^) /ae42 2 2 2 2 + (cos a4ļ + MM5 «sin a^ + 2 • MM5*cosa4^ sina4^)/ce4 ]y 22. XX55 = - S5/^2* [(sin^a^2 + MM5^#cos^a^2 ~ 2 • Mřtó^cosa^* sina^) /ae5^ 2 2 2 2 + (cos a^2 + MM5 *sin + 2 • MM5#cosa,_2# sina^ī/ceS ]y 23. ZZ22 = MM2-XX22 + B22 24. ZZI = MM2-XX1 + Bl 25. ZZ2 = MM5 • XX2 + B2 26. ZZ55 = MM5-XX55 + B55 27. a2ļ - 2ir - 02 28. a. . = 2ïï - 0. 41 . 4 29. a^2 = 1-5tt - 0^ 2-222 2 30. S2 ~ 4 • [(sin + MM2 • cos a2^ - 2 • MM2#cosa2^# sina2^) /ae2 2 2 2 ? + (cos a2l + 'sin a2ļ + 2 • MM2*cosa2^* sina2^) /ce2 ] • [B222.cos2a2ļ/ae22 + B222. sin2a2ļ/ce22 - 1.] = 0 3.303</page><page sequence="6">2 2 2 2 2 31 . S41 - 4 • [ (sin a. - + MM2 »cos a - 2 • MM2*cosa. • sina. . ) /ae4 41 41 41 41 2 2 2 2 + (cos a + MM2 -sin a + 2 • MM2 'cosa. • sina. _ ) /ce4 ļ HI Hl 41 41 2 2 2 2 2 2 • [BI *cos a^/ae4 + Bi *sin a^/ce4 - 1.] = 0 2.2 2 2 2 32. S42 - 4 • [(sin a.. + MM5 *cos a. . - 2 • MM5 *cosa. • sina. . ) /ae4 41 41 . 41 41 . 2 2 2 2 + (cos a + MM5 *sin a + 2 • MM5* cosa. • sina. - )/ce4 ] 41 41 41 41 - 2 2 2 2 9 2 * [B2 «eos a¿1/ae4 + B2 'sin 9 a41/ce4 2 - 1. ] = 0 2 2 2 2 2 33. S5 - 4 • [(sin a_0 + MM5 • cos aro - 2 • MM5*cosa • sina_0) /ae5 DL DL DL DL 2 2 2 2 + (cos a^2 + MM5 »sin a^ + 2 • MM5*cosa32# sina 2) /ce5 ] • [B55^*cos^a32/ae5^ + B55^* sin^a32/ce5^ - 1.] =0 Geometry Relations 34. X3 = X4 - L34-sin03 35. Z3 = Z4 - L34*COS03 36. X2 = X3 - L23*sin02 37. Z2 = Z3 - L23#COS02 38. X6 = X5 + L56*cos05 39. Z6 = Z5 - L56*sin05 40. cos 0^. = (FLZ2 - Z6 - re6 + defl)/(L6 + xe6) 41. X4 = CX4 + ze4*cos0/ - (L4 + xe4)#sin0, h . 4 42. Z4 = CZ4 - ze4*sin0^ - (L4 + xe4)*cos0^ 43. X5 = CX4 + ze4*cos0^ + (L45 - xe4 - L4)#sin0^ 44. Z5 = CZ4 - ze4* sin0^ + (L45 - xe4 - L4)*cos0^ 45. [ze5*sina2 - cosa2*(L5 + xe5)]*sin05 + [ (L5 + xe5)#sina2 + cosa2* ze5] «cose^ + {-cosa2*[GZ + d52*cosa2 - ZZ55 - Z5]} + {-sina2»[GX + d52«sina2 - XX55 - X5]} 46. [-(L23 - L2 - xe2)*cosaļ - sina^ ze2] • sin©2 + [-ze2«cosaļ - sinaļ*(-L23 + L2 + xe2)]-cos62 + sina^*[GZ - ZZ22 4- d21*sina^ - Z3] - cosaļ* [GX - XX22 - d21*cosaļ - X3] 47. XC4 = GX +^[(-d42*sina2 - XXI - d41*cosa^ + XX2)*(cosa^) - (-ZZ1 - d42#cosa2 + d41*sina^ + ZZ2) • (sinap ] / (cosa2*cosa^ + sina2* sina^)^ *(cosa2) - (ce4 - d42)#sina2 3.304</page><page sequence="7">871111 48. ZC4 = GZ -{Í(-d42.sina2 - XXI - dAl.cosc^ + XX2).(cosaļ) - (-ZZI - d42#cosa2 + d41#sina^ + ZZ2) • (sina^)] / (coso^cosa^ + sina^* sina^^Csina^) - (ce4 - d42)*cosoi2 49. XG2 = X3 - (L23 - L2)*sin62 50. ZG2 = Z3 - (L23 - L2)-cos02 Force/Def lection Relations 51. F21 = d21 • (F8/D8) or F8 + [ (d21 - D8)M(F9 - F8)/(D9 - D8)] 52. F41 = d41 • (F8/D8) or F8 + [ (d41 - D8) ]♦[ (F9 - F8)/(D9 - D8)] 53. F42 = d42 • (F8/D8) or F8 + [ (d42 - D8) ] • [ (F9 - F8)/(D9 - D8)] 54. F52 = d52 • (F8/D8) or F8 + [ (d52 - D8) ] • [ (F9 - F8)/(D9 - D8) ] 55. FH = Fk-(defl) Identity Relations 56. Rxa3 = Rxb2 57. Rza3 = Rzb2 58 . Rxa4 = Rxb3 59. Rza4 = Rzb3 60. Rxb4 = Rxa5 61. Rzb4 = Rza5 WH + WN DX' DZ 1 ' (X2, Z2) ' L2 ' ai ' ^SEAT BACK ' ' ' W22|v*&lt;' 'JK 0 ' ' ' 0 ' 'f N. W2 ļ'^^' ' 11 22 ^'yxx?2 ' ' V2 j ' '' ' J (X3' z3) - Rxb2 (Fri) • (F21) ' ' I ' UPPER TORSO I 10 ' |Rzb2 10 GX,GZ Figure A-l - Upper Torso Free Body Diagram (Link 2-3) f"/&lt; Rxa3 ' » ' ' (X3.Z3) ļj^'^ '34 W3Ì' ' (X4.Z4) Rxb3 r 1 Rzb3 1 Figure A- 2 - Lower Torso Free Body Diagram (Link 3-4) 3.305</page><page sequence="8">Rza4 Rxa4 ' V (X4,Z4T' ' ' ' / W4|' SEAT BACK A ' 3v ' ' -XXI VST VX5,Z5ļJK ZZ1'|a ixx2* I i Rxb4 kVTd4i 272 ł '' SEAT CUSHION d42 A yta- Figure A-3 - Hip Free Body Diagram (Link 4-5) ^si^-A (X6, Z6&gt; T45 I /r"5 HX' hz Rza5 SEAT CUSH10N * 5 ' F52 GX GZ UPPER LEG Figure A- 4 - Upper Leg Free Body Diagram (Link 5-6) FK«Î (X6, Z6'ļ' '&gt; CG ® ' WL I ' ' T ' ' xe6 V-v. J&gt; (FLX3' f1"23» 'MjnJ Tret/ ^ T0EB0ARD -FLZ2) FLOORBOARD FH Figure A-5 - Lower Leg Free Body Diagram (Link 6-7) Definition of Syibols 1) Prograi Input Variables HH - naßß of head HI - naßß of neck ML - naßß of two lower lega L6 - length froi knee to lower leg center of lass (C.M.) xe6 - X-coordinate fron lower leg C.M. to center of heel re6 - radius of heel circle DX,DZ - X and Z coordinates of top of seat back 61 ,62 - X and Z coordinates of seat back and seat cushion intersection HX,HZ - X and Z coordinates of front of seat cushion D8,F8 - deflection and force defining first slope of seat force-deflection cune D9,F9 deflection and force defining second slope of seat force-deflection curve FDEF,FF0R - deflection and force defining slope of floor force- deflection curve FLX2 , FLZ2 - X and Z coordinates of floorboard and toeboard intersection FLX3,FLZ3 - X and Z coordinates of toeboard and firewall intersection L23 - length of upper torso segient M2 - lass of upper torso L2 - length froi bottoi of neck to upper torso C.M. xe2,ze2 - I and Z length froi upper torso C.M. to center of upper torso ellipse ae2 - length of upper torso ellipse along X seii-axis ce2 - length of upper torso ellipse along Z seni axis M22 - lass of two upper and lower aris X82,2s2 - X and Z length froi upper torso C.M. to shoulder rest point L34 - length of lower torso segient M3 - lass of lower torso L3 - length froi upper torso and lower torso joint to lower torso C.M. L45 - length of hip segient M4 - lass of hip L4 - length froi lower torso and hip joint to hip C.M. xe4,xe4 - X and Z length froi hip C.M. to center of hip ellipse ae4 - length of hip ellipse along X seii-axis ce4 - length of hip ellipse along Z seii-axis L56 - length of upper leg segient M5 - lass of upper leg 3.306</page><page sequence="9">871111 L5 - length iron hip and upper leg joint to upper leg C.I. xe5,ze5 - X and Z length iron upper leg C.I. to center of upper leg ellipse ae&amp; - length of upper leg ellipse along I seii-axis ce5 - length of upper leg ellipse along Z seii-axis Kl(n) - slope of joint torque - relative link angle curve between stop angles K2(n) - slope of joint torque - relative link angle curve outside stop angles STUP(n) - positive-iost joint stop angle1 STDI (n) - negative-lost joint stop angle1 TH(n) - zero torque angle1 v - - seat back friction coefficient FRI - seat cushion friction coefficient where n=3 upper torso - n^4 lower toreo n=5 hip 1 this value has the opposite sign of the IVIA 2-D variable 2) Other Syibols d21,F21 - deflection and force of seat back due to upper torso ellipse d41,F41 - deflection and force of seat back due to hip circle d42,F42 - deflection and force of seat cushion due to hip circle d52,F52 - deflection and force of seat cushion due to upper leg ellipse HI - force of floorboard at the foot circle Rxa(i) - horizontal internal reaction force acting at the top of link (i) Rza(i) - vertical internal reaction force acting at top of link (i) lxb(i) - horizontal internal reaction force acting at the bottoi of link (i) Rzb(i) - vertical internal reaction force acting at the bottoi of link (i) T23 - torque acting at the upper torso and lover torso joint T34 - torque acting at the lower torso and hip joint T45 - torque acting at the hip and upper leg joint N(i) - weight of body segient (i) 1(22 - weight of two upper and lower ans NI, NI - weight of head and neck I(i) - horizontal coordinate of top of link (i) Z(i) - vertical coordinate of top of link (i) e(i) - angle of body segient (i) al - angle of seat back a2 - angle of seat cushion where i=2 upper torso i=3 lower torso i=4 hip i=5 upper leg i=6 lower leg Appendix B - Equilibrium Program Code CHARACTERI128 OUTFILE , DATFILE INTEGER N , I TMAX , 1ER REAL WK ( 12000 ) , X ( 61 ) , PAR ( 4 ) , FNORM REAL M2,M22,M3,M4,M5,MH,NN,ML,L2,L3,L4,L5,L6,HM2,MM5 ' REAL L23, L34,L45,L56,MU, 6AM, PD, PI, LLL, LIMIT ' REAL TH(6) ,K1(6) ,K2(6) ,STUP(6) ,STDN(6) DATA PAR/1.0,6.28,4.71, .01/ COMMON/ BLK1 /Cl , S 1 , C2 , S2 , MU , 62 , ZE2 , N2 , XE2 , WH , WN , L23 , § «22,ZS2,XS2,W3,L3,L34,L45,L4,XE4,ZE4,H4,ZE5,PI ,L5, 8 XE5 , W5 , FK , L56 , MM2 , AE2 , CE2 , AE4 f CE4 , MM5 , AE5 , CES , L6 , ê XE6,6Z,6X,L2,Ď8,D9,F8,F9, ŘE6 , FLZ2 , ALPHA2 , TH , Kl , K2 , § STUP , STDN , A3 , B3 , C3 , TT3 , A4 , B4 , C4 , TT4 , A5 , B5 , C5 , TT5 , DIO ,WL , FRI EXTERNAL FCN TYPE 200 200 FORMAT (IX, 'ENTER NAME OF OUTPUT FILE') ACCEPT 210, OUTFILE OPEN ( UNI T=25,STATUS=' NEW' ,FILE=QUTFILE) 210 FORMAT ( A128 ) N=6i NSIG=3 WRITE(6,220) 220 FORMATI IX, 'ENTER DATA FILE NAME: ' ,$) READ(5,230)DATFILE 230 FORMAT (A128) OPEN ( UN I T=10 , F I LE= ' DATA . DAT ' , ST ATUS= ' UNKNOWN ' , CARR I A6ECQNTR0L § = ' LIST ' ,ACCESS=' APPEND' , SHARED) WRITE ( 10 , 240 ÌDATFILE 240 FORMAT ( ix , A14 } 0PEN(UNIT=7,FILE=DATFILE,STATUS='0LD', READONLY, SHARED) 0PENÍUNIT=17,FILE='XEQU. DAT', STATU3='0LD' , READONLY, SHARED) c ummnmmtmmtuttummttmtmmtttmtutmt C * READ INPUT DATA c mmuumumutummtmmmmtmttmmtmtttt DO 10,1=1,61 READ(Í7,*)X(I) 10 CONTINUE READ (7, 250) MH,MN,ML,L6,XE6,RE6 READ (7, 250) DX,DZ,GX,GZ,HX,HZ READ (7, 250) D8,F8,D9,F9,FDEF,FF0R RE AD (7, 2 50) FLX2,FLZ2,FLX3,FLZ3 READ (7, 250) L23,M2,L2,XE2,ZE2,AE2,CE2 READ (7, 2 50) M22,XS2,ZS2 READ (7, 250) L34,M3,L3 RE AD (7, 2 50) L45,M4,L4,XE4,ZE4,AE4,CE4 READ (7, 250) L56,M5,L5,XE5,ZE5,AE5,CE5 READ (7, 250) Kl(3) ,Ki(4) ,K1(5) READ (7, 250) K2(3),K2(4),K2(5) READ! 7,250) STUP ( 3 ) , STUP ( 4 ) , STUP ( 5 ) READ (7, 250) STDN ( 3 ) ,STDN(4) ,STDNi5) READ i 7, 250) TH(3),TH(4),TH(5) READ (7, 250) MU,FRI c tmmtmmmmmtmtmtmtmmmttmmttttim C t SET INITIAL VALUES c mttumuuutmumttmtttttmtttmtummtttmtt FK=FFOR/FDEF PI=3. 14159265 PD=180.0/PI 6F=386.088 D1Ô=0.0 ZS2=-ZS2 ALPHA1=ATAN(ABS( ( 6X-DX ) / ( 6Z-DZ ) ) ) ALPHA2=ATAN( ABS( ( GZ-HZ ) / ( GX-HX ) ) ) C1=C0S( ALPHA1 ) S1=SIN( ALPHA1 ) C2=C0S ( ALPHA2 ) S2=SIN( ALPHA2 ) DO 20,1=3,5 Kl( I )=K1( I)IPD K2(I)=K2(I)IPD STUPÌ I )=STUP( I ) /PD STDN(I)=STDN(I)/PD TH(I)=TH(I)/PD 20 CONTINUE WH=MHtGF WN=MNI6F WL=MLI6F 3.307</page><page sequence="10">62=L23-L2-XE2 ZFL=FLZ2 N2=M2I6F N22=M22I6F N3=M3t6F N4=M4I6F N5=M5tGF MM2=(6Z-DZ)/(6X-DX) MM5=(HZ-6Z)/(HX-6X) 6AM=ATAN ( ( FLZ2-FLZ3 ) / ( FLX3-FLX2) ) C6AM=C0S(6AM) S6AM=SIN(6AH) T6AM=TAN(6AM) LLL=(RE6t ( 1 • -C6AM) ) /T6AH LIMIT=FLX2+LLL-RE6IS6AM 250 FORMAT (7F10.3) ITMAX=200 c mtmntmmtmtmmmmmtnmmmmntmnuttn C t CALL IHSL SUBROUTINE TO SOLVE SYSTEM OF NONLINEAR EQUATIONS « c tmttmmmmtmttuttttmuttttttumtmtmmtmtm CALL ZSCNT (FCN,NSIG,N, ITMAX ,PAR, X ,FNORM, WK, 1ER) IF (1ER. NE. 0. OR. X( 5) .6T. 1.57) THEN NRITE(25,255) 255 FORMAT ( IX y ' tt ERROR IN SOLUTION tttt ,/,lX, ' PROSRAM DID NOT G CONVERGE TO A PROPER SOLUTION, TRY A DIFFERENT INITIAL GUESS.', % /, IX, 'VALUES ARE:',/,/) ENDIF c tmtmmmmmmutnmmtmmnmmttmmmttm C I CHANGE AN6LES INTO MVMA FORMAT c inmtmmttmttttnmninmttmmtmtmutmttmm T2=X(i)tPD T3=X(2)$PD T4=X(3)IPD T5=X(4)łPD+90.0 T6=X ( 5) tPD TMV2=T2+90.0 TMV3=T3+90.0 TMV4=T4+90,0 TMV5=T5-90.0 TMV6=T6-90. AH=80.64 AN=92.B4 AS=-80. AE=-10. RELHN=AH-AN RELN2=AN-TMV2 REL23=T2-T3 REL34=T3-T4 REL45=T4-T5 REL56=T5-T6 REL2S=TMV2- ( 180 . O+AS ) RELSE=AS-AE c tttntttntntuunttntmnntummutmnntttutntt C I WRITE OUTPUT c tmuutttmtmmtmtmmnnntmmmmmntmt WRITE ( 25 , 260 ) 260 FORMATI 17X, 'UPPER TORSO' ,2X, 'LONER TORSO' ,6X, 'HIP' ,7X, « 'UPPER LE6',4X,' LONER LEG',/) NRITE(25,270)X(i)tPD,X(2)IPD,X(3)IPD,X(4)IPD,X(5)IPD 270 FORMAT (IX,' AN6LE ' , 12X , 5 ( F8 . 3 , 5x ) ) NRITE ( 25 , 280 ) TMV2 , TMV3 , TMV4 , TMV5 , TMV6 280 FORMAT (IX, 'MVMA ANGLE' ,7X,5(F8.3,5x)) NRITE ( 25,290) X (26), X( 27) 290 FORMAT (IX, 'SEAT BACK FORCE' ,2X,F8.3,18X,F8.3) NRITE (25, 300) X( 28) ,X (29) 300 FORMATI IX, 'SEAT CUSH. FORCE' ,27X,F8.3,5X,F8.3) NRITE( 25,310) X ( 56) 310 FORMAT (IX,' FLOORBOARD FORCE' ,53X,F8.3) IF(X(46).LT.0.0)X(46)=0.0 IF(X(47).LT.0.0)X(47)=0.0 IF(X(51).LT.0.0)X(51)=0.0 IF(X(52).LT.0.0)X(52)=0.0 NRITE (25,320) X( 46) ,X(51) 320 FORMAT (IX, 'SEAT BACK DEFL' ,3X,F8.3,18X,F8.3) NRITE(25,330)X(52) ,X(47) 330 FORMAT (IX, 'SEAT CUSH. DEFL' ,28X,F8.3,5X,F8.3) NR I TE ( 25 , 340 ) X ( 55 ) 340 FORM AT (IX, 'FLOORBOARD DEFL' ,54X,F8.3) NRITE( 25,350) X (40) ,X(38) ,X (34) ,X (35) ,X(42) 350 FORMAT (IX, 'LIMB X COORD' ,5X,5(F8.3,5X)) NRITE(25,360)X(41) ,X(39),X(36) ,X(37),X(43) 360 FORMAT (IX, 'LIMB Z COORD' ,5X,5(F8.3,5X)) NRITE(25,370)RXA2,X(8),X(12),X(16),RXA6 370 FORMAT ( IX , 'LIMB FORCE -X' ,4X,5(F8.3,5X)) NRITE(25,380)NH+NN,X(10),X(14),X(17),X(57) 380 FORMAT! IX, 'LIMB FORCE -Z',4X,5(F8.3,5X),/) NRITE(25,390)X(53),X(54) 390 FORMAT (IX, 'UPPER TORSO C.6. X &amp; Z COORDS ARE: '2X,F7.3,3X,F8.3) NRITE( 25, 400) -TT3 400 FORMAT ( IX , ' THE TORQUE AT UPPER AND LONER TORSO JOINT IS:', « F7.2,iX, ' IN-LBS. ' ) NRITE ( 25, 410)~TT4 410 FORMAT (IX, 'THE TORQUE AT LONER TORSO AND HIP JOINT IS:', % F7.2,1X,' IN-LBS.') NRITE(25,420)TT5 420 FORMAT (IX, THE TORQUE AT HIP AND UPPER LE6 JOINT IS:', e F7.2,1X,' IN-LBS.') NR I TE ( 25 , 430 ) ALPHAI tPD 430 FORMAT! IX, 'THE SEAT BACK ANGLE IS:',F7.2) NR I TE ( 25 , 440 ) ALPHA2 «PD 440 FORMAT! IX, 'THE SEAT CUSHION AN6LE IS: *,F7.2) NR I TE ( 25 , 450 ) MU 450 FORMAT ( IX , ' THE SEAT BACK FRICTION COEFFICIENT IS: ' ,1X,F4.2) MRITE(25,460)FRI 460 FORMAT (IX, 'THE SEAT CUSHION FRICTION COEFF. IS: ' ,1X,F4.2) NRITE(25,470)IER,FN0RM 470 FORMAT (IX, 'ERROR CODE IS: ' ,1X,I3,5X, 'FNORM=' ,1X,F14.4,/) NR I TE ( 2 5 , 480 ) RELHN , RELN2 , REL23 , REL34 , REL45 , REL56 , REL2S , RELSE 480 FORMATdX, 'RELATIVE ANGLES' ,/,lX,8(F8.3,lX) ,/// ) NR I TE ( 25 , 250 ) MH , MN , ML , L6 , XE6 , RE6 HRITE(25,250)DX,DZ,6X,6Z,HX,HZ HRITE(25,250)D8,F8,D9,F9,FDEF,FF0R NRITE (25, 250)FLX2,FLZ2,FLX3,FLZ3 NRITE(25,250)L23,M2,L2,XE2,ZE2,AE2,CE2 NRITE (25, 250)M22,XS2,ZS2 NRITE(25,250)L34,M3,L3 NRITE (25, 250 )L45,H4,L4,XE4,ZE4,AE4,CE4 NRITE! 25, 250 )L56,M5,L5,XE5,ZE5,AE5,CE5 NRITE(25,250)K1(3)/PD,K1(4)/PD,K1(5)/PD NRITE(25,250)K2(3)/PD,K2(4)/PD,K2(5)/PD NRITE(25,250)STUP(3)IPD,STUP(4)»PD,STUP(5)tPD NRITE(25,250)STDN(3)tPD,STDN(4)tPD,STDN(5)tPD NRITE(25,250)TH(3)$PD,TH(4)tPD,TH(5)tPD c tmmttmmmtmmutmmttnutmtmttttiumtutu C t CHECK TO SEE IF FOOT IS THROUGH TOEBOARD c umtmmmmnmmunntttmmttmnnnttmmmt X7=X ( 42 )+ (L6+XE6) ISIN( X ( 5) ) Z7=X(43)+(L6+XE6)IC0S(X(5)) IF(IER.NE.O.O)THEN NRITE(10,t) 'ERROR CODE =' ,IER, 'FNORM=' ,FNORM ENDIF IF(X7.6T.LIMIT)THEN NRITE(10,I) 'FOOT THRU TOEBOARD' ENDIF NRITE(10,490)AH,TMV2,TMV3,TMV4,TMV5,TMV6,AS,AE,AN,X(53),X(54) 3.308</page><page sequence="11">871111 490 FORMAT (lX,iiF9.2) CL0SE(UNIT=10) STOP END c mmmmmtmmmtmmmmtmmtmtmmmmt C I SUBROUTINE LISTIN6 OF NONLINEAR EQUATIONS c mmtittmtmmttttimmmmmmimmmmtmm SUBROUTINE FCN (X,F,N,PAR) C0MM0N/BLK1 /C1 ,S1,C2,S2,MU,62,ZE2,W2,XE2,WH,WN,L23, « N22,ZS2,XS2,W3,L3,L34,L45,L4,XE4,ZE4,N4,ZE5,PI,L5, « XE5,W5,FK,L56,HH2,AE2,CE2,AE4,CE4,HN5,AE5,CE5,L6, 8 XE6,6Z,6X,L2,D8,D9,F8,F9,RE6,FLZ2,ALPHA2,TH,K1,K2, 8 STUP,STDN,A3,B3,C3,TT3,A4,B4,C4,TT4,A5,B5,C5,TT5,D10,NL,FRI REAL X(Ò1),F(61),PAR(3),K1(6),K2(6),STUP(6),STDN(6),TH(6) REAL M2,M22,M3,M4,H5,MH,MN,ML,L2,L3,L4,L5,L6,MM2,MM5 REAL L23,L34,L45,L56,MU,6AH,PI,T,A3,B3,C3 c tmtmttmtmmmmmtmmmstmmmttmtmm C t SUN OF FORCES IN X AND Z DIRECTIONS c imumtumtutttmtmmttnmtmmmtttttumtttt F(1)=X(26)*(C1-FRIIS1)-X(6) F ( 2 ) =X ( 26 ) I ( -Sl-FRI ICI ) -X ( 7 ) +W2+W22+WH+HN F(3)«X(8)-X(9) F(4)=X(10)-X(li)+N3 F(5)=X(27)I(C1-FRIIS1)+X(28)I(-S2-HUIC2)-X(13)+X(12) F(6)=X(27)I(-S1-FRIIC1)+X(28)I(-C2+HUIS2)-X(15)+X(14)+H4 F(7)=X(16)+X(29)I(-S2-MUIC2) F(8)=X(i7)+X(29)l(-C2+MUIS2)+N5+X(57) F(9)=X(57)+X(56)-NL c tmtmmmtmmttmmmmmmmtmmt minium C I SUN OF THE MOMENTS c iiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiitiiiini F(10)=(X(26)I(S1+FRIIC1))I(62ISIN(X(1) )+ZE2ICQS(X(l))-X(18))+(X « (26) I (Cl-FRI IS1 ) ) t (62ICQS( X ( i ) )-ZE2ISIN( X ( 1 ) )-X ( 19) )-W2l ( XE2+ i 62)ISIN(X(1))-(HH+WN)IL23ISIN(X(1))-N22I(ZS2ICQS(X(1))+ § (XS2+XE2+62)ISIN(X(1) ) ) 8 -( (X(2)-X(l) )-TH(3))IKl(3)l( (X(2)-X(l) ) .LE.STUP(3).AND. § (X(2)-X(l)) .6E.STDN(3) )l(-l. )-(Kl(3)t(STUP(3)-TH(3) )+ 8 ((X(2)-X(1))-STUP(3))*K2(3))&lt;((X(2)-X(1)).6T.STUP(3)) € l(-l. )-(Kl(3)l(STDN(3)-TH(3))+( (X(2)-X(l) )-STDN(3))IK2(3)) 8 l((X(2)-X(i)).LT.STDN(3))l(-l.) TT3=-( (X(2)-X(1))-TH(3))IK1(3)I( (X(2)-X(l) ) .LE. STUP (3). AND. 8 (X(2)-X(l) ) .6E.STDN(3))I(-1. )-(Kl(3)l(STUP(3)-TH(3))+ 8 ( (X(2)-X(l) )-STUP(3))IK2(3))t( (X(2)-X(i) ).6T.STUP(3)) 8 I(-1.)-(K1(3)»(STDN(3)-TH(3))+((X(2)-X(1))-STDN(3))$K2(3)) 8 l( (X(2)-X(l)).Ll .S1DN(3))I(-1.) F(ll)=( (N3IL3)-L34tX(ll))tSIN(X(2))+L34IX(9)tC0S(X(2) ) 8 +( (X(2)-X(1))-TH(3))IK1(3)I( (X(2)-X(1)).LE.STUP(3).AND. 8 (X(2)-X(1)).6E.STDN(3))I(-1. )+(Kl(3)t(STUP(3)-TH(3) )♦ 8 ((X(2)-X(l))-STUP(3))IK2(3))t((X(2)-X(l)).6T.STUP(3)) 8 l(-i. )+(Kl(3)t(STDN(3)-TH(3) )+( (X(2)-X(1))-STDN(3))IK2(3)) 8 l((X(2)-X(l)).LT.STDN(3))t(-l.) 8 -((X(3)-X(2))-TH(4))IKl(4)t((X(3)-X(2)).LE.STUP(4).AND. 8 (X(3)-X(2) ).6E.STDN(4))I(-1. )-(Kl(4)l(STUP(4)-TH(4))+ 8 ((X(3)-X(2))-STUP(4))IK2(4))I((X(3)-X(2)).GT.STUP(4)) 8 l(-l. )-(Kl(4)t(STDN(4)-TH(4))+( (X(3)-X(2))-STDN(4))IK2(4) ) 8 t((X(3)-X(2)).LT.STDN(4))l(-l.) TT4=-((X(3)-X(2))-TH(4))IK1(4)I((X(3)-X(2)).LE.STUP(4).AND. 8 (X(3)-X(2)).6E.STDN(4))I(-1.)-(K1(4)I(STUP(4)-TH(4))+ 8 ((X(3)-X(2))-STUP(4))IK2(4))t((X(3)-X(2)).6T.STUP(4)) 8 I(-1.)-(K1(4)I(STDN(4)-TH(4))+((X(3)-X(2) )-STDN(4))IK2(4)) 8 t((X(3)-X(2)).LT.STDN(4))t(-l.) F(12)=(X(28)«(-SIN( ALPHA2+P I /2 . ) +MU t-COS ( ALPHA2+P I /2 . ) ) ) 8 I X ( 22 ) + ( X ( 28 ) I ( -COS ( ALPHA2+P I /2 . ) +MU I S I N ( ALPHA2+P 1/2.))) 8 l(X(23) )+(X(27)l(-Si-FRIICl) )l(X(20))+(X(27)t(-CHfRIISl)) 8 IX(21)-X(15)I((L45-L4-XE4)ISIN(X(3))+ZE4IC0S(X(3)))+X(13) 8 l((L45-L4-XE4)IC0S(X(3))-(ZE4)ISIN(X(3)))+N4l(ZE4IC0S(X(3)) 8 -XE4ISIN(X(3) ))+X(14)t((ZE4)IC0S(X(3) )-(L4+XE4)ISIN(X(3) )) 8 +X(12)I( (L4+XE4)ICQS(X(3) )+(ZE4)ISIN(X(3) ) ) 8 +( (X(3)-X(2) )-TH(4) )IK1(4)I( (X(3)-X(2) ) . LE . STUP ( 4 ) . AND . 8 (X(3)-X(2) ) .6E.STDN(4) )l(-i. )+(Kl(4)l(STUP(4)-TH(4) )+ 8 ((X(3)-X(2) )-STUP(4) )IK2(4))I( (X(3)-X(2) ) -6T . STUP ( 4 ) ) 8 l(-i. )+(Kl(4)l(STDN(4)-TH(4) )♦( (X(3)-X(2) )-STDN(4))IK2(4) ) 8 l((X(3)-X(2)).LT.STDN(4))l(-l.) 8 -( ((X(4)+PI/2. )-X(3) )-TH(5) )IK1(5)I(( (X(4)*PI/2. ) 8 -X(3)).LE.STUP(5).AND.((X(4)+PI/2.)-X(3)).6E.STDN(5)) 8 l(-l. )-(Kl(5)l(STUP(5)-TH(5) )+( Í (X(4)+PI/2. )-X(3) )-STUP(5)) 8 IK2(5))l(((X(4)+PI/2.)-X(3)).6T.STUP(5))l(-l.)-(Ki(5)l 8 ( STDN (5)-TH(5))+( ( (X(4)+PI/2. )-X(3) )-STDN(5))IK2(5) ) 8 l(((X(4)+PI/2.)-X(3)).LT.STDN(5))l(-l.) TT5=-( ( (X(4)+PI/2. )-X(3) )-TH(5) )IK1(5)I( ( (X(4)*PI/2. ) 8 -X(3)).LE.STUP(5).AND.((X(4)+PI/2.)-X(3)).6E.STDN(5)) 8 l(-l. )-(Kl(5)l(STUP(5)-TH(5) )*( ( (X(4)+PI/2. )-X(3) )-STUP(5) ) 8 IK2(5))l(((X(4)+PI/2.)-X(3)).6T.STUP(5))l(-l.)-(l(l(5)l 8 (STDN(5)-TH(5))+( ( (X(4)+PI/2. )-X(3) )-STDN(5) )IK2(5) ) 8 l( ( (X(4)+PI/2. )-X(3) ) .LT.STDN(S) )l(-l. ) F ( 13 ) = ( X ( 29 ) I ( -COS ( ALPHA2+PI /2 . ) +NUISIN( ALPHA2+PI /2 . ) ) ) 8 l(X(25)+ZE5ISIN(X(4)+PI/2. )+{L5+XE5)IC0S(X(4)+PI/2. ))+ 8 ( X(29)t(-SIN(ALPHA2+PI/2. ) -MUtC0S( ALPHA2+PI /2. ) ) )t(X(24) 8 -ZE5IC0S(X(4)+PI/2. )+(L5+XE5)ISIN(X(4)+PI/2.) )+(N5IL5)l 8 C0S(X(4))+(X(57)IL56)IC0S(X(4) ) 8 +( ((X(4)+PI/2. )-X(3))-TH(5))IKl(5)l(( (X(4)+PI/2.)-X(3'l) 8 .LEģSTUP(5) .AND. ((X(4)+PI/2. )-X(3) ).6E.STDN(5))I(-1.)+ 8 (K1(5)I(STUP(5)-TH(5) )♦( ( (X(4)+PI/2. )-X(3) )-STUP(5) )IK2(5) ) 8 l(((X(4)+PI/2.)-X(3)).6T.STUP(5))l(-l.)+(Kl(5)t(STDN(5) 8 -TH(5) )+(( (X(4)+PI/2. )-X(3) )-STDN(5) )IK2(5) ) 8 l( ( (X(4)+PI/2. )-X(3) ).LT.STDN(5) )l(-l. ) F(14)=(NLI(L6/(L6+XE6) ) )-X(56) c tiiiiiiiiiiiiiiiiiiiiiiiiitiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiin C I EQUATIONS FOR ELLIPSE CONTACT POINTS c iiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiitn F(15)=-((2.IX(30)IHN2I(C0S(X(48)))II2-2.IX(30)IC0S 8 (X(48))ISIN(X(48)) )/(AE2ll2)+(2.IX(30)IMM2l(SIN(X(48) ) )II2 8 +2.IX(30)IC0S(X(48))ISIN(X(48)))/(CE2II2))+X(58) F ( 16 ) Sš( ( 2 . t X ( 31 ) IHM2I ( COS ( X ( 49 ) ) ) 112-2 . t X ( 31 ) ICOS 8 (X(49))ISIN(X(49)))/(AE4II2)+(2.IX(31)INN2I(SIN(X(49)))II2 8 +2.IX(31)ICQS(X(49) )ISIN(X(49) ) )/(CE4lt2) )+X(59) F(17)=-( (2.IX(32)IHH5I(C0S(X(49) ) )II2-2.IX(32)IC0S 8 (X(49))I3IN(X(49)) )/(AE4lt2)*(2.IX(32)IMM5l(SIN(X(49) ))II2 8 +2.IX(32)IC0S(X(49))ISIN(X(49)))/(CE4II2))+X(60) F(18)=-( (2.IX(33)IHM5I(C0S(X(50) ) )II2-2.IX(33)IC0S 8 (X(50))ISIN(X(50)))/(AE5II2)+(2.IX(33)1HH5I(SIN(X(50)))II2 8 +2.IX(33)IC0S(X(50))ISIN(X(50) ) )/(CE5ll2) )+X(61) F(19)=-X(58)/(2.t( ((SIN(X(48) ))II2+HH2II2I(C0S(X(48) ) )II2 8 -2.IHH2IC0S(X(48))ISIN(X(48)))/(AE2II2)+((C0S(X(48)))II2 8 +HH2ll2l(SIN(X(48)))lt2+2.INH2IC0S(X(48))tSIN(X(48)) ) 8 /(CE2II2)))-X(18) F(20)=-X(59)/(2.t( ( (SIN(X(49) ))II2+NN2II2I(C0S(X(49) ) )II2 8 -2.IHN2IC0S(X(49))ISIN(X(49)))/(AE4II2)*((C0S(X(49)))II2 8 +HM2II2I(SIN(X(49) ))II2+2.IHN2IC0S(X(49) )ISIN(X(49)) ) 8 /(CE4II2)))-X(20) F(21)=-X(60)/(2.I(((SIN(X(49)))II2+NN5II2I(C0S(X(49) ))II2 8 -2.IHH5IC0S(X(49) )ISIN(X(49) ) )/(AE4tl2)+((COS(X(49)))tt2 8 ♦MH5tl2l(SIN(X(49)))tt2+2.IHH5IC0S(X(49))ISIN(X(49))) 8 /(CE4II2)))-X(22) F(22)=-X(61)/(2.t( ( (SIN(X(50)))ll2+HH5ll2t(C0S(X(50)))ll2 8 -2.ÍNH5tCQS(X(50))tSIN(X(50)))/(AE5tl2)+((C0S(X(50)))ü2 8 łHH5H2l (SIN( X ( 50) ) ) 112+2. IHH5IC0S( X ( 50 ) ) ISIN( X ( 50) ) ) 8 /(C£5II2)))-X(24) F(23)=HM2IX(18)+X(30)-X(19) F(24)=HH2IX(20)+X(31)-X(21) F(25)=MH5IX(22)+X(32)-X(23) F(26)=NH5IX(24)+X(33)-X(25) F(27)=-X(l)-X( 48) +PAR( 2 ) F(28)=-X(3)-X(49)+PAR(2) F(29)=-X(4)-X(50)+PAR(3) 3.309</page><page sequence="12">F(30)=( (2.IX(30)IHH2ł(CQS(X(48) ) )8I2-2.IX(30)8CQS 8 (X(48) )8SIN(X(48)))/(AE2II2)+(2.IX(30)IHH28(SIN(X(48) ) )II2 § +2.tX(30)tC0S(X(48) )tSIN(X(48) ))/(CE2tt2) )8t2-4.t( ((SIN « (X(48)))II2+HN2II2I(C0S(X(48)))II2-2.IMH2*CÖS(X(48))*SIN 8 (X(48)))/(AE2II2)+((C0S(X(48)))M2+NH2M2I(SIN(X(48)))U2+ 8 2.INM2IC0S(X(48))tSIN(X(48) ) )/(CE2tt2) )t( (X(30)tt2t 8 (C0S(X(48)))tt2)/(AE2tt2)*(X(30)tt2t(SIN(X(48)))tt2)/(CE2) 8 tl2-PAR( 1 ) ) F(31)s( (2.tX(31)tHH2!(C0S(X(49) ) )!t2-2.tX(31)tCQS 8 (X(49))tSIN(X(49)))/(AÊ4H2)*(2.tX(31)INN2l(SIN(X(49)))M2 v 8 +2.tX(31)fC0S(X(49))ISIN(X(49)))/(CE4tt2))M2-4.t(((SIN 8 (X(49)))tl2+HH2ll2l(C0S(X(49)))«2-2.»HN2IC0S(X(49))tSIN 8 (X(49)))/(AE4$I2) + {(C0S(X(49)))II2+MM2II2*(SIN(X(49)))H2+ 8 2.tHH2tC0S(X(49))ISIN(X(49)))/(CE4«2))t|(X(31)tl2l 8 (C0S(X(49)))tt2)/(AE4M2)+(X(31)tl2l(SIN(X(49)))M2)/(CE4) 8 l$2-PAR(i)) F(32) = ((2.&lt;X(32)IHH51(C0S(X(49)))M2-2.tX(32)tC0S- 8 (X(49))ISIN(X(49)))/(AE4tl2)+(2.tX(32)INM5t(SIN(X(49)))H2 8 +2.IX(32)IC0S(X(49))ISIN(X(49)))/(CE4U2))1I2-4.I(((SIN 8 (X(49)))ll2*HH5t»2l(C0S(X(49)))«2-2.tHH5IC0S(X(49))tSIN 8 (X(49)))/(AE4H2) + ((C0S{X(49)))ll2+MH5H2t(SIN(X(49)))882+ 8 2.tHH5tC0S(X(49))tSIN(X(49)))/(CE4tt2))t((X(32)tt2t 8 ( COS ( X ( 49 ) ))t$2)/(AE4łl2) + (X(32)M2ł(SIN(X(49) ))M2)/(CE4) 8 tl2-PAR(l)) F(33) = ((2.IX(33)tfW5»(C0S(X(50)))«2-2.tX(33)«C0S 8 (X(50))tSIN(X(50)))/(AE5tt2)+(2.tX(33)tHH5t(SIN(X(50)))t«2 8 +2.IX(33)tC0S(X(50))*SIN(X(50)))/(CE5U2))H2-4.t(((SIN 8 (X(50)))II2+MH5II2I(C0S(X(50)))I*2-2.*MM5*C0S(X(50))*SIN 8 (X(50)))/(AE5»2)ł((C0S(X(50)))U2+MM5t$2t(SIN(X(50)))«2+ 8 2.tMH58CQS(X(50) )3SIN(X(50) ) )/(CE5tt2) )I((X(33)IÍ2Í 8 (C0S(X(50)))«2)/(AE5tl2)*(X(33)»«2t(SIN(X(50)|)tt2)/(CE5) 8 tl2-PAR(l|) c mumtnmmmntmumttmttnmttmtnummu C I GEOMETRY EQUATIONS c mttmtmtutmmmuuttmmttntmtmttummtt F(34)=X(34)-L34ISIN(X(2))-X(38) F ( 35 )=X ( 36 ) -L34IC0S( X (2))-X(39) F(36)=X(38)-L23ISIN(X(1))-X(40) F(37)=X(39)-L23IC0S(X(1))-X(41) F(38)=X(35)+L56tC0S(X(4) )-X(42) F(39)=X(37)-L56$SIN(X(4))-X(43) F' 40)=( (FLZ2-X (43)-RE6+X ( 55) ) / (L6+XE6) )-C0S(K(5) ' F(41)=X(44)+(ZE4)1C0S(X(3))-(L4+XE4)»SIN(X(3))-X(34) F(42)=X(45)-(ZE4)ISIN(X(3) )-(L4+XE4)fC0S(X(3) )-X(36) F(43)=X(44)+(ZE4)tC0S(X(3))+(L45-XE4-L4)tSIN(X(3) )-X(35) F(44)=X(45)-(ZE4)ISIN(X(3) )+(L45-XE4-L4)IC0S(X(3) )-X(37) F(45)=(ZE5IS2-C2$(L5+XE5) )tSIN(X(4))+( (L5+XE5)tS2+C2tZE5) 8 IC0S(X(4))-C2l(6Z+(X(47)tC2)-X(25)-X(37) ) 8 -S2ł(GX+(X(47)łS2)-X(24)-X(35) ) F(46)=(-(L23-L2-XE2)ICl-Sl$ZE2)&lt;SIN(X(l))+(-ZE2tCl-Si&gt; 8 HL23-L2-XE2) ) )8C0S(X(i) )+Sll(6Z-X(19)+X(46)fSi-X(39) ) 8 -(GX-X(18)-X(46)IC1-X(38) )IC1 F(47)=6X*(((-(X(52)»S2)-X(20)-(X(51)tCI)+X(22))ICl 8 -(-X(21)-(X(52)tC2)+(X(51)tSl)+X(23) )tSi)/ 8 (C2IC1+S2IS1) )$C2-(CE4-X(52))tS2-X(44) F(48)=6Z-(((-(X(52)IS2)-X(20)-(X(51)*Ci)+X(22))*Cl 8 -(-X(21)-(X(52)IC2)+(X(51)tSl)+X(23))»Sl)/ 8 ( C2IC1+S28S1 ) ) 8S2- ( CE4-X ( 52 ) ) IC2-X ( 45) F(49)=X(38)-(L23-L2)ISIN(X(1))-X(53) F ( 50 ) =X ( 39 ) - ( L23-L2 ) ICOS ( X ( 1 ) ) -X ( 54 ) c utunmmmmmmututttmmmmmmmnmmt C t FORCE-DEFLECTION EQUATIONS c tmmmmmntmtmmttnmumtmtmtmnmmtt F(51)=(((X(46)).6T.0.0)t(X(46).LT.D8)t(F8/D8)lX(46) 8 +(X(46).LE.0.0)I(D10) 8 +(X(46) ,GE.D8)È(-i. )I(F8+(X(46)-D8)t( (F9-F8)/(D9-D8) )) j-X(26) F(52)=( ( (X(51) ) .GT.Ô.0)t(X(5i) .LT.D8)I(F8/D8)&gt;X(51) 8 +(X(5i).LE.0.0)l(-l. )&lt;(D10) 8 +(X(5i) .GE.D8)t(-l. )$(F8+(X(51)-D8)t( (F9-F8)/(D9-D8) ) ))-X(27) F(53)=(((X(52)).GT.0.0)&lt;(X(52).LT.D8)MF8/D8)*X(52) 8 +ÍXÍ52) .LE.O.O)t(DlO) 8 +(X(52).6E.D8)f(-l.)l(F8+{X(52)-D8)l((F9-F8)/(D9-D8))))-X(28) F(54)=(( (X(47) ) .GT.0.0)I(X(47) .LT.D8)I(F8/D8)IX(47) 8 +(X(47) .LE.0.0) t (DIO) 8 +(X(47) .6E.D8)t(-l. )t(F8+(X(47)-D8)t( (F9-F8)/(D9-D8) ) ) )-X(29) F(55)=FKtX(55)-X(56) c mtttmmnmummmmmmmtmttmmntmnm C I IDENTITIES c tttmmmmmummtmnmtmtmtmmmmmtm Fí56)=X(í2)-X(9) F(57)=X(14)-X(ii) F(58)=X(13)-X(16) F(59)=X(15)-X(17) F ( 60 ) =X ( 8 ) -X ( 6 ) F(6i)=X(iö)-X(7) RETURN END Table B-l - Correspondence Between Input Variables in Equilibrium and Preprocessor Programs and the Variables Defined by MVMA 2-D (MVMA 2-D card 44 - field 44) HI HI HŁ Ł6 ie6 re6 (203-1) (203-9) (203-6) (202-6) (220-3) (220-5) DI DZ Gl GZ HI IZ (411-4) (411-5) (411-6) (411-7) (411-6) (411-7) do fo do F9 fDif ffoi (407-2) (407-3) (407-2) (407-3) (407-2) (407-3) FLI2 FLZ2 FŁI3 FLZ3 (411-4) (411-5) (411-6) (411-7) Ł23 12 Ł2 xe2 ie2 ae2 c«2 (201-2) (203-2) (202-2) (220-3) (220-4) (220-5) (220-6) 122 162 182 (203-718) (201-8) (201-9) Ł34 13 Ł3 (201-3) (203-3) (202-3) Ł45 H4 Ł4 xe4 iti ae4 ce4 (201-4) (203-4) (202-4) (220-3) (220-4) (220-5) (220-6) L56 H5 Ł5 ie5 ie5 ae5 ce5 (2Ó1-5) (203-5) (202-5) (220-3) (220-4) (220-5) (220-6) 11(3) 11(4) 11(5) (207-1) (208-1) (209-1) 12(3)* 12(4)* 12(5)* * approximated froi HTIA ST0P(3) ST0P(4) ST0P(5) (207-8)** (208-8)** (209-8)** ** these vahes have the opposite siga of the IVHà lapat STDK3) STDK4) S TDK 5) (207-7)** (208-7)** (209-7)** Ti(3) TI(4) TH(5) (217-3)** (217-4)** (217-5)** 10* FBI* 3.310</page><page sequence="13">871111 Appendix C - Preprocessor Program Code CHARACTERI128 DATF I LE, ANSWER, ANS INTEGER N , I THAX 9 1 ER , ANSW REAL WK(1000),X(12),XX(6i),PAR(8) , F NORM REAL M2,M22,M3,M4,M5,MH,MN,ML,L2,L3,L4,L5,L6,MM2,HM5 REAL L23,L34,L45,L56,MU,6AM,PD, PI, LLL, LIMIT REAL TH(6) ,K1(6) ,K2(6),STUP(6),STDN(6) COMMON/BLK 1 /MM2 , AE2 , CE2 , AE4 , CE4 , MM5 , AE5 , CES , X X , « C1,C2,S1,S2,GX,S2 EXTERNAL FCN,FCN1 OPEN ( UN I T=25 , STATUS= ' NEN ' , F I LE= ' X . DAT ' ) OPEN ( UN I T=26 , ST ATUS= ' NE« ' , F I LE= ' X42 . DAT ' ) 200 FORMÂT ( A128) DATA PAR/0. NSI6=4 NRITE(6,210) 210 FORMAT (IX,' ENTER DATA FILE NAME:',*) READ(5,220)DATFILE 220 FORMAT (A128) OPEN ( UN I T=7 , F I LE=DATF I LE , ST ATUS= ' OLD ' , READONLY , SHARED ) c ttmmmmmtmmmmmmmmmtmmmmtm C t READ INPUT DATA c mmtmmmmmtmmtttmmmtttmtttutttmtttt READ (7, 240) NH,MN,ML,L6,XE6,RE6 RE AD (7, 240) DX,DZ,6X,6Z,HX,HZ RE AD (7, 240) D8,F8,D9,F9,FDEF,FF0R READ (7,240) FLX2,FLZ2,FLX3,FLZ3 READ( 7 ,240 ) L23,M2,L2,XE2,ZE2,AE2,CE2 READ( 7 , 240 ) M22,XS2,ZS2 READ (7, 240) L34,M3,L3 RE AD (7, 240) L45,M4,L4,XE4,ZE4,AE4,CE4 RE AD (7, 240) L56,M5,L5,XE5,ZE5,AE5,CE5 READ (7, 240) K1(3),K1(4),K1(5) READ( 7 ,240 ) K2(3),K2(4),K2(5) READ (7, 240) STUP(3) ,STUP(4) ,STUP( 5) READ( 7 , 240 ) STDN(3),STDN(4),STDN(5) READ (7, 240) TH( 3 ) , TH( 4 ) , TH( 5 ) READ( 7 ,240 )MU,FRI c uuttmmutmtmmmmutmmmtttmtmmutm C I SET INITIAL VALUES c mmttmnmtmmmmmtttnttumtttmmnmmt FK=FFQR/FDEF PI=3. 14159265 PD=180.0/PI 6F=386.088 D10=0.0 ZS2=-ZS2 ALPHA1=ATAN ( ABS ( ( 6X-DX ) / ( 6Z-DZ ) ) ) ALPHA2=ATAN ( ABS ( ( 6Z-HZ ) / ( 6X-HX ) ) ) C1=C0S( ALPHAI ) S1=SIN( ALPHA1 ) C2=C0S(ALPHA2) S2=SIN( ALPHA2 ) DO 10,1=3,5 K1(I)=K1(I)IPD K2(I)=K2(I)tPD STUP ( I ) =STUP ( I ) /PD STDN(I)=STDN(I)/PD TH(I)=TH(I)/PD 10 CONTINUE WH=MH*6F WN=MN*6F WL=MLIGF 62=L23-L2-XE2 ZFL=FLZ2 W2=M2*6F W22=M22IGF W3=M3tbF W4=M4I6F «5=M5I6F MM2=(6Z-DZ)/(6X-DX) MM5= ( HZ-6Z ) / (HX-6X) 6AM=ATAN( (FLZ2-FLZ3)/ (FLX3-FLX2) ) C6AM=C0S(6AM) SGAM=SIN(GAM) T6AM=TAN(GAM) LLL= ( RE6I ( 1 . -C6AM ) ) /T6AM LIMIT=FLX2+LLL-RE6*SGAM 240 FORMAT (7F1Ô.3) ITMAX=200 WRITE(ó, 245) 245 FORMAT (IX,' ENTER ANGLES FOR UPPER TORSO, LONER TORSO, HIP AND UP GPER LEG') READ(5,t)XX(i),XX(2),XX(3),XX(4) XX(1)=XX(1)/PD XX ( 2 ) =XX ( 2 ) /PD XX(3)=XX(3)/PD XX(4)=XX(4)/PD WRITER 6, 250) 250 FORMAT (IX, 'ENTER CHEST C.6. COORDINATES') READ(5,$)XX(53) ,XX(54) «RI TE (6, 260) 260 FORMAT (/,17X, 'UPPER TORSO ' , 2X , LOWER TORSO ,6X, HIP ,7X, 8 'UPPER LEG', 4X,' LONER LEG',/) WRITE(6,270)XX(i)IPD,XX(2)&lt;PD,XX(3)$PD,XX(4)IPD 270 FORMAT (IX, 'ANGLES ARE: ' ,6X,5(F8.3,5X) ,/) 20 «RITE(6,28Ô) 280 FORMAT (IX, 'WOULD YOU LIKE TO CHANGE A VALUE? (YES OR NO)') ACCEPT 200, ANS IF ( ANS.EQ. ' YES ' )THEN 30 «RI TE (6,290) 290 FORMATilX, 'ENTER # TO BE CHANGED ' ,/,5X, ' 1-UPPER TORSO', /,5X, 8 ' 2-LOWER TORSO ,/ ,5X, * 3-HIP' ,/,5X, ' 4-UPPER LEG',/,5X, § ' 5-CHEST C.6. (X-DIR. ) ' ,/,5X, ' 6-CHEST ' 8 ,'C.G. (Z-DIR. ) ' ,/,5X, ' 7-NO CHANGE ',/,5X, 8 ' 8-EXIT THE PROGRAM) ACCEPT I, ANS« IF( ANSW.EQ. 7)THEN WRITE(6,260) WR I TE ( 6 , 270 ) X X ( 1 ) IPD , X X ( 2 ) IPD , X X ( 3 ) &lt;PD , X X ( 4 ) IF'D GOTO 50 END I F I F ( ANSW . EQ . 3 ) GOT 0 999 NRITE(6,300) 300 FORMAT (IX, 'ENTER NE« VALUE) READ( 5, t ) , VAL DO 40,1=1,4 IF(ANS«.EQ.I)THEN XX( I )=VAL/PD GOTO 30 ENDIF 40 CONTINUE IF( ANSW.EO. 5) THEN XX (53)= VAL GOTO 30 ELSE IF (ANSW.EQ. 6) THEN XX ( 54) =VAL GOTO 30 ENDIF ENDIF 50 GAM=ATAN( (FLZ2-FLZ3 ) / ( FLX3-FLX2 ) ) 3.311</page><page sequence="14">C6AH=C0S(6AH) S6AH=SIN(6AH) TGAH=TAN(6AH) LLL= ( RE6I ( 1 . -C6AH ) ] /T6AM LIHIT=FLX2tLLL-RE6IS6AH XX{48)=-XX(1)+6.2S XX(49)=-XX(3)+6.28 XX(50)=-XX(4)+4.71 N=12 X ( 1 )=-4 .783 "X ( 2 ) =-5 . 077 X ( 3 )=1 . 3998 X ( 4)=- . 21 X(5)=15.9 X ( ó) =15 . 8 X ( 7 ) =5 . 1 X (8j =3. 7 X(9)=5. X(10)=5. X(ll)=.l X ( 12)=. 1 CALL ZSCNT ( FCN ,NSI6 , N , I THAX ,PAR, X ,FN0RMf titt , 1ER ) XX( 18)=X ( 1 ) XX ( 20 )=X ( 2 ) XX ( 22 ) =X ( 3 ) X X ( 24 ) =X ( 4 ) XX(30)=X&lt;5) XX ( 31 ) =X ( 6 ) XX(32)=X(7) XX ( 33 ) =X ť 8 ) XX(58)=X&lt;9) XX ( 59) =X ( 10 ) XX(60)=X ( 11 ) XX ( 61 ) =X ( 12) XX ( 19 ) =HM2*XX ( 18)+XX(30) XXÍ21)=«H2tXX(20)+XX(31) XX ( 23 ) =HM5łXX (22)+XX(32) XX ( 25 ) =MM5ł XX ( 24 ) +XX ( 33 ) X X ( 56 ) =RLt ( L6/ ( L6+XE6 ) ) XX(55)=XX(5ů)/FtC XX(38)=XX(53 ) +{ L23-L2 )tSIN(XX(l)) X X ( 39 ) =X X ( 54 ) + ( L23-L2 ) »COS ( X X ( 1 ) ) XX(34)=XX(38)+L34*SIN(XX(2)) XX(36)=XX( 39) +L34tC0S( XX ( 2) ) XX(35)=XX(34)+L45*SIN¡XX(3)) XX(37)=XX(36) +L45ÍC0S( XX ( 3 ) ) XX(42)=XXi 35) +L564C0S ( XX ( 4 ) ) XX(43)=XX(37)-L56»SIN(XX(4) ) AAA=FLZ2-RE6+X X ( 55 ) -X X ( 43 ) B8B=L6+XE6 I F ( AAA . 8T . BBB ) THEN HRITE(6,I)'L0NER LE6 IS NOT TOUCH I N6 FLOORBOARD' 60T0 30 ENDIF XX ( 5) =ACOS ( AAA/BBB) T0EX=XX(42) + (L6+XE6)»SIN(XX(5) ) TOEZ=XX ( 43 ) + (L6+XE6 ) tCOSļ XX ( 5 ) ) IFITOEX.GT .LIHIT)PRINTI, 'FOOT THR0U6H TOEBOARD' XX(40)=XX(38)-L23»SIN&lt;XX(1) ) XX(41)=XX(39)-L23tC0S(XX(l) ) XX ( 44 }=- &lt; ZE4 ) fCOS( XX(3)) + (L4+XE4)tSIN(XX(3))+XX(34) XX(45)=+(ZE4)4SIN(XXÍ3) ) ♦&lt; L4+XE4) tCOS( XX Í 3) )+XX(36) XX(47)=(ZE5*S2-C2*(L5+XE5) )*SIN&lt; XX (4) )+ť (L5+XE5) tS2+C2«ZE5) « *C0S(XX(4) )-C2t(6Z-XXÍ25)-XX(37)l-S2*í6X+-XX(24)-XX(35) ) XX(46)=-( (-(L23-L2-XE2)»C1-S1*ZE. )«SIN(XX(1) )+(-ZE2«Cl-Sl* « Í-(L23-L2-XE2) ) ) *COS( XX ( 1 ) ) +S1* ( SZ-XX ( 19 ) -XX ( 39 ) ) « - (6X-XX ( 18)-XX (38) ) tCl ) N=2 XT 1)=.77 X ( 2 ) =3 . 58 CALL ZSCNT ( FCN1 , NS 18 , N , I TMAX , PAR , X , FNORM , WK , I ER ) XX(51)=X(1) XXT52)=X(2) XX(26)={TTXX&lt;46)) .6T.0.0)l(XX(46).LT.D8)t(F8/D8)*XX(46) 8 +TXX146) .LE.O.O)t(DlO) 8 +(XX(46).GE.D8)t(-l.)t(F8+(XX(46)-D8)4( (F9-F8 ) / ( D9-D8) ) ) ) XX(27)=( ( (**(51)). ST. 0.0)t(XX(51) . LT. D8) t ( F3/D8 ) &gt;XX ( 51 ) 8 +(XX(51) .LE.0.0)*(-1. )*TD10) « +(XX(51).6E.D8)*(-l.)t(F8+(XX( 51 )-D8) 4 ! (F9-F8) / (D9-Q8) ) ) ) XX (28) = ( ( ( XX ( 52) ) .6T.0.0) t ( XX ( 52) .LT.D8) t TF8/D8) 4XX&lt; 52) « +(XX(52).LE,0.0)t(D10) « + ( X X ( 52 ) . 6E . D8 ) * ( - 1 . ) Í ( F8+ ( X X ( 52 ) -08 ) í ( í F9-F8 ) / ( D9-D8 ) ) ) ) XX(29)=(((XX(47)) .GT.0.0)*(XX(47).LT.D8)»(F8/D8)*XX(47) 8 +(XX(47).LE.0.0)ł( DIO ) « +(XX(47).BE.D8)t(-l.)t( F8+ ( XX ( 47 ) -D8 ) « ( ( F9-F8 ) / ( D9-D8 ) ) ) ) TT3=( (XX(2)-XXíl) )-TH(3) )*K1&lt;3)*( í XX(2)-XX(1) ) .LE.STUP(3) .AND. 8 (XX(2)-XX(1)) .GE.STDN(3))I(-1. )-(Kl(3)1(STUP(3)-TH(3) ) + 8 ( (XX(2)-XX(1) )-STUP(3) )*K2T3))«( (XX(2)-XX(1)) .6T.STUPT3) ) 8 *(-1. )-(KlT3)»(STBN(3)-TH(3) )+( (XX(2)-XX( 1))-STDN(3) )»K2&lt;3) ) 8 t((XX(2)-XX(l)) .LT.STDNÍ3) )!(-l. ) TT4=( (XX(3)-XX&lt;2) i -THT 4 ) ) *K1 ( 4 ) » { ( X X ( 3 ) -XX ( 2 ) ) . LE . STUPT 4 ) . AND . 8 TXX(3)-XXT2) ) ,BE.STDN(4))*(-1. )-(Kl(4)t(STUP(4)-TH(4) )+ 8 ( !XX(3)-XX(2) )-STUP(4))*K2!4))í( (XXf3)-XX(2) i . GT. STUP ( 4 ) ) 8 «(-1. )-(Kl(4)*TSTDN(4)-TH(4) )+( TXX(3)-XX(2) )-ST0N¡4) )*K2(4) ) 8 *( (XX(3)-XX(2) ) .LT.STDNT4) )t(-l. ) TT5=(&lt; (XXÍ4)+PI/2.)-XX(3))-THT5))*Kl(5)*({ (XX(4)+PI/2. ) 8 -XX(3) ) .LE.STUPT5) .AND. ( ( XX ( 4) +PI /2 . )-XX ( 3 ) ) .6E.STDN(5) ) 8 *(-1. )-!Kl(5)*(STUP(5)-TH(5) )+( ļ ( XX ( 4 ) +PI/2. )-XX(3) )-STUP(5) ) 8 *K2(5)&gt;*( ((XX(4)+PI/2.)-XX(3)) .BT.STUP(5))t(-l. )-TKl(5)í 8 !STDN(5)-TH(5) )+( ( T XX ( 4 ) +PI / 2 . ) -XX ( 3 ) )-STDN( 5) ) *K2 ( 5) ) 8 *( ( (XX(4)+PI/2. )-XX(3)) .LT.STDNT5) )»(-!.) SUHFX=XXT26)*(Cl-FRI»Sl)+XX(27)*fCl-FRI*Sl)+XXT28)*!-S2-HU*C2) 8 +XX129)«(-S2-«U*C2) SUMFZ=XX(26)*(S1+FRI*C1)+XX(27)*TS1+FRI»C1)+XX(28)» 8 ( C2-MU*S2)+XX( 29 ) &gt; (C2-NUIS2 )+XX(56) SUHM01=-( (L6+XE6)tSIN(XXT5)) + (L56-L5-XE5 ) ICOS ¡ X X ( 4 ) ) 8 -ZE5*SIN(XX(4) ) -XX ( 24 ) ) ł ( XX ( 29 ) * T C2-MUÍS2) ) 8 +TRE6+(L6+XE6)*C0S(XX(5) )-(L56-L5-XE5)«SIN(XX(4) )-ZE5*C0S( XX ( 4 ) ) 8 -XX (25) ) t ( XX ( 29) t ( S2+MUÍC2 ) ) 8 -( (L6+XE6)»SIN(XX(5) )+L56*C0S(XX(4)) + (L45-L4-XE4)*SIN(XX(3) ) 8 +ZE44C0S(XX(3) )-XX ( 22) ) » ( XX ( 28) t (C2-HUÍS2) ) 8 +(RE6+(L6+XE6)IC0S(XX(5) ) -L56»SIN( XX ( 4 ) ) + (L45-L4-XE4 ) »COS &lt; XX ( 3 ) ) 8 -ZE4»SIN(XX(3) ) -XX ( 23 ) ) * ( XX ( 28) * i S2+MU4C2 ) ) 8 -Í TL6+XE6)ISIN(XX(5))+L56«C0S(XX(4))+(L45-L4-XE4)*S1NTXX(3) ) 8 +ZE4ÍC0S ( XX ( 3 ) ) -XX ( 20 ) ) t ( XX ( 27 ) * í SI +FR I »C1 ) ) 8 - ( RE6+ (L6+XE6 ) (COST XX(5))-L564SIN(XX(4)) + (L45-L4-XE4) tCOST XX ( 3 ) ) 8 -ZE4*SIN(XX(3) ) -XX Í 21 ) ) « ( XX ( 27 ) t (Cl-FRI *S1 ) ) e-{ (L6+XE6)łSIN(XX(5) ) +L56»C0S{ XX ( 4 ) )+L45»SIN( XX ( 3 ) )+L34»SIN ( X X ( 2 ) ) 8 +62*SIN(XX(1))+ZE2*C0S(XX(1) )-XX(18))*(XX(26)t(Sl+FRI*Cl) )-(RE6 8 +TL6+XE6) tCOST XX ( 5) )-L56łSIN(XX(4) ) +L454C0S ( XX ( 3) )+L34tC0ST X X ( 2 ) ) 8 +82*C0SÍXXÍ1))-ZE2*SIN(XX(1))-XX(19) )*( XX ( 26 )» (Cl-FRI »S1 ) ) SUMH02=(XE6*SIN(XX(5) ) ) * ( WL } + ( ( L6+XE6) «SIN( XX ( 5 ) )+(L56-L5)* 8 C0STXXT4) ) )IW5+((XE6+L6)tSIN(XX(5) )+L56»C0S(XX(4) )+(L45-L4)t 8 SIN(XX(3) ) )IH4+( (XE6+L6)*SIN(XX(5) )+L56*C0S(XX(4) )+(L45)t 8 SIN(XX(3) )+(L34-L3)»SIN(XX(2) ) ) »W3+ ( ( XE6+L6 ) *SIN( XX ( 5 ) ) +L56 8 *C0S(XX(4) )+(L45)*SIN(XX(3) )+L34«SIN(XX(2) )+(L23-L2)t 8 SIN(XX(1)))IH2 8 +( (XE6+L6)*SIN(XX(5) )+L564C0S(XX(4))+(L45)»SIN(XX(3) )+ 8 L34»SIN(XX(2))+L23ISIN(XX(1)))«(NH+HN) 8 +( (XE6+L6)*SIN(XX(5))+L56*C0S(XX{4))+(L45)»SIN(XXT3))+ 8 L34ISIN(XX(2))+(G2+XE2tXS2)»SIN(XX(l))+ZS2»C0S(XX(l)))»N22 SUHHO=SUHHO 1 +SUMH02 NRITE(6,310)SUMFX 310 FORMAT ( IX, ' THE SUH OF FORCES IN X-DIR=' .F10.2) MR I TE ( 6 , 320 ) SUMFZ 3.312</page><page sequence="15">871111 320 FORMAT ( IX , ł THE SUM OF FORCES IN Z-DIR=' ,Fi0.2) WR I TE ( 6 , 330 ) ( MH+MN+ML+M2+M22+M3+M4+M5+M6 ) *6F 330 FORMAT i IX, 'THE WEIGHT OF DUMMY =',F10.2) WRITE (6, 340) SUMMO 340 FORMAT (IX, 'THE SUM OF THE MOMENTS2' ,F13.2) WRITE ( 6 , t ' THE JOINT TORQUES ARE' ,TT3,TT4,TT5 TT3=-( (X(2)-X(i) )-TH(3) )IK1(3)I( (X(2)-X(l) ) . LE . STUP ( 3 ) . AND . 8 (X(2H(l)).6E.STDN(3))t(-i.)-(Kl(3)l(STUP(3)-TH(3)) + § i ( X ( 2 ) -X ( i ) ) -STUP i 3 ) ) IK2 ( 3 ) ) ł ( ( X ( 2 ) -X ( 1 ) ) . 6T . STUP ( 3 ) ) § t(-l. )-(Kl(3)t(STDN(3)-TH(3) )+( (X(2)-X(l) )-STDN(3))IK2(3)) 8 l((X(2)-X(l)).LT.STDN(3))*(-l.) TT4=-( (X(3)-X(2) )-TH(4) )$Kl(4)t((X(3)-X(2) ).LE.STUP(4) .AND. § (X(3)-X(2) ) .6E.STDN(4) )l(-l. )-(Kl(4)l(STUP(4)-TH(4) )+ 8 ( (X(3)-X(2) )-STUP(4) )1K2(4) )l( (X(3)-X(2) ) .6T.STUP(4) ) 8 t(-l. )-(Kl(4)t(STDN(4)-TH(4) )+( (X(3)-X(2) )-STDN(4) )IK2(4)) § l((X(3)-X(2)).LT.STDN(4))ł(-l.) TT5=-( ( (X(4)+PI/2. )-X(3) )-TH(5))tKl(5)t( ( (X(4)+PI/2. ) § -X(3)).LE.STUP(5).AND.((X(4)+PI/2.)-X(3)).GE.STDN(5)) § t(-l. )-(Kl(5)t(STUP(5)-TH(5))ł( ( (X(4)+PI/2. )-X(3))-STUP(5) ) 8 IK2(5))t( ( (X(4)+PI/2.)-X(3)).6T.STUP(5) )t(-i. )-(Kl(5)l 8 (STDN(5)-TH(5) )♦( ( (X(4)+PI/2.)-X(3))-STDN(5))tK2(5) ) 8 l(((X(4)+PI/2.)-X(3)).LT.STDN(5))*(-l.) WRITE(6,260) WRITE(6,270)XX(l)tPD,XX(2)IPD,XX(3)IPD,XX(4)tPD,XX(5)tPD WRITE(6,350)XX(26),XX(27) WRITE ( 6, 360 ) XX ( 28 ), XX (29) WRITE(6,370)XX(56) WRITE (6, 380) XX (53), XX (54) 350 FORMAT (IX, 'SEAT BACK FORCE' ,2X,F8.3,18X,F8.3) 360 FORMAT (IX, 'SEAT CUSH. FORCE' ,27X,F8.3,5X,F8.3) 370 FORM AT (IX, 'FLOORBOARD FORCE' ,53X,F8.3,/) 380 FORMAT ( 1 X , ' X AND Z CHEST C.6. COORDINATES ARE' ,2X,2(F8.3,2X) ) TYPE 390 390 FORMAT (IX, 'DO YOU WANT TO USE THESE VALUES? (YES OR NO)') ACCEPT 200, ANSWER IF ( ANSWER. EQ. 'NO' )60T0 30 XX(6)=XX(26)ł(Cl-FRIISl) X X ( 7 ) =X X ( 26 ) % ( -Si-FRI ICI ) +W2+W22+WH+WN XX(8)=XX(6) XX(9)=XX(8) XX(10)=XX(7) XX(11)=XX(10)+W3 XX ( 12)=XX (9) XX(13)=XX(27)*(C1-FRIIS1)+XX(28)I(-S2-MU*C2)+XX(12) XX ( 14)=XX ( 11 ) XX(15)=XX(27)t( -S1-FRHC1 )+XX(28)&lt;( -C2+MUIS2 ) +XX ( 14 ) +W4 XX(16)=XX(29)I(S2+MU*C2) XX ( 17 )=XX ( 15 ) XX ( 57 ) =WL-XX ( 56 ) DO 60,1=1,61 WRITE(25,t)XX(I) 60 CONTINUE WRITE(26,l)XX(i) WR I TE ( 26 , t ) X X ( 2 ) WRITE(26,I)XX(3) WRITE(26,I)XX(4) WRITE(26,t)XX(5) WRITE ( 26 , t ) XX ( 53 ) WRITE( 26 , t ) XX ( 54 ) WRITE(26,*)XX(46) WRITE(26,I)XX(51) WRITE( 26, &lt; ) XX ( 52) WRITE( 26, t ) XX (47) WR I TE ( 26 , t ) X X ( 44 ) WRITE( 26 , t ) XX ( 45) WRITE(26,t)XX(42) WRITE( 26, t ) XX (43) WR I TE ( 26 , &lt; ) X X ( 40 ) WRITE( 26 , * ) XX ( 41 ) DO 70,1=18,39 WRITE(26,t)XX(I) 70 CONTINUE WRITE(26,I)XX(48) WRITE ( 26, t ) XX ( 49) WR I TE ( 26 , ł ) X X ( 50 ) DO 75,1=58,61 WRITE(26,I)XX(I) 75 CONTINUE CLQSE(UNIT=26) STOP 999 END SUBROUTINE FCN (X,F,N,PAR) COMMON/ BLK 1 /MM2 , AE2 , CE2 , AE4 , CE4 , MM5 , AE5 , CE5 , XX , i C1,C2,S1,S2,6X,6Z REAL MM2,AE2,CE2,AE4,CE4,MM5,AE5,CE5,X(12) ,F(12) ,PAR(8) ,XX(61) F(1)=-X(9)/(2.I(((SIN(XX(48))) ÈÈ2+MM2I t 21 ( COS ( X X ( 48 ) ) ) 1 1 2 8 -2.IMM2IC0S(XX(48))»SIN(XX(48)))/(AE2«2) + ((C0S(XX(48)))«2 8 +MM2H2l(SIN(XX(48)))t*2+2.*MM2IC0S(XX(48))*SIN(XX(48))) 8 /(CE2M2)))-X(1)-PAR(1) F(2)=-X(10)/(2.t(((SIN(XX(49)))ll2*HM2M2t(C0S(XX(49)))M2 8 -2.łMM21C0S(XX(49))*SIN(XX(49)))/(AE4ł*2) + ((C0S(XX(49)))U2 8 +MM2t*2»(SIN(XX(49) ) ) t*2+2. *HM2tC0S( XX (49) ) &gt;SIN( XX (49) ) ) 8 /(CE4M2)))-X(2)-PAR(2) F(3)=-X(li)/(2.I(((SIN(XX(49)))M2+MM5*Í2*(C0S(XX(49)))U2 8 -2.*MM5*C0S(XX(49))ISIN(XX(49)))/(AE4**2)+((C0S(XX(49)))tl2 8 +MM5l*2*(SIN(XX(49)))«2+2.*MM5tC0S(XX(49))ISIN(XX(49))) 8 /(CE4II2) ) )-X(3)-PAR(3) F(4)=-X(12)/(2.ł(((SIN(XX(50)))«2łMM5f»2l(C0S(XX(50)))«2 8 -2.łMM5łC0S(XX(50))ISIN(XX(50)))/(AE5«2)+((C0S(XX(50)))l«2 8 +MM5M2I(SIN(XX(50)))II2+2.IMM5*C0S(XX(50))*SIN(XX(5Ô))) 8 /(CE5M2)))-X(4)-PAR(4) F(5)=((2.*X(5)IMM2$(C0S(XX(48)))I*2-2.$X(5)*C0S 8 (XX(48))ISIN(XX(48)))/(AE2H2)+(2.IX(5)*MM2l(SIN(XX(48)))ł*2 8 +2JX(5)*C0S(XX(48))ISIN(XX(48)))/(CE2H2))«2-(4.«(((SIN 8 (XX(48)))tt2+MM2«2*(C0S(XX(48)))«2-2JMM2IC0S(XX(48))»SIN 8 (XX(4B)))/(AE2U2)*((C0S(XX(48)))II2+MM2M2I(SIN(XX(48)))M2+ 8 2.IMM2$C0S(XX(48))ISIN(XX(48)))/(CE2**2))I((X(5)H2* 8 (C0S(XX(48)))M2)/(AE2II2) + (X(5)M21(SIN(XX(48)))M2)/(CE2) 8 H2-PAR(5))) F(6)=((2.IX(6)*MM2I(C0S(XX(49)))U2-2.IX(6)*C0S 8 (XX(49))*SIN(XX(49)))/(AE4M2)+(2.tX(6)tMM2t(SIN(XX(49)))M2 8 +2.IX(6)»C0S(XX(49))ISIN(XX(49)))/(CE4«2))«2-(4.t(((SIN 8 (XX(49)))*I2+MM2**2I(CQS(XX(49)))H2-2.*MM2ICQS(XX(49))ISIN 8 (XX(49)))/(AE4I$2) + ((C0S(XX(49)))H2+MM2M2»(SIN(XX(49)))M2+ 8 2.$MM2IC0S(XX(49))*SIN(XX(49)))/(CE4**2))Í((X(6)»2* 8 (C0S(XX(49)))M2)/(AE4M2)+(X(6)H2«(SIN(XX(49)))M2)/(CE4) 8 l*2-PAR(6))) F(7)=((2.»X(7)tMM5»(C0S(XX(49)))«2-2.IX(7)IC0S 8 (XX(49))ISIN(XX(49)))/(AE4M2) + (2.IX(7)*MM5*(SIN(XX(49)))M2. 8 +2.IX(7)*C0S(XX(49))*SIN(XX(49)))/(CE4II2))U2-(4.$(((SIN 8 ( XX ( 49 ) ) ) I12+MM5I 121 ( COS ( XX ( 49 ) ) ) 112-2 . IMH5IC0S ( X X ( 49 ) ) ISIN 8 (XX(49)))/(AE4l*2)+((C0S(XX(49)))H2+MM5l*2t(SIN(XX(49)))lf2+ 8 2.IMM5*C0S(XX(49))ISIN(XX(49)))/(CE4**2))I((X(7)II2I 8 (C0S(XX(49)))M2)/(AE4M2)+(X(7)M2«(SIN(XX(49)))*I2)/(CE4) 8 l$2-PAR(7))) F(8)=((2.*X(8)*MM5I(C0S(XX(50)))$I2-2.IX(8)*C0S 8 (XX(50))ISIN(XX(50)))/(AE5t»2)+(2.IX(8)IMM5l(SIN(XX(50)))ll2 8 +2.»X(8)tC0S(XX(50))tSIN(XX(50)))/(CE5«2))«2-(4.t(((SIN 8 (XX(50)))t*2+MM5*l2f(C0S(XX(50)))l*2-2.IMM51C0S(XX(50))*SIN 8 (XX(50)))/(AE5II2)*((C0S(XX(50)))M2+MM5W2I(SIN(XX(50)))«2* 8 2.*MM5*C0S(XX(50))*SIN(XX(50)))/(CE5H2))1((X(8)**2I 8 (CQS(XX(50)))*$2)/(AE5H2)+(X(8)l*2t(SIN(XX(50)))*l2)/(CE5) 3.313</page><page sequence="16">8 $$2-PAR(8) } ) F ( 9 ) =- ( ( 2 . 1 X ( 5 ) IHH2I ( COS ( X X ( 48 ) ) ) I $2-2 . $ X ( 5 ) ICOS 8 (XX(48))$SIN(XX(48)))/(AE2$$2)+(2.$X(5)$HM2$(SIN(XX(48) ) )$$2 8 +2.IX(5)ICQS(XX(48))$SIN(XX(48)))/(CE2I$2))+X(9) F(t0)=-((2.IX(6)IM«2I(C0S(XX(49)))$I2-2.$X(6)$C0S 8 (XX(49))$SIN(XX(49) ) )/(AE4$$2)+(2.$X(6)INH2$(SIN(XX(49) ) )$$2 8 t2.IX(6)IC0S(XX(49))ISIN(XX(49)))/(CE4l$2))+X(10) F(11)=-((2.$X(7)$MH5$(C0S(XX(49)))I$2-2.$X(7)$C0S 8 (XX(49) )$SIN(XX(49) ) )/(AE4$$2)+(2.$X(7)$MM5$(SIN(XX(49) ) )$$2 8 +2.$X(7}$CQS(XX(49) )$SIN(XX(49) ) )/(CE4$$2) )+X(li) F(12)=-( (2.$X(8)$MH5$(C0S(XX(50) ) )$$2-2.$X(8)$C0S 8 (XX(50j}ISIN(XX(5Ô)))/(AE5l$2)+(2.$X(8)$NH5$(SIN(XXí50)))l$2 8 +2.$X(8)$C0S(XX(50))$SIN(XX(50) ) )/(CE5$$2) )+X(12) RETURN END SUBROUTINE FCNl (X,F,N,PAR) COMMON/ BLK1/MM2 , AE2 , CE2 , AE4 , CE4 , MHS , AE5 , CES , XX , 8 Ci,C2,Sl,S2,GX,6Z REAL X(2) ,F(2) ,XX(61) F(i)=i6X+( ( (-(X(2)$S2)-XX(20)-(X(1)$C1)+XX(22))$C1 8 -(-XX(21)-(X(2)$C2)+(X(i)$Sl)+XX(23) )$S1)/ 8 (C2IC1+S2$S1))$C2-(CE4-X(2))IS2)-XX(44) F(2)=(6Z-( ( (-(X(2)$S2)-XX(20)-(X(l)$Ci)+XX(22) )$Ci 8 -(-XX(21)-(X(2)$C2)+(X(Í )$S1)+XX(23) )$S1)/ 8 (C2IC1+S2I5Í) )$S2-(CE4-X(2) )$C2)-XX(45j RETURN END 3.314</page></plain_text>