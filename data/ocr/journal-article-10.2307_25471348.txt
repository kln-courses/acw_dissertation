<plain_text><page sequence="1">Statistics for Digital Human Motion Modeling in Ergonomics Julian Faraway Department of Mathematical Sciences University of Bath Bath, BA2 7AY, UK (jjf23@bath.ac.uk) Matthew P. Reed Transportation Research Institute University of Michigan Ann Arbor, Ml 48109 (mreed @ umich. edu) Modern manufacturing demands that products be designed for the comfort and accessibility of consumers as well the health and safety of employees in the workplace. Speed of implementation requires that these designs be constructed in a virtual world. Digital human models are required for these virtual worlds for the exploration of vehicle and manufacturing designs from an ergonomic perspective. This article provides an overview of the ergonomic issues and statistical methods for human motion modeling. We first describe methods for modeling the basic elements of motion, decomposed into univariate curves, three-dimensional trajectories, and orientation trajectories. We then present methods for combining the components of the motion into a coherent whole. Two application examples in truck driver behavior and sheet metal assembly illustrate the methodology. KEY WORDS: Digital human model; Functional data analysis; Orientation; Quaternions; Trajectories; Virtual manufacturing. 1. INTRODUCTION Consider the design and production of a new vehicle. The vehicle must be built and used by humans, so the design must accommodate a wide range of heights, strengths, ages, and so on. On the product side, we must ensure that the customer can perform all of the necessary functions in a safe and comfortable manner, whereas on the manufacturing side, we must ensure that large volumes of the vehicle can be made within the capa bilities of a wide range of workers. Years ago, manufacturers could build a sequence of proto types and use these to discover and rectify any problems. But now competitive pressures mean that the time to bring a vehi cle to market is greatly reduced. Automotive manufacturers aim to produce the design for a new vehicle and the manufacturing facility to build it in an entirely virtual world. This speeds the introduction of a new vehicle, but means that designers must aim to anticipate any ergonomic problems before a physical build of the vehicle is completed or a new production facility is built. Experience with similar vehicles produced in the past is useful, but new vehicles have new features that may require design modifications. For these reasons, we need models that predict how humans of different types will behave in vehicle and workplace environments. We can then experiment with dif ferent virtual humans in the vehicle or production environment to detect any ergonomic problems and suggest appropriate de sign modifications. One important aspect of human behavior that is relevant to ergonomic analysis is volitional, task-oriented movement. As can be readily seen, there is substantial variation in the way that people move depending on their physical size, gender, age, and other factors. There is also natural, but unexplained, variation in human movement. Predicting human motion and modeling this variation is a task for which statistical methods can be useful. Even so, there is a wide range of other approaches to motion prediction, discussed later, with which statistical methods must compete. Our overall aim is to present a suite of statistical methods for human motion modeling. Although most of our efforts have been directed toward digital human models for vehicle design and manufacturing, the methods that we present are applicable to ergonomic issues arising in other industries and institutions. For example, digital human models have proven useful in the design of retail stores so that wheelchair users, both customers and sales assistants, can comfortably use the checkouts. Human motion modeling is also used in other areas, such as sport, neuroscience, and movie and video game production. The objectives in these areas vary, and although the methods that we present here can be useful, other approaches may be better. For example, in current video games, the characters perform motions from a limited and precalculated library of motions due to the demands of real-time performance. In this article we provide a background to the ergonomic issues in Section 2. Motion of the whole body is composed of several simpler parts, for example, how the head or the hand moves. In Section 3 we describe the statistical methods that we have developed for modeling these elemental compo nents of motion. We describe methods for modeling univari ate curves, such as the angle of some body segment over time; three-dimensional (3D) trajectories, such as those formed by the hand during motion, and orientation trajectories, such as those formed by the head. We also describe how we collect human motion data and discuss how its characteristics affect the choice of analysis. The elemental motion must be combined into predictions of motion for the whole body in Section 4. This is not straightforward, because the parts must be combined co herently to form the whole. In Section 5 we present two ap plication examples showing the utility of our research, and we finish with a discussion of possible future research in Section 6. ? 2007 American Statistical Association and the American Society for Quality TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3 DOI 10.1198/004017007000000281 277</page><page sequence="2">278 JULIAN FARAWAY AND MATTHEW P. REED 2. ERGONOMICS BACKGROUND Ergonomics is the study of people at work and the practice of matching the features of products and jobs to human capa bilities, preferences, and limitations (Chaffin, Andersson, and Martin 1999). Industrial ergonomics focuses on ensuring that jobs are designed for safe and efficient work. In product design, ergonomics guides the selection of product features and design characteristics that will improve the safety, comfort, and perfor mance of users. Ergonomics is also an important consideration in the design of products for maintainability and disassembly for recycling. Historically, ergonomics has been largely reactive, fix ing problems as they are identified. But computer-aided de sign tools increasingly allow ergonomics considerations to be addressed early in the design of products and indus trial processes through computer simulations. Human capa bilities, requirements, and performance are represented in these simulations through the use of digital human models (DHMs), software avatars that represent human size, shape, strength, vision, and movement as they interact with virtual geometry and environments (Chaffin 2001). Current commer cial DHM tools, such as Safe Work (http://www.safework.com/) and Jack (http://www.ugs.com/products/tecnomatix/human_ performance/jack/), have sophisticated algorithms for body dimension scaling and for analyzing the internal forces and torques that would be experienced by a person performing the simulated tasks. Porter, Case, Freer, and Bonney (1993) summarized appli cations of digital human models in vehicle ergonomics during the early years of personal computers, at which time few of the current commercial DHM software tools were in use. DHMs are now widely used in the design of products, particularly air craft, cars, trucks, and other vehicles. Industrial manufacturers are also increasingly using DHMs to simulate workers in com puter simulations of new plants or processes. Despite these suc cesses, however, the use of DHMs has been hampered by the lack of fast, accurate, and reliable posture and motion simula tion. Until recently, simulating a task that would be very sim ple for a real human, such as walking to a shelf and picking up a tool, required the ergonomics analyst to perform time consuming manual posturing of the figure at each critical tran sition in the motion. Using this process, known in animation as keyframing, takes a skilled analyst many hours to create a sim ulation of a manual activity that would take a few seconds for a person to perform. Yet this process does not necessarily provide accurate postures or motions, dependent as it is on the analyst's judgment as to how a person actually would perform the task. Moreover, the analyst often must redo much of the work if the environment is changed or the characteristics of the virtual hu man (such as body size) are altered. The highly time-consuming nature of keyframe animation presumably creates a substantial incentive to develop predictive tools. Yet, because of the difficulty of developing the necessary algorithms, human motion simulation for entertainment appli cations (films, video games) and for ergonomics has increas ingly been achieved through the capture and editing of spe cific human motions. In feature films, commercials, and video games, nearly every movement of a computer-generated char acter is produced by playing back motion data obtained from a human actor, possibly after modifying or "warping" the motion. The seemingly insurmountable advantage of motion-capture data over motion prediction for commercial animation is the obvious naturalness of the motion. When the movie or video game director knows that a particular character will perform a particular motion with a particular prop, or when the phys ical repertoire of a game character is limited to a handful of actions, motion capture (with sophisticated editing and modifi cation software) meets the need. Thus relatively little effort has been directed toward the realistic prediction of novel human motions. As evidence of the importance of posture and motion simu lation, dozens of works in the automotive engineering literature and in other forums have presented a wide variety of methods for human simulating postures and motions, including multiple regression (Snyder, Chaffin, and Schutz 1972); analytic and nu merical inverse kinematics (IK) (Jung, Kee, and Chung 1995; Tolani, Goswami, and Badler 2000); optimization-based IK (Wang and Verriest 1998); differential IK (Zhang and Chaffin 2000); functional regression on stretch-pivot parameters (Far away 2003a); scaling, warping, and blending of motion-capture data (Park, Chaffin, and Martin 2002; Faraway 2004a; Monnier, Wang, Verriest, and Goujon 2003; Park, Chaffin, and Martin 2004; Dufour and Wang 2005); and many forms of optimiza tion (e.g., Flash and Hogan 1985; Engelbrecht 2001; Marler, Rahmatalla, Shanahan, and Abdel-Malek 2005; Wang, Xiang, Kim, Arora, and Abdel-Malek 2005). Every software manikin used for ergonomics includes some IK capability for posturing. Given a particular position and ori entation in space for a hand or foot, the software will use IK methods to calculate the angles of the joints of adjacent seg ments to attain the goal. The problem is underdetermined, be cause the linkage system (arm or leg) has more kinematic de grees of freedom than are specified for the hand or foot. The methods for performing IK calculations and solving the redun dancy problem vary widely. An extensive literature on IK has emerged from the field of robotics, because placing an end ef fector at a particular location in space, or tracing a path, is an essential function of industrial robots. However, IK alone pro duces a feasible posture, not necessarily a likely or accurate posture. In some cases, as in the RAMSIS software, the joint angles are calculated to maximize the likelihood of the joint angles relative to a stored set of joint-angle probability distri butions. When applied in task situations similar to those used for collecting the underlying data, this approach yields postures that have the most likely joint angles for similar size people while meeting the kinematic constraints. One common approach is to assume that humans will move to optimize some criterion that represents effort or comfort, for example, subject to the constraints imposed by the task. Ex amples of this type of approach include the minimization of joint torques (Uno, Kawato, and Suzuki 1989), minimization of the rate of change of segment acceleration (Flash and Hogan 1985), minimization of joint deviations from neutral (Marler et al. 2005), and maximization of strength as a function of joint angles (Zacher and Bubb 2005). Visually realistic motion is a necessary but not sufficient level of fidelity for ergonomics analysis. Because DHMs are used for quantitative assessments of reach capability, body clearances, TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="3">DIGITAL HUMAN MOTION MODELING 279 strength, and tissue stresses, human simulations for ergonomics applications must be quantitatively accurate, meaning that they are in some way quantitatively representative of the manner in which the people with the specified characteristics would per form the tasks being investigated. This need for quantitative accuracy means that the algorithms used to generate the mo tion must be developed and validated with reference to data from real, task-oriented human motions. And because the vari ation in the motions of people performing the same task is often of considerable interest, the algorithms, and the understanding underlying them, must encompass important aspects of human variability. Our strategy can be distinguished from others by the follow ing characteristics. Our approach is empirical, and our models derive directly from data. This is, of course, natural to a statis tician, but it is not the path followed by many human motion modelers. The contrasting approach is to develop rules or the ories about how people move, often embodied in the optimiza tion approach discussed earlier, and use these to develop motion predictions. The efficacy of these models is then evaluated by a visual assessment of the authenticity of the motion, perhaps combined with a comparison to smaller amounts of observed motion data. The two styles of modeling have different advantages. Statis tical approaches such as ours do allow an understanding of vari ation in human motion and permit statistical inference. Motion predictions based on such models might be expected to perform relatively well in situations close to the data on which they are based. In contrast, the nonstatistical approaches are typically more ambitious in their scope and might hope to outperform the statistical models in predicting motion in new environments for which no similar data are available. Given the wide scope of possible human motion, we expect that a combination of the two styles of approach will be necessary for wider success. Well-established but simpler statistical methods have been frequently used by human motion modelers; mostly for the simpler problem of static posture prediction. We have devel oped methods for modeling motion that use recent statistical advances in functional data analysis. 3. STATISTICAL METHODOLOGY In this section we describe the nature of human motion data and the methods that we have used to analyze it. 3.1 Motion-Capture Data Data on how people move provide the raw material for our analysis. Motion capture (sometimes abbreviated as mocap) is a technology for recording motion. Markers are attached to a subject, and sensors track these markers as the subject moves. The most commonly used systems are optical or magnetic in nature. It is important to understand how the data are collected, because this has an impact on the choice of methods used for analysis. In an optical system, reflective markers are attached to key locations on the body, such as the elbow and shoulder. The po sition of the markers is triangulated by special cameras. The accuracy of these systems is normally very good, with errors of 1 mm or less. However, various problems can occur that affect the quality of the data and the effort needed to process it. The markers are indistinguishable and so must be identified as the left wrist, right shoulder, and so on. (The active opti cal marker systems that are becoming more widespread avoid this problem, because the markers are uniquely identified.) The processing software is then usually able to keep track of the identities of the markers, but confusion can occur when mark ers pass close to one another or are temporarily obscured. Thus human intervention is necessary to "track" the data in its raw state to a form suitable for analysis. This processing can be quite time-consuming, sometimes taking much longer than the original collection of the data, including the experiment setup time. Optical systems require a clear line of sight to the tar get. Although data collectors use several cameras, markers may be obscured by other parts of the subject's body or the props used to simulate the environment. Thus it is difficult to collect motion-capture data outside the laboratory or for motions that require a large field of action. In a magnetic system, three orthogonal coils are mounted in a transmitter and in each marker. The relative magnetic flux between the transmitter and the receiver in the marker allows one to determine both the location and orientation of the re ceiver. This offers an advantage over the optical system in that to record the location and orientation of, say, the hand, three optical markers would be required, whereas only one magnetic marker would suffice. The magnetic system also has the ad vantage of not requiring a line of sight, making it useful for, say, recording the torso motion of a subject in a car seat. Even so, magnetic systems often require that the markers be wired, which restricts and sometimes interferes with subject's the nor mal motion. Magnetic systems also are sensitive to metallic ob jects in the environment, such the steel reinforcement bars used in concrete in modern buildings or electrical fields caused by other experimental equipment. The accuracy of a magnetic sys tem tends to be significantly worse than an optical systems, par ticularly toward the boundaries of the operating region. One further difficulty is that the markers are mounted on the exterior of the body, whereas we would prefer to model the motion of the joint centers. For example, consider a marker mounted on the shoulder, placed as consistently as possible on a specified bony location. Instead of modeling this marker di rectly, it would be better to project down to the center of rotation of the shoulder joint. This is no simple task, because it depends on the posture and anthropometry of the individual. Neverthe less, algorithms exist for solving this problem. After processing, the data will consist of the 3D coordinates of the markers collected over time. A frequency of observation of 25-50 Hz might be typical. Recording motion for just a cou ple of seconds for sufficient markers to describe the motion thus will generate a moderately large amount of data, particularly when it is considered that this would be just a single data point of motion among a larger collection of motion data. Statisti cians should note that smoothing is typically not necessary, be cause the data contain little noise and the trajectory of a marker can reasonably be reconstructed by smoothly interpolating the points. At the HuMoSim laboratory in the Center for Ergonomics at the University of Michigan, we have collected data on more TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="4">280 JULIAN FARAWAY AND MATTHEW P. REED * ** ? *ad?^m2?S. JH^B^^Bffite, 'Sffiffifflfc-tflfflffe.'^felSSfe. *%????'' -' Figure 1. Motion capture in the laboratory. Optical markers can be seen as small white balls. than 70,000 motions. The experiments have focused on driving and workplace tasks such as reaching for controls within a car or truck, lifting objects onto shelves, and stepping around a small area while performing various tasks. Other researchers have collected motion databases of humans performing a much wider variety of motions (see, e.g., mocap.cs.cmu.edu). An ex amples of motion capture from the HuMoSim laboratory is shown in Figure 1. One of the inherent drawbacks of laboratory-based motion capture is that it places the subjects in an unnatural environ ment. The ability to reliably and accurately capture motion in workplace or on the street would be very valuable, but it is cur rently difficult to accomplish reliably. Human motion can be captured directly from ordinary video footage. With more than one camera, the possibility of triangulating points on the body from the video images exists, although this is by no means easy. With only one camera, motion capture is more difficult. In this case, we need a model for how people move to infer the 3D mo tion from the two-dimensional (2D) data. Because the purpose of our data collection is to build such a model, this is problem atic. 3.2 Models for the Elements of Motion Our strategy for modeling motion data is to break it up into its individual components and then combine the parts to form a coherent whole. For example, we devise separate models for how the hand and torso move during a seated reach motion. The geometric characteristics of these body parts determine the types of functional data that we need to model. The hand forms a 3D trajectory, while the motion of the torso generates an ori entation trajectory. We consider the following data types: Univariate curves. For example, consider the angle formed between the upper and lower arms at the elbow or the distance of the foot from the floor while walking. 3D trajectories. Consider the motion of the hand when picking up an object. This will form a 3D trajectory in space. Orientation trajectories. Consider the orientation of the hand while picking up an object. This will form a curve in a 3D non-Euclidean space. Ensembles. Consider the motions of the upper body dur ing a seated reach or even the whole body during a lifting motion. These can be described with an ensemble of the three foregoing data types. We now describe methods for modeling all of these types of data. We are interested in several types of data analysis. In some cases, we will want to understand the structure of varia tion within a functional dataset. For example, when lifting a box from the floor, some people will bend their knees, whereas oth ers will keep their legs straight while bending over. We need a form of cluster analysis to detect groups within functional data. Another example concerns facial motion, which is typically de scribed by very high-dimensional data. However, we might be lieve that facial motions vary within a much lower-dimensional space. Principal components analysis (PCA) is one method for discovering such a space (see Faraway 2004b). Even so, stan dard cluster analysis or PCA applied to the raw motion data will not produce meaningful results; some transformation is neces sary, as we describe later. We are also interested in predicting or explaining motion in terms of some predictors using regression analysis. The re sponse is the functional data describing the motion, and the pre dictors might be characteristics of the individual, such as height, age, and weight and characteristics of the task being performed, such as the location of button to be pressed or the weight of an object to be lifted. This requires the development of new types of regression models for the functional responses listed ear lier. We envisage a designer asking how a certain person would move to perform a task in a specified environment, inputting the predictor variables and receiving the predicted motion. In some cases, the designer also will want to have some measure of the uncertainty in the prediction. We also value the explana tory uses of regression. For example, men might perform a task differently than women, but is the difference due merely to the difference in height, or does it reflect a gender difference? Re gression analysis can answer these kinds of questions. In general, our strategy is to find a good low-dimensional representation of the notionally infinite dimensional functional data and then apply the standard methods of multivariate data analysis. However, the representations are very important as the multivariate data analysis will produce meaningful results only when this choice is made carefully. Some discussion of the con trast between functional and nonfunctional styles of analysis has been given by Rice (2004) and Zhao, Matron, and Wells (2004). 3.3 Univariate Curves Many individual components of the motion, such as angles between body segments as they change over time, can be de scribed as functions. For example, consider an axis joining the initial and final location of the hand during a reaching motion. We can compute the orthogonal distance of the hand from this axis during motion, which we call the radial deviation. Because we observe the data only at discrete timepoints, we have a se quence of observed values from the start of the motion to the TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="5">DIGITAL HUMAN MOTION MODELING 281 end of the motion. These sequences are of different lengths be cause some targets are further away than others, and people reach at different speeds. We rescale all of these motions so that time t = 0 is the start of the motion and t = 1 is the end of the motion. We can save the actual time taken as a possible predictor of the motion and perhaps to be predicted itself. Determining when a particular motion starts and ends is sometimes difficult. Even at rest, the body will be moving slightly. Furthermore, different parts of the body will start mov ing and stop moving at different times. For example, we might move our head to look at an object before reaching for it. When combining the models for how individual parts of the body move, we need to allow for these offsets. Further difficulties arise when chaining sequences of motions together. Plots of the radial deviation for 20 subjects reaching with the right hand to a location somewhat to the left and front of the body and about the same height as the initial position of the hand are shown in Figure 2. A typical dataset would contain reaches by several subjects to a range of targets, so the plot shows only a small subset of the data. It would be reasonable to average (or take averages of subsets of) the curves in Figure 2. We also might study the structure of variation using functional principal components methods (see, e.g., Rice and Silverman 1991). There is a growing literature on functional data analysis for univariate curve data. A good place to start is the work of Ram say and Silverman (2005). Ramsay and Silverman (2002) pro vided a collection of analyses of functional data. We next out line the methods that we have used. For reasons of compactness and ease of manipulation, we represent the curves as linear combinations of m cubic B-spline basis functions, Bj(t)J = 1,..., m. A curve yi(t) is represented as YljLiyijBjtt)* where the coefficients yij are estimated using regression methods over the points at which yi(t) is observed. Given that human motion is usually quite smooth, a large number of basis functions is not needed. We have found that eight basis functions provides a good compromise between fit and simplicity. Any approximation error is dwarfed by the vari ation within and between individuals repeating the same mo tion, so there is little value in using more basis functions. Using fewer basis functions is desirable, especially when motion data bases may be large. Thus each observed curve is represented by this small number of coefficients, and the functional response is ? n-1-1-1-1-r 0.0 0.2 0.4 0.6 0.8 1.0 Proportion of time Figure 2. The radial deviation of the hand from a straight line path when reaching with the right hand to a location on the left front of the body for 20 subjects. thereby converted into a multivariate response, which is easier to work with. A parametric approach to modeling such func tions in terms of the predictors has been given by Faraway (2003a). Suppose that the functional responses depend on certain co variates, such as the location of the target being reached, the age and anthropometry of the subject, and other factors. For the /th curve, we collect these predictors in a vector, X(. We then propose a functional linear model, yi(t)=xjp(t) + ei(t). Note that this is similar to a standard regression model, but the response is now a function, as is the error term ei(t). The regres sion coefficients f}(i) now compose a vector of functions. The particular coefficient function for a given covariate will now represent the effect on the response of that covariate over the duration of the reach. We can now estimate fi(t) using least squares by P(t) = (XTX)~lXTy(t), where X is the matrix with rows given by the jc/'s. This formula cannot be directly applied since one cannot ob serve ayi(t) at all possible t. One approach is to approximate the functions on a grid of values, as done by Faraway (1997). A fine grid of values is needed for accurate representation, which is somewhat inefficient. The B-spline basis functions representa tion is more compact. The model can be written in the form *nxm = XnxpPpxm H~ ?/jxmi which is now a multivariate multiple regression model in which the coefficient matrix f&gt; may be estimated using least squares. One may then use the standard methods of statistical inference using this modeling approach. Details of such methods have been given by, for example, Johnson and Wichern (1992). Variable selection on X is worthwhile for the usual reasons and can be accomplished using methods described by Shen and Faraway (2004) and others. However, we should bear in mind that the models for each element of the motion must be com bined to predict the motion for the whole body. It will be incon venient if different elemental models use different predictors. Furthermore, predictors that are significant for some individual elements may not be significant for the combined motion. We have found that the best results are obtained by judging each candidate set of predictors by the fit obtained for the whole body prediction. Formal inference is difficult in these circumstances, but an informal compromise between fit and complexity is pos sible. In general, the error s(t) contains three components: mea surement error, within-subject variation, and between-subject variation. When functioning correctly, motion-capture systems are quite accurate so that the observed curves are typically smooth and there is little in the way of Gaussian noise that may be seen in other applications. The data collection systems can occasionally fail due to markers being obscured or con fused, leading to missing or clearly erroneous measurements. In our experience, this is best handled by prefiltering the data rather than using robust fitting methods. When a subject re peats a task, the motion will not be exactly the same; this is TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="6">282 JULIAN FARAWAY AND MATTHEW P. REED within-subject variation. When two subjects with the same ex ternal characteristics of interests (e.g., height, age, and gen der) perform the same task, there will be some differences; this is between-subject variation. We have made some progress in building mixed-effects models for functional responses that in corporate these different sources of variation, as reported Far away and Hu (2001). But such models are complex and difficult to fit reliably. We have had more success estimating the fixed effects components of these models using simply least squares. The random-effects components are then estimated conditional on these fixed-effects estimates. One important feature of the statistical approach to human motion prediction that is generally lacking in other methods is the ability to produce more than just a point prediction. It is certainly useful to have a prediction of the most likely or mean motion for performing a particular task; however, it is even more valuable to understand how the motion is likely to vary around the mean. For example, some injuries occur when the subject performs a motion in an unusual way that induces much greater stress on the body. In principle, confidence re gions could be constructed, but these would be complex and difficult to visualize for the whole body motion. Instead, we can use the estimated random-effects components to simulate variations around the predicted mean. There is an ever-increasing number of articles on func tional regression; however, not all of these are relevant to motion-capture data. In particular, the interface with longitu dinal data analysis that arises with sparser data, considered by Yao, Miiller, and Wang (2005), for example, is not germane, because motion-capture data are dense with little noise. There is also some interest in time-varying X's in the functional data analysis literature. However, in our applications, the task envi ronment and subject characteristics remain constant during the motion. 3.4 Three-Dimensional Trajectories In addition to predicting univariate functions, such as the ra dial deviation, we need to predict the 3D curves formed by the trajectory of the hand or other body markers. There is substan tial interest in modeling hand trajectories in several different fields, including neuroscience, psychology, robotics, and motor control. (For an introduction from the motor control perspec tive, see Winter 2005.) Even so, much of the research in this area has focused on particular characteristics of the trajectory (e.g., the maximum acceleration) rather than on modeling the complete curve. We could simply model each of the three Cartesian coordi nates of the trajectory, but this is unsatisfactory, because it is not invariant to rotations of the coordinate system that we may wish to make. We describe two ways in which such trajectories might be modeled. In the physical applications that we consider, the starting and ending positions of the marker are either specified or modeled independently. For example, in modeling the hand trajectory of a driver reaching from the steering wheel to a control on the dashboard, the start and end locations will be supplied by the designer. In foot motion to position the body to perform a reaching task, the end location of the foot is not given, but is best modeled separately based on such considerations as bal ance and comfort. In what follows, we assume that the start and end locations are known. The first trajectory modeling method that we present uses a parameterization that has easily interpretable components. We define r(t) as the radial deviation at time t describing the or thogonal distance from the axis joining the endpoints, p(t) e [0, 1] as the proportionate progress along the axis at time t and v(t) =pf(t) as the relative axial velocity. See Figure 3(a) for a depiction of these quantities. Let q)(t) be the angle describing the position of the hand at time t on the circle orthogonal to the axis of the reach and whose center lies on this axis. We define (j) (t) = 0 to be the projection of the unit vertical vector onto this circle. We model the trajectory using the triplet (v(t),r(t),(p(t)). Because v(0) = v(l) = r(0) = r(l) = 0 by definition, we can accommodate this by omitting the first and last cubic B-spline basis functions in the representation, which, because these are the only nonzero basis functions at t = 0 and t = 1, will en sure the desired property. Furthermore, we should not directly model (f)(t), because it is an angle. Angles In ? e and e are only 2e apart, but averaging their numerical values produces n, (a) (b) Position ^---_End / V Position at t ^-^^^ ^^ / &lt;Kt)X \ Start View down axis Figure 3. (a) A side view of the reach is shown with the axis drawn as a straight line connecting the start and end of the reach, (b) The view is down the axis, looking from the start toward the end. TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="7">DIGITAL HUMAN MOTION MODELING 283 Top view Front view Side view o-C~ I ?~|*Q ?~ &lt;P Q ? \ ?- / * " \ 8 \ # S-i ^ iH \ = M \ i *H jT X ? a o *f o &lt;\ "*- *\ "*-. P I _^*H &lt;H_jN ?v*_ i-,-1-1-(-? l-|-1-1-\-r-1 ?i-,-1-1-r1 0 10 20 30 40 0 10 20 30 40 -40 -30 -20 -10 0 side side front Figure 4. Three orthogonal views of a Bezier curve with two internal (m = 3) control points fit to some 3D trajectory data. The solid dots are the control points. which is diametrically opposite. For this reason, we model the responses cos0(r) and sin 0(0 and then use the relation 0 = tan-1 (sin0/ cos 0) to predict 0, which respects the appro priate continuity properties of an angle. Note that this repre sentation contains no explicit information about the endpoints. More details have been given by Faraway (2001). The second method that we have used is based on work de scribed by Wang (2006) using Bezier curves. The model for the curve takes the form _Z7=^piBT^)^ where BT^ are the Bern" stein polynomials defined on [0,1] by Bm(t) = ( \ti(\-t){m-i). The Pi are called control points. Po coincides with the starting point of the curve at t = 0, whereas Pm lies at the endpoint at t = 1. For 3D curves, the control points have three dimensions. The interior control points determine the shape of the curve. In our experience, relatively few control points are needed; we obtained satisfactory results with m = 3. The fitting of a 3D tra jectory is shown in Figure 4. Bezier curves have several desir able properties that have popularized their use in graphic design (see, e.g., Prautzsch, Boehm, and Paluszny 2002 for details). In particular, they are invariant to rotations and translations of the coordinate system, because the shape of the curve is determined by the relative position of the control points. Moreover, the line segments PoA and Pm-\Pm are tangential to the curve at the start and end. Thus they represent the direction of take-off and approach for the hand. This is particularly useful when model ing a task where the hand must reach in to perform a task where the approach is constrained by the surroundings or, say, an ob ject must be gripped in a particular way. The lengths of these line segments control how far the influence of the initial and final periods of the reach extend into the middle period of the reach. To build a model for the trajectories, we merely need to pre dict the location of the interior control points (relative to the endpoints) in terms of the available predictors. Standard meth ods of regression analysis can be used to achieve this. We have found that a model with two interior control points is effective in representing unconstrained reaches where the sub ject is not influenced by avoiding obstacles, for example. For more complex trajectories, adding more control points would be necessary. Bezier curves are a special case of B-splines where all of the knots are at the endpoints. Their relative advantage in this ap plication derives from the their simplicity, resulting in a more compact parameterization together with the possibility of a physically meaningful interpretation of the control points. 3.5 Orientation Trajectories The orientation of a rigid body in 3D can be represented in various ways. Rotation matrices and Euler angles (e.g., aero nautical roll, pitch, and yaw) are both commonly used. This is discussed in books such that by Zatsiorsky (1998). However, these representations have some drawbacks, particularly with respect to the application of statistical methods. Rotation matri ces use nine parameters to represent just the 3 degrees of free dom necessary to describe an orientation, whereas Euler angles are susceptible to the problem of gimbal lock and are noncom mutative. Quaternions provide a compact and elegant representation of orientation. We can think of a quaternion as a generalization of a complex number written as q = ix +jy + kz + vv = [v, vv], where w,x,y,zeR and the imaginary numbers ij, and k sat isfy i2 = j2 = k2 = ijk = ? 1, v = (jc, y,z) is the vector, and vv is the scalar. Quaternion arithmetic for addition, multiplication, norm, conjugate, and inverse is available in standard texts. An orientation can be represented by a quaternion with vector of unit length. Dunn and Parberry (2002) have provided an intro duction in the context of human motion applications. Statistical applications involving quaternions have been reported by Pren tice (1986) and Rancourt, Rivest, and Asselin (2000). Performing statistical methods directly on the quaternions is difficult. For example, the arithmetic average of two rotations represented as quaternions is not usually itself a rotation. An al ternative approach is to perform tangent mapping on the quater nions and compute the statistics in the tangent space. TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="8">284 JULIAN FARAWAY AND MATTHEW P. REED The exponential map from a vector v in the tangent space to the space of unit quaternions with origin at the identity quater nion [0, 1] can be obtained by , , {[0,1] ifv = 0 expmapiy) = \ ^ [ [v sin 0/2, cos 0/2] otherwise, where 0 = ||v|| and v = \/0. The inversion is obtained using the logarithm map, which maps from the unit quaternion q to the tangent space at the identity logmap(q) = v/sinc(0/2), where v is the vector part of q and sinc(;c) = sinx/jt (see Gras sia 1998 for more details). We can then perform standard statistics in the tangent space and map back to the space of quaternions when we are done. The inaccuracy due to the nonlinear mapping is small provided that the rotations are not far from the origin. In practice, a hand might rotate across a wide range, but we have developed recen tering techniques given by Choe (2006) that minimize the error. 4. COMBINING ELEMENTAL MODELS OF MOTION We have described some basic building blocks of motion, but these need to be combined into a coherent whole. The body parts do not move independently, so we must link models for the components that respect the constraints imposed by the skele ton. Some constraints are simple?for example, the distance be tween the elbow and wrist is fixed. Other constraints involve joint angle limits?for example, the angle formed at the elbow by the upper and lower arms, because this can be no more than 180 degrees. Here we describe some methods that we have used at HuMoSim to produce predictions of motion for all or most of the human body. Section 4.1 tackles the problem of predicting a chain of body segments to satisfy an endpoint constraint. We show that an ap propriate parameterization makes the problem much simpler. Section 4.2 considers the more nonstatistical practical issues in the combination of elemental motion models. Section 4.3 con sider methods that are akin to the nearest-neighbor methods in statistics. 4.1 Kinematic Chains Consider a chain of / jointed links in three dimensions as shown in Figure 5. Suppose that one end of the chain is fixed at the origin, the joints have full flexibility, and the segments are of known lengths. We wish to position the other end of the chain at some specified target T. For example, the chain might represent the arm and torso of a person who must reach to some target. The inverse kinematics (IK) problem is to position the rest of the chain to satisfy this endpoint constraint. We have shown how to model a hand trajectory. Now we need to solve the IK problem to predict the movement of the arm and torso to follow this hand path. One approach is to pa rameterize the position of the chain in terms of two angles for each link. We might use functional response regression models for each of these angles, as described earlier. However, if we use the forward kinematics approach of building the chain up from the origin using these predicted angles, then the endpoint \ ^^^-^^^ Target \v Fixed Figure 5. Inverse kinematics. The chain must be positioned to meet endpoint constraints. likely will not correspond with required endpoint. We must im pose this endpoint, which results in a least squares problem with a nonlinear constraint. This can be solved by methods such as those given Faraway, Zhang, and Chaffin (1999), but this be comes computationally difficult for longer chains, because end users require motion predictions in real time or close to it. We present here a parameterization of the posture such that the endpoint constraint is always implicitly satisfied. This al lows for rapid and simple computation of postures and makes it easier to model the components independently. We call this pa rameterization stretch pivot coordinates. The stretch pivot co ordinates have the advantage that they can be averaged and still produce a valid configuration of the chain for any segment lengths and endpoints (provided that the total segment length exceeds the distance between the endpoints). This allows the straightforward application of statistical methods. Only 2/ ? 3 parameters are necessary to describe a closed (i.e., endpoints fixed) Mink kinematic chain (two parameters for each segment minus three for the endpoint constraint). The key to success is selecting these parameters in a suitable way. Consider first a closed two-link chain in three dimensions, like the shoulder, elbow, and wrist linkage, where the endpoints, the shoulder and wrist, are in fixed positions. Only one parameter is need to describe this linkage, because the midpoint (the elbow) of the chain is constrained to lie on a circle whose center lies on and is orthogonal to an axis joining the endpoints. One need only specify the angle on this circle. We call this midpoint the pivot and this angle the pivot angle. Such an angle was used by Korein (1985) and Wang (1999a,b). The angle is illustrated in Figure 6. Now consider a longer / link chain and pick a marker in the middle of this chain, as shown in Figure 7. We call the two endpoint markers the proximal and call the distal and the mj#oM Pivot angle X. ------ 1 I endpoint endpoint \ / \ / ^?-?. midpoint must lie \^__^/ on this circle Figure 6. The pivot angle describes the location of the midpoint on the circle of its possible positions (3D view). TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="9">DIGITAL HUMAN MOTION MODELING 285 / \ / medial \ ^^ w \ / \ ^^ distal proximal \j --&gt;d Figure 7. Stretch parameters. The distance between the proximal and medial if that part of the chain were fully extended is mp, whereas the corresponding distance for the medial to the distal is m^. We define Pp = Ip/ntp mdpd = Id/mrf. selected midpoint the medial. Let lp and Id be the distances be tween the proximal and the medial and the distal and the me dial. If lp and Id are considered fixed, then the position of the medial relative to the proximal and distal may be described in terms of a pivot angle, 0m, lying on the circle orthogonal to (and whose center lies on) the axis joining the proximal and distal. Let mp and md represent the total length of all of the links joining the proximal and the medial and the distal and the medial. We define pp = lp/mp and pd = Id/md- We call the /?'s the stretch parameters. The position of the medial may be de scribed in terms of the three parameters (Om,pp,pd)\ hence the term stretch pivot. Once the position of the pivot has been determined, the prob lem is reduced to two smaller problems. The same procedure may be repeated on the two halves of the chain recursively. Now each of the 2/ ? 3 components describing the chain can be mod eled using functional regression methods. Further details have been given by Faraway (2004a,b). A different parameterization involving just the arm but having the same desirable modeling characteristics Tolani et al. (2000). We now describe an example in which the kinematic chain model may be used in combination with the other model com ponents to produce a complete motion model. Consider a seated reaching motion where the position of the body is described in terms of the following markers: the L5/S1 joint (base of the spine) which is held fixed, the C7/T1 joint (back of the neck), the sternoclavicular joint (supersternale), the right and left shoulder, the right and left elbow, the right and left wrist, the right and left hand, and the head. The subject makes a reach with the right hand starting and ending in known positions, while the left hand remains in a fixed position. Suppose that we have a database of subjects making such reaches, but the char acteristics of the subjects and the location of the targets reached varies. The reach is illustrated in Figure 8. A scheme for mod eling the reach is as follows: 1. Compute the beginning and ending coordinates of the right wrist. We need to know the task being performed to determine the orientation of the hand relative to the target. We also need to know the dimensions of the hand. If the subject for whom the reach is to be specified is described completely, then these will be known. In other cases, we might know only the height of the subject, and the hand dimension would need to be predicted from this. Large anthropometric databases and models for achieving this are available. 2. Use the trajectory modeling method to predict the motion of the right wrist. This trajectory will vary according the / \ Head / 1 ^?? orientation varies Primary \ / Kinematic \ / Right hand Chain \ ^^ \y am orientation varies \ / ^SSs\^ /\ I / SCJ \ N\ ^^^ / \ Secondary \ ^^^ \ Kinematic \ \ ^^ Chain x Trajectory of ^^^ ? right hand ^^^ \ Left Hand Fixed \ t$/q i Figure 8. Schematic of a seated reach. The right hand moves along with the torso while the left hand remains fixed. The linkage is rooted at the L5/S1 (base of the spine) joint. The head also moves. TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="10">286 JULIAN FARAWAY AND MATTHEW P. REED location of the target and the characteristics of the indi vidual. We can build a regression model to describe this relationship. 3. Use the orientation modeling method to describe the rota tion of the hand during the motion. We can build a regres sion model for this as well. 4. Consider the kinematic chain from L5/S1, C7/T1, ster noclavicular joint, right shoulder, right elbow, to right wrist. We can use the stretch-pivot method described ear lier to parameterize this chain. We can build regression models to predict the components of this chain. 5. Consider a second kinematic chain from C7/T1, left shoulder, left elbow, to left wrist. A comparable model can be developed for this chain. 6. The motion of the head can be described using an orien tation functional regression model. 4.2 Motion Framework The preceding discussion has focused on relatively simple human motions, for example, a reach with one hand to a fixed target starting from a neutral seated posture. Human tasks of in terest in ergonomics are usually more complex, involving mul tiple sequential and concurrent tasks, often performed by an operator who is moving around a factory. The individual low level actions (e.g., reaches, steps, and glances) are highly coor dinated, evidence of high-level, hierarchical control. Several research groups have developed integrated par adigms for generating realistic motions from task-oriented movement commands that are independent of the simulated ac tor and environment. Badler, Allbeck, Lee, Rabbitz, Broderick, and Mulkern (2005) presented a vision for a comprehensive system of control of avatars implemented as the human model testbed. The approach builds on other developments, includ ing parameterized action representation (Badler, Palmer, and Bindiganale 1999) and recent progress in obstacle avoidance (Zhao, Liu, and Badler 2005). Commercial software developers are also addressing the need for integrated, high-level control of human simulations. Raschke, Kuhlmann, and Hollick (2005) described the task simulation builder, an approach to task pro gramming in the Jack human modeling system that incorporates aspects of the parametrized action representation. We have developed a research testbed for human motion simulation called the HuMoSim ergonomics framework (Reed, Faraway, Chaffin, and Martin 2006). The framework uses a modular structure and hierarchical control to produce coordi nated motion for complex task sequences. The structure of the framework is shown in Figure 9. One of the design principles of the framework is that a hier archical network of relatively simple models can produce accu rate simulations of complex behavior. Consequently, many of the components of the framework use empirical models based on the analysis of human motion data from laboratory studies. The motion characteristics predicted from data include the fol lowing: 1. The duration of motion components (e.g., a hand reach to a target) is a function of reach distance and subject body dimensions. 2. The temporal offsets between the initiation of body com ponent motions are predicted by task type (e.g., reaching with an open hand vs. moving an object). 3. The hand trajectories are modeled using Bezier curves, as described earlier. Head motion is predicted using two components developed by nonlinear regression from sub ject data. The static head orientation is predicted as a func tion of target azimuth and elevation, and the head motion to acquire a new gaze target is generated using quaternion interpolation with an empirically derived velocity profile. The task scheduler uses timing offsets obtained from data analysis to plan the sequences of head, torso, and extrem ity motions to accomplish discrete tasks, such as reaches and object transfers. 4. Recent work on lower-extremity motions has focused on the prediction of foot placements and movements from task and subject variables. In a multistep process, a transi tionary lower-extremity behavior associated with picking up or putting down an object is selected. A "behavior" is a sequence of footsteps on either side of the load transi tion that defines an approach or turning behavior. A dis criminant analysis of laboratory data, validated by video analysis of data from an auto assembly plant, is used to predict the behavior category (Wagner, Reed, and Chaffin 2006). The individual foot placements are then calculated based on a multiple linear regression model of laboratory data (Wagner et al. 2005). The statistical models provide the opportunity to simulate the most likely behavior as well as several other behaviors that might be observed for the specified tasks. An analyst can then assess the relative musculoskeletal loading resulting from each behavior and use the behavior probabilities in determining whether a task should be redesigned to reduce the risk to the worker. 5. The statistical analyses used to set these aspects of simu lation permit adjustments to simulate some of the variance in the movements, particularly with respect to timing and hand trajectories. 4.3 Motion Warping The editing or "warping" of motion-capture data is used ex tensively in the entertainment field to apply human motion capture data to character animation. Application of these tech niques in ergonomics has been problematic because of the po tential to produce motions that are distinctly unrealistic. Park et al. (2004) developed a motion modification algorithm that preserves the coordinated structure of motion at the joint level. Motion modification works best when the motion to be modi fied is similar in structure to the motion of interest; for example, a reach to a low shelf is poorly modeled by modifying motion data from reach to a high shelf. A critical contribution of Park's work was the development of an objective method for classi fying different movement techniques. Using cluster analysis, a set of motion-capture data from multiple individuals and tasks are segregated into movement categories within which motions can be modified while preserving the essential structure of the motion (Park, Martin, Choe, Chaffin, and Reed 2005). This type of method can also be viewed as nearest-neighbor regression where only one neighbor is used. Faraway (2004a) extended the method to average over several neighbors. TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="11">DIGITAL HUMAN MOTION MODELING 287 High-Level Task Input: Figure and Environment independent of figure State: current figure and and environment state posture, location of objects, (Required) etc. - Task Planner -&lt; _][_ /Mid-Level Task Plan: walk, / / pick up, place, use,... / _][_ I- Motion Generator -. Transit Model: Resource-Based Component Schedul- Biomechanical Posture foot placement ing Model: sequence and timing of Planner: generate task and timing head, upper-extremity, and torso posture targets based on motions, with dependencies biomechanical criteria _;[_ /Component-Level Motion Plan: /._ steps, reaches, gaze targets, etc. / *_. - Motion Controller-1 r- Lower-Body Coordination Module ?. - Upper-Body Coordination Module ?i Left Lower-Extremity Module: step Right Upper-Extremity Module: following and inverse kinematics trajectory and grasp planning n- L*. r ?. ?. ka a i . ^6 execution Right Lower-Extremity Module: step following and inverse kinematics Left Upper-Extremity Module: trajectory and grasp planning and Balance and Gait Module: controls execution pelvis motion 1-' Gaze Module: head and eye control Torso Module: pelvis orientation and lumbar spine motion /Movement with trajectory and com- /_ ponent timing information / Figure 9. HuMoSim motion framework. 5. APPLICATION EXAMPLES Recent research in traffic safety has shown that driver distrac tion is a major cause of accidents along with fatigue, phone use, and drunkenness. Yet modern vehicles are being fitted with an increasing number of features, such as satellite navigation and entertainment systems, that the driver may attempt to use while in transit. Visualize the process of operating a control on the dashboard. Many drivers use a sequence of glancing and reach ing actions to perform the task. For example, first the driver glances at the control, the eyes then return to the road while the hand starts to reach for the target. As the hand nears the target, the driver glances over again to guide the hand onto the target. As the hand grasps the control, the eyes return to the road again while the task is being performed. We would like to study how this behavior varies as we consider shorter and taller, older and younger people. We would also like to experiment with changing the location of the control to, say, TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="12">288 JULIAN FARAWAY AND MATTHEW P. REED Statring Posture. Head and hand trajectories Gaze motion with eyes and head initiated, planned for a reach to the instrument panel. Hand movement begins. Torso motion planned. Torso coordinating left and right hand motions. Movement completed. Figure 10. Still frames from a study of a truck driver reaching to a dashboard control. an overhead panel. A DHM can help explore these possibili ties. Figure 10 shows a sequence of images obtained from a simulation using the HuMoSim framework with the Jack hu man figure model. A simple reach to a dashboard control by a truck driver is used to illustrate some of the outcomes ob tained from the statistical models underlying the framework. When the reach task is commanded, the gaze module deter mines the desired terminal head posture (nonlinear regression model) and computes a velocity profile (two-parameter model fit to head movement data). The task scheduler uses empirically derived offsets and a linear regression model to plan the initi ation and duration of the head, hand, and torso motions. The component-level tasks are dispatched to the gaze, right upper extremity, and torso modules, whereas other modules maintain lower-extremity positions and hold the left hand on the steer ing wheel. The sequence of frames in Figure 10 was produced using mean predicted values, but the underlying models can be exercised stochastically to predict, for example, very slow or very fast motions within the range observed in the laboratory data. We are also able generate realizations, say, from the pre dicted distribution of hand trajectories, which in turn affects the rest of the motion. Stochastic simulations would be of value in predicting the likelihood of a driver failing to detect an obstacle in the roadway due to diverted attention or colliding with other vehicle controls while performing the reach. DHMs also are widely used for industrial ergonomics, par ticularly in the automotive industry. The manufacturing facility that will be used to build a vehicle is developed in parallel with the vehicle itself. Just as physical prototypes are being phased out in favor of virtual models, the physical mockups of assem bly work stations are being supplanted by "virtual builds," in which the entire vehicle is assembled in computer simulation. DHMs are increasingly used to determine whether the assembly workers' tasks can be performed safely and in the allotted time. Typical applications of DHMs in the virtual build process in clude assessing reach into parts bins and into the vehicle; com paring loads on the body, particularly at the low back, shoul der, and wrist, with accepted limits; and determining the time needed for a worker to perform task. Human motion simulation models based on statistical analy sis of laboratory data are becoming increasingly important for these analyses. Figure 11 shows several frames from an ani mation of a typical simulation. In this case, a worker is stack ing two sheet metal parts together and placing them on a jig for welding. Two conveyors feed parts to workstation. Because workers range widely in body size, the positioning of the parts must be chosen carefully so that small workers can pick up the parts without excessive stepping and large workers have suf ficient clearance. Figure 11 shows a small woman performing the task. Statistical models developed in the HuMoSim labo ratory can predict the foot placements for workers of various TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="13">DIGITAL HUMAN MOTION MODELING 289 Figure 11. Simulation of sheet metal assembly task. Design of the work area must accommodate both short and tall workers. Here a small woman is shown performing the task. sizes relative to the hand locations required to pick up the parts. The torso orientation, which has a strong effect on low-back loading, can also be predicted from data. The development of architectures for simulation of sequential tasks, such as the Hu MoSim framework, allows rapid simulation of this type of task with a large number of different human figures representing workers with a wide range of body dimensions. Portraying motions in a few still frames is difficult. The reader may visit www.humosim.org to view movies showing this and other motions. Information about how to obtain access to the data described in this article may be found at the same website. 6. DISCUSSION Human motion modeling gives rise to a wide range of novel statistical problems. Functional data of various types must be modeled that have received relatively little previous attention in the statistical literature. Due to the inherent variability of human motion, statistical methods have clear application; yet, despite the large amount of research from computer scientists, engineers, and other scientists, the area has not attracted much interest from statisticians. Thus there is substantial opportunity for both theoretical and applied statistical work in this field. The HuMoSim framework, a hierarchical model of human task planning and movement coordination, provides a testbed for exploring how low-level, empirically derived movement models, coupled with relatively simple high-level task sequencing models, can produce complex, coordinated be havior. Future research will examine the extent to which the variance in uncontrolled variables (e.g., elbow location during a reach) can be predicted by random sampling from the estimated residual variance in controlled variables (e.g., hand trajectory). The ability to generate stochastic simulations of human oper ators has considerable potential for safety research (e.g., Am brose 2000), but reliable results will require valid models and methods. The application of the methods described in this article al ready has begun to influence the conduct of ergonomics analy sis using digital human models. Over the next several years, motion simulation based on validated human models will be come commonplace in a wide range of fields. Ultimately, the value of the simulations will rest on the validity of the statisti cal methods used to analyze and model human movement data. Further advancements in these methods will be needed to ex pand the range of applicability of ergonomic analysis with sim ulated humans. ACKNOWLEDGMENTS Don Chaffin founded the HuMoSim laboratory at the Uni versity of Michigan and provided vital support without which this research would not have been possible. Other colleagues at the laboratory contributed to this effort. We thank the past and present industrial partners of the HuMoSim consortium for their financial support. [Received July 2006. Revised January 2007.] REFERENCES Ambrose, D. (2000), "A Simulation Approach Analyzing Random Motion Events Between a Machine and Its Operator," Technical Paper 2000-01-2160, SAE International. Badler, N., Allbeck, J., Lee, S.-J., Rabbitz, R., Broderick, T, and Mulkern, K. (2005), "New Behavioral Paradigms for Virtual Human Models," Technical Paper 2005-01-2689, SAE International. Badler, N., Palmer, M., and Bindiganale, R. (1999), "Animation Control for Real-Time Virtual Humans," Communications oftheACM, 42, 64-73. TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page><page sequence="14">290 JULIAN FARAWAY AND MATTHEW P. REED Chaffin, D. (ed.) (2001), Digital Human Modeling for Vehicle and Workplace Design, Warrendale, PA: SAE International. Chaffin, D., Andersson, G., and Martin, B. (1999), Occupational Biomechanics, New York: Wiley. Choe, S. (2006), "Statistical Analysis of Orientation Trajectories via Quater nions With Application to Human Motion," unpublished doctoral thesis, Uni versity of Michigan, Dept. of Statistics. Dufour, R, and Wang, X. (2005), "Discomfort Assessment of Car Ingress/ Egress Motions Using the Concept of Neutral Motion," Technical Paper 2005-01-2706, SAE International. Dunn, E, and Parberry, I. (2002), 3D Math Primer for Graphics and Game Development, Piano, TX: Wordware Publishing. Engelbrecht, S. (2001), "Minimum Principles in Motor Control," Journal of Mathematical Psychology, 45, 497-542. Faraway, J. (1997), "Regression Analysis for a Functional Response," Techno metrics, 39, 254-261. - (2001), "Modeling Hand Trajectories During Reaching Motions," Technical Report 383, University of Michigan, Dept. of Statistics. - (2003a), "Data-Based Motion Prediction," Journal of Passenger Cars?Electronic and Electrical Systems, 112, 722-732. - (2003b), "Regression Modeling of Motion With Endpoint Con straints," Journal of Visualization and Computer Animation, 14, 31-41. - (2004a), "Human Animation Using Nonparametric Regression," Jour nal of Graphical and Computational Statistics, 13, 537-553. - (2004b), "Modeling Continuous Shape Change for Facial Animation," Statistics and Computing, 14, 357-363. Faraway, J., and Hu, J. (2001), "Modeling Variability in Reaching Motions," Technical Paper 2001-01-2094, SAE International. Faraway, J., Zhang, X., and Chaffin, D. (1999), "Rectifying Postures Recon structed From Joint Angles to Meet Constraints," Journal of Biomechanics, 32, 733-736. Flash, T., and Hogan, N. (1985), "The Coordination of Arm Movements: An Experimentally Confirmed Mathematical Model," Journal of Neuroscience, 5,1688-1703. Grassia, F. (1998), "Practical Parameterization of Rotations Using the Expo nential Map," Journal of Graphics Tools, 3, 29-48. Johnson, R., and Wichern, D. (1992), Applied Mulivariate Statistical Analysis (3rd ed.), Englewood Cliffs: Prentice Hall. Jung, E., Kee, D., and Chung, M. (1995), "Upper-Body Reach Posture Predic tion for Ergonomics Evaluation Models," International Journal of Industrial Ergonomics, 16, 95-107. Korein, J. (1985), A Geometric Investigation of Reach, Cambridge, MA: MIT Press. Marler, T., Rahmatalla, S., Shanahan, M., and Abdel-Malek, K. (2005), "A New Discomfort Function for Optimization-Based Posture Prediction," Technical Paper 2005-01-2680, SAE International. Monnier, G., Wang, X., Verriest, J.-P, and Goujon, S. (2003), "Simulation of Complex and Specific Task-Orientated Movements With Application to Seat Belt Reaching," Technical Paper 2003-01-2225, SAE International. Park, W., Chaffin, D., and Martin, B. (2002), "Memory-Based Motion Simula tion," Technical Paper 2002-07-0042, SAE International. - (2004), "Toward Memory-Based Human Motion Simulation: Devel opment and Validation of a Motion Modification Algorithm," IEEE Transac tions on Systems, Man, and Cybernetics, Part A: Systems and Humans, 34, 376-386. Park, W., Martin, B., Choe, S., Chaffin, D., and Reed, M. (2005), "Representing and Identifying Alternative Movement Techniques for Goal-Directed Manual Tasks," Journal of Biomechanics, 38, 519-527. Porter, J., Case, K., Freer, M., and Bonney, M. (1993), Automotive Ergonomics, London: Taylor &amp; Francis. Prautzsch, H., Boehm, W., and Paluszny, M. (2002), Bezier and B-Spline Tech niques, New York: Springer. Prentice, M. (1986), "Orientation Statistics Without Parametric Assumptions," Journal of the Royal Statistical Society, Ser. B, 48, 214-222. Ramsay, J. O., and Silverman, B. W. (2002), Applied Functional Data Analysis, New York: Springer. - (2005), Functional Data Analysis (2nd ed.), New York: Springer. Rancourt, D., Rivest, L.-R, and Asselin, J. (2000), "Using Orientation Statis tics to Investigate Variations in Human Kinematics," Applied Statistics, 49, 81-94. Raschke, U., Kuhlmann, H., and Hollick, M. (2005), "On the Design of a Task Based Human Simulation System," Technical Paper 2005-01-2702, SAE In ternational. Reed, M., Faraway, J., Chaffin, D., and Martin, B. (2006), "The Humosim Er gonomics Framework: A New Approach to Digital Human Simulation for Ergonomic Analysis," Technical Paper 2006-01-2365, SAE International. Rice, J. (2004), "Functional and Longitudinal Data Analysis: Perspectives on Smoothing," Statistica Sinica, 14, 631-647. Rice, J., and Silverman, B. (1991), "Estimating the Mean and Covariance Struc tures Nonparametrically When the Data Are Curves," Journal of the Royal Statistical Society, Ser. B, 57, 673-690. Shen, Q., and Faraway, J. (2004), "An F Test for Linear Models With Functional Responses," Statistica Sinica, 14, 1239-1257. Snyder, R., Chaffin, D., and Schutz, R. (1972), "Link System of the Human Torso," Technical Report AMRL-TR-71-88, Aerospace Medical Research Laboratory, Wright-Patterson Air Force Base. Tolani, D., Goswami, A., and Badler, N. (2000), "Real-Time Inverse Kinematic Techniques for Anthropomorphic Limbs," Graphical Models, 62, 353-388. Uno, Y, Kawato, M., and Suzuki, R. (1989), "Formation and Control of Op timal Trajectory in Human Multijoint Arm Movement Minimum Torque Change Model," Biological Cybernetics, 61, 89-101. Wagner, D., Reed, M., and Chaffin, D. (2005), "Predicting Foot Positions for Manual Materials Handling Tasks," SAE Transactions: Journal of Passenger Cars?Mechanical Systems, 114, 2872-2876. - (2006), "A Task-Based Stepping Behavior Model for Digital Human Models," Technical Paper 2006-01-2364, SAE International. Wang, J. (2006), "Statistical Modeling for 3-D Trajectories," unpublished doc toral thesis, University of Michigan, Ann Arbor, Dept. of Statistics. Wang, Q., Xiang, Y.-J., Kim, H.-J., Arora, J., and Abdel-Malek, K. (2005), "Al ternative Formulations for Optimization-Based Digital Human Motion Sim ulation," Technical Paper 2005-01-2691, SAE International. Wang, X. (1999a), "A Behavior-Based Inverse Kinematics Algorithm to Pre dict Arm Prehension Postures for Computer-Aided Ergonomic Evaluation," Journal of Biomechanics, 32, 453-460. - (1999b), "Three-Dimensional Kinematic Analysis of Influence of Hand Orientation and Joint Limits on the Control of Arm Postures and Move ments," Biological Cybernetics, 80, 449-463. Wang, X., and Verriest, J.-P. (1998), "A Geometric Algorithm to Predict the Arm Reach Posture for Computer-Aided Ergonomic Evaluation," Journal of Visualization and Computer Animation, 9, 33-47. Winter, D. (2005), Biomechanics and Motor Control of Human Movement (3rd ed.), New York: Wiley. Yao, F, Miiller, H.-G., and Wang, J.-L. (2005), "Functional Linear Regression Analysis for Longitudinal Data," The Annals of Statistics, 33, 2873-2903. Zacher, I., and Bubb, H. (2005), "Strength-Based Discomfort Model of Posture and Movement," Technical Paper 2004-01-2139, SAE International. Zatsiorsky, V. (1998), Kinematics of Human Motion, Champaign, IL: Human Kinetics. Zhang, X., and Chaffin, D. (2000), "A Three-Dimensional Dynamic Posture Prediction Model for Simulating In-Vehicle Seated Reaching Movements: Development and Validation," Ergonomics, 43, 1314-1330. Zhao, L., Liu, Y., and Badler, N. (2005), "Applying Empirical Data on Upper Torso Movement to Real-Time Collision-Free Reach Tasks," Technical Paper 2005-01-2685, SAE International. Zhao, X., Marron, J. S., and Wells, M. (2004), "The Functional Data Analysis View of Longitudinal Data," Statistica Sinica, 14, 789-808. TECHNOMETRICS, AUGUST 2007, VOL. 49, NO. 3</page></plain_text>