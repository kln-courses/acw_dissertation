<plain_text><page sequence="1">2004-01-0343 Electronics and Algorithms for Rollover Sensing Peter J. Schubert, David Nichols, Edward J. Wallner, Henry Kong and Jan K. Schiffmann Delphi Delco Electronics Systems Copyright © 2004 SAE International ABSTRACT Rollover sensing and discrimination generally requires an algorithm that monitors vehicle motion and anticipates conditions that will lead to a rollover. In general, a deploy command is required in a time frame such that safety measures can be activated early enough to protect the occupants. A rollover discrimination system will typically include internal motion sensors, vehicle signals from other on-board sensors, and a microprocessor to execute the deployment algorithm. A supplemental signal path is used to arm the system, making it less susceptible to single point component failures. In this chapter we explore basic concepts of rollover sensors and system mechanization, rollover discrimination algorithms, and arming methodology. A simulation environment that models the performance of the system across part tolerance, temperature extremes and component age is used to estimate the scope of expected discrimination performance in the field. A representative selection of real-world events is presented, which can be used to calibrate algorithm parameters to ensure immunity margins and deployment timing for the entire system. PROBLEM DESCRIPTION Rollover events may involve complex vehicle motions, and may be preceded by a nearly-infinite variety of pre- roll movements. There are many possible mechanisms which can lead to rollover, which is defined as the vehicle passing through 90 degrees of rotation about its longitudinal axis. These can include trips, climb-overs, fallovers, and other events, as described in [37], Discerning which events will lead to an eventual rollover is the function of the rollover sensing module (RSM). Occupant protection measures may be used to mitigate injuries in the event of a vehicle rollover. These measures may include pop-up roll bars, seat belt pretensioners, or window curtain airbags, each with its own characteristic effectiveness and deployment time. For an effective rollover detection system, the deploy command must generally be issued early enough for the protection measure to be substantially in place well before the vehicle reaches the rollover condition. However, the desire for early deployment must be balanced with the need for sufficient information to make a high-confidence deployment command. Rough roads, off-road driving, and abuse events can generate significant signal magnitudes in the rollover sensors. Near-rollover events, where the vehicle is lifted up to a large roll angle, but then drops back to level may also occur. In these types of events, deployment is generally not desired, even though vehicle damage may have occurred. Providing immunity against the universe of non-rollover events is called discrimination. Achieving rapid deploy times as well as robust discrimination is a considerable challenge. Exploring these tradeoffs, and determining an optimal solution, is the design objective for the RSM. Figure 1. SAE Coordinate systems, with rates and accelerations defined. 65 Vehicle-based SAE coordinates 'ļr = yaw angle X = longitudinal 0 = pitch angle Y = lateral § = roll angle Z = vertical Angular Rates Accelerations r = yaw rate a(x) = longitudinal q = pitch rate a(y) = lateral p = roll rate a(z) = vertical CofG = Center of Gravity Earth-Based Accelerations A(x) = direction of travel A(y) = lateral to direction of travel A(z) = towards center of Earth</page><page sequence="2">KEY CONCEPTS Of paramount importance in understanding vehicle dynamics is the static stability angle. This angle can be defined as the scenario where a stationary vehicle would be precisely balanced on two tires on the same side of the vehicle. At the static stability angle, a straight line can be drawn from the center of gravity of the vehicle, intersecting a line connecting the contact point of the two tires (on the same side of the vehicle), and the center of the Earth. This figure of merit is related to the vehicle structure through two parameters: the trackwidth length (t) and the height of the center of gravity (h) when the vehicle rests on level ground. The equation for the static stability angle is: (1) (pSSA = tan 1 t/2h A pictorial image shows the static stability angle in Figure 2. Figure 2. Key motion components for rollover detection, plus vehicle parameters affecting static stability angle. Modern vehicles are often represented as a "sprung mass", where the suspension acts as a spring-mass- damper system between the wheels and the occupant cockpit. Thus, in a dynamic event, the above computation of the static stability angle will no longer hold strictly true. Driving events can be created where the vehicle passes through the static stability angle, but due to clever steering, can be brought back to level ground. Another important concept is the sensing equivalence of gravity and inertial accelerations. As defined above, rollover is measured with respect to an Earth-based reference frame. The gravity vector is the primary means of determining the vehicle orientation on present day systems (future systems may use global positioning information, or other independent reference determination). During driving maneuvers, and following contours of the roadway, the vehicle will experience inertial accelerations. Accelerometers are unable to dstinguish these two types of acceleration. The design of a rollover sensing system and algorithm must either account for this degeneracy, or make other allowances. Figure 3 shows how inertial and gravitational accelerations combine to make a total acceleration vector that may point in a direction different from either of the two components. Figure 3. Illustration of a typical scenario where gravitational and inertial acceleration components contribute to the total acceleration vector. ROLLOVER SYSTEM OVERVIEW The design intent described here is to develop a rollover- sensing module to be installed in the passenger compartment of a vehicle. Until recently, vehicle rollover sensors were comprised of electro-mechanical devices that use inclinometers, or tilt-sensors, to determine an angular position trip-point. These sensors are gravity- based, have a somewhat slow response time, and are unable to distinguish inertial forces from true vehicle roll angles. The gravity-based sensors have been used to activate pop-up roll bars in some applications. However, these system may trigger restraint devices inadvertently during non-rollover events, such as with aggressive driving or during airborne conditions. These sensors may not be adequate for accurately deploying non-resetable countermeasures, such as side window curtains. A more accurate approach to rollover sensing requires the use of an angular rate sensor (ARS) which is based on the Coriolis effect. Rate sensors are used today in other automotive applications such as navigation, vehicle stability control and adaptive cruise control, to measure yaw rate. These yaw rate sensor designs, however, may not be suitable for rollover sensing applications due to their inaccuracies during a vehicle collision, when they are most needed. The development of a robust rollover sensor requires an angular rate 66</page><page sequence="3">sensor be immune to most linear accelerations, such as during frontal or side-impact collisions as well as rough road events. The performance and timely activation of any automotive safety restraint device is critical. An RSM is designed to sense and predict rotational motion. The RSM is also designed to sense and measure certain vehicle inertia! conditions. One approach to rollover sensing involves the continuous calculation and prediction of crossing a static angular threshold. The static threshold is measured relative to an earth-based horizontal position. In order to reduce occupant injury during rollover events, in some roll events it is important to also predict, a small time in advance, the angular position of the vehicle prior to reaching a critical angular threshold. The goal is to develop an accurate rollover sensor that allows vehicle manufacturers to provide increased passenger safety over today's standard of automotive transportation. Primary Discrimination Path ■■■■■■■■■■■■■■■■■■ IIIIIIIIIIIB ! ANGULAR PRIMARY ' ' RATE DISCRIMINATION ; ; SENSOR MICRO- ' f ACTIVATE ' J CONTROLLER ; (COUNTERMEASURES/ ; » A : LOW-G ADC : LATERAL ^ ^ '• J ACCEL. ^ J ■ ! M ' DEPLOYMENT I " »-AND J- CONTROL j HIGH-G ^ ' ' ; LATERAL I I ACCEL. I : : SECONDARY - ^ j : ARMING PATH j LOW-G ^ : VERT. I : accel. : : Figure 4. Rollover sensing module block diagram. ROLLOVER SENSING COMPONENTS Figure 4 shows a block diagram of a typical RSM. This RSM uses an ARS, two low G accelerometers, and one high G accelerometer. Each of these sensors has an analog output proportional to the mechanical input being applied. The outputs are fed to an analog to digital converter (ADC) inside the microcontroller IC allowing the rollover detection algorithm to act on the measured signals. A family of rollover detection algorithms is discussed in further detail later in this discussion. Each of these sensors also has a "self tesť' feature. The self- test feature allows software in the microcontroller to force a signal to be output from each sensor. This is used to perform one of a number of diagnostics on the sensor to ensure proper operation. The sensor set and microcontroller in this example show the primary discrimination path. The primary discrimination path performs the accurate determination of a rollover event occurring. In addition, there is also a secondary path used to confirm an event is in progress. This secondary path is referred to as an arming function and is discussed further in the next section. Both the primary discrimination and secondary arming paths must agree an event is in progress before any counter measures will be activated. This confirmation typically occurs externally to the microcontroller in circuitry that provides the current or signal required to deploy, or activate, the countermeasures. ROLLOVER ARMING The design goals of an occupant restraint safety system include not only proper deployment when desired, but also preventing deployment when not desired. This goal is met with an arming feature. This means an effective system design protects against single-point failures, such as with a failed sensor or microcontroller. The means to perform this secondary sensing path may include hardware, software, or a combination of system interface inputs, (see Figure 4) The primary goals and purpose of the arming feature are: 1 . To arm or ready the rollover system for the desired trigger conditions. 2. To prevent undesired trigger commands due to single-point faults. 3. To prevent undesired trigger commands due to EMI (Electro-Magnetic Interference). 4. To maintain that the arming path signal is enabled prior to the discrimination path signal. 5. To include reliable diagnostics to determine if the arming path is functional. The arming function is preferentially implemented using sensors internal to the RSM such as accelerometers or a tilt switch. Data external to the RSM can also be used, such as: yaw rate, suspension mode, ABS activation, steering-wheel angle, tire pressure or vehicle speed. In summary, it is important that the rollover arming feature be evaluated on a system level basis, not only a product level. ROLLOVER SYSTEM ARCHITECTURE It is necessary to define the integration of the rollover sensing system with the existing frontal and side airbag electronics contained within the vehicle. A vehicle manufacturer may require a satellite rollover sensor acting as a plug 'n play device connecting to an existing frontal airbag controller system. The satellite rollover sensor may communicate, via a pre-defined communication bus, all critical rollover deployment and arming data to the frontal airbag controller, which would in-turn activate the necessary safety restraints, as shown in Figure 5 below. 67</page><page sequence="4">Figure 5. Frontal Airbag Controller with Rollover Satellite Sensor. This satellite rollover sensor would have the flexibility of being optional content on the vehicle. An example of a rollover satellite sensor is show in Figure 6. The rollover sensing satellite architecture may tend to be a higher overall cost due to the independent hardware, electronics, and communication interface that is required for a satellite rollover system. A second approach to incorporating rollover sensing in the vehicle involves the redesign of the existing frontal airbag controller to accommodate or upintegrate the necessary rollover hardware and software. This means the vehicle manufacturer provides frontal and rollover sensing in one controller instead of two. This redesign of the frontal airbag controller includes the addition of the rollover sensor(s), a potentially larger microcontroller to accommodate the rollover algorithm, diagnostics, and event recording, as well as a power supply to supply sufficient current to the additional electronics. This up- integration approach, although more design intensive up-front, should allow for a lower overall cost of adding rollover sensing. The up-integrated frontal airbag controller with rollover will generally require a slightly larger case to accommodate the additional components needed for rollover. With vehicle interior real estate at a premium, it may be easier to either package a single controller with a slightly larger footprint, or two individually packaged smaller controllers. Figure 6. Rollover Sensing Module (RSM) for rollover sensing and discrimination. A stand-alone, or satellite, module is pictured. SENSOR SELECTION Rollover sensors must provide key vehicle dynamic parameters that allow the sensing algorithm to estimate current and future states related to rollovers [5]. Vehicle angular positions, angular rates and angular accelerations are useful indicators for the rollover events. The required sensors may vary with particular vehicle applications, sensing configurations, and algorithms used. However, as a component of a vehicle safety system which may deploy one-time use pyrotechnic devices, the sensing unit must function properly under a wide range of automotive conditions. Due to the violent nature of rollover events, the sensor system must be immune to high g impacts and shocks. At the same time, rough road and severe maneuver conditions must not confuse the system. Inclinometers or tilt sensors are devices that can be used to measure vehicle angles. Among the many types of inclinometers, micromachined low-g (1-2g) accelerometers are the preferred choices for low cost, smaller package and consistent performance in an automotive environment. Since this type of angular position sensor is gravity based, it is intrinsically prone to errors when exposed to linear accelerations commonly occurring in automotive conditions. However, if sufficient filtering and averaging over time are used, the angular position sensors may directly provide useful vehicle roll angle data to the algorithm. In order to achieve better angular resolution, low-g accelerometers should be used. Sensor scale factors (sensitivity), noises and offsets (output with 0 g input) over temperature are key technical parameters to evaluate. Very often, the orientation of the sensing axis relative to the package can be important for the application. A critical sensor component in the rollover system is the angular rate sensor (ARS). Such sensors directly measure the changing rate of angular positions based 68</page><page sequence="5">on the Coriolis effect and usually have high immunity to linear accelerations. The vehicle angular position and angular acceleration information may be further obtained if needed, by integrating or differentiating the angular rate, respectively. However, integration of the angular rate over an extensive time period may cause unacceptable angular position errors. Differentiation of the angular rate could be noisy in reality. Well- conditioned low-g accelerometers may play useful roles in correcting the angular position errors caused by the long-term integration of the ARS. Since the ARS is the most critical sensor in the rollover sensing system, we will focus on the ARS evaluations and selections. There are a wide variety of ARS types ranging from commercial to military applications. The most common sensing element technologies used for automotive-grade ARS in the market are piezoelectric ceramic/metallic- alloy/quartz vibrating structures [31,32], piezoelectric crystal vibrating structures [33] and variations of micromachined structures [34, 35, 36]. The ceramic sensors have been widely used in automotive navigation and commercial applications and are modified for rollover applications. A mechanical shock and vibration isolation structure is usually required to improve the g sensitivity. The quartz tuning fork type sensors are typically more accurate and stable and have been used for automotive vehicle dynamic control and some military applications. Its higher sensor resonant frequency (typically &gt; 8kHz) makes it possible to be used as a rollover sensor without any mechanical damping structure. Micromachined sensors are newer technologies and many of them are still under development. They potentially can be made smaller, cheaper, and with better reliability. Because of their smaller mass, higher resonant frequencies (typically &gt; 10kHz), and, sometimes, symmetrical structures, those sensors can be intrinsically immune to high linear accelerations. Establishing a required specification would be the starting point of selecting the right sensor for rollover applications. It may take a few iterations through the development cycle to finalize the parameters. System analysis, simulation and testing are common vehicles to aid in this development. A well-defined sensor specification must support the capability and tolerance of the intended algorithm and the required system performance. At the same time, over-specification will limit the possible choices and increase the sensor cost or significantly delay the development. In general, the ARS input/output transfer function can be described approximately by a linear equation: (2) vOUT=vr+AK+wr+A&lt;xsF)xn+vn Where V0UT is the sensor output, V™m is the nominal offset, aļ™ is the nominal scale factor, AV0 is the offset error, AaSF is the scale factor error, Q is the angular rate input about the sensing axis, and Vn is the noise term. Since only the nominal values in Equation 2 are known, the sensor accuracy will be limited by the unknown variations. In general, those variations are temperature dependent and may be linear acceleration dependent. The variations also occur among different sensors. In addition, the transfer function Equation 2 holds true only if the input angular rate is within the specified bandwidth. Although there are many ARS issues in selecting the right sensor, Table 1 lists some of the key parameters that need to be determined and evaluated. A systematic measurement of most of the parameters listed here can be found in references [13,14], Sensing Range Offset Errors Scale Factor Errors Bandwidth Noise Orthogonality G-Sensitivity Self Diagnosis Table 1. Rate sensor key parameters for rollover applications. The sensing range defines the maximum angular rate that an ARS can measure. The rollover events may involve a roll rate up to 350 degree/second. However, higher sensing range will reduce the system resolution for a given ARS dynamic range (total output swing) and the digitized bits. Under non-rollover driving conditions, the accuracy and robustness of the system demand higher resolution. At the same time, the rollover sensing system typically makes decisions well before the vehicle reaches its peak roll rate. Therefore, it is not necessary for the ARS sensing range to cover the maximum vehicle roll rate. A typical sensing range for rollover discrimination may be +/- 200 to 300 degrees/second. The offset is the ARS output value without angular rate input. A nominal offset is the design target. An offset error can be further divided into static offset error and dynamic offset error. The static offset error is the zero- rate ARS output deviation from the nominal value at room temperature. This error varies from sensor to sensor due to calibration limits. The dynamic offset error is the offset drift over temperature or over time. If not compensated, these errors, especially the dynamic offset errors, may limit the measurement accuracy. In addition, the offset errors will cause the sensor to saturate asymmetrically and eventually may limit the allowable nominal scale factor or the sensing range. Scale factor (also called sensitivity) of an ARS is the sensor output change per unit input rotation rate in mV/(degree/second). Due to limitations in end-of-line trim in the sensor manufacturing process, the actual sensor scale factor varies around the designed nominal value. Furthermore, temperature variations cannot be totally eliminated. These variations introduce 69</page><page sequence="6">measurement errors in angular rate and may be difficult to be compensated for with algorithms. Combined with ARS output dynamic range and offset errors, the scale factor errors may cause the ARS to saturate asymmetrically and limit the maximum allowable nominal scale factor value or the sensing range. It is desirable to have a larger nominal scale factor with a given sensing range for higher sensing accuracy. However, the sensor dynamic range will limit the maximum scale factor. The bandwidth of a sensor characterizes its output frequency response to input signals. Ideally, the sensor should have a flat response within its operation frequency range. When the angular rate input frequency increases beyond the operational range (typically 0 to 25 Hz), the measured rate signal will suffer attenuation. It is also important that the ARS measures angular rate accurately even under high angular acceleration conditions during violent rollovers. At the same time, sensor noise levels increase with larger bandwidth. Some sensors use AC coupling to reduce the offset errors, but this technique also causes issues when the angular rate is constant over a certain time period. The overall system requirement must be used to determine the sensor bandwidth. Angular rate sensor noise level is one of the factors that limits the sensor resolution and accuracy. The noise characteristics include its frequency distribution, peak to peak level, and RMS (root mean square) level. All these parameters are important and in fact are related to each other. Since most rollover sensing systems utilize analog and digital filters, the RMS noise is more critical for rollover applications. As mentioned before, the RMS noise is related to the sensor bandwidth. The orthogonality describes the sensor sensitivity when angular rate input is applied in a direction orthogonal to its sensing axis. It is typically measured as a percentage of the orthogonal input angular rate. Such a cross-talk effect should be minimized. For example, a yaw rate when a vehicle makes turns should not translate into a roll rate that may indicate a potential rollover. G-sensitivity describes the immunity of an ARS to linear accelerations in degree/second/G. In other words, the ratio between the undesired angular rate output due to a linear acceleration input and the input g level measures the sensor's G-sensitivity. When exposed to linear accelerations, the sensor will produce false angular rate according to its G-sensitivity. Since the ARS is not designed to measure linear accelerations, its G- sensitivity is usually unknown until the complete sensor package is evaluated. In general, the G-sensitivity can be very nonlinear with the amplitude of the applied linear acceleration. For example, an ARS may show very little G-sensitivity below a g-level threshold and then quickly become saturated as the input G-levels increase beyond the threshold. The G-sensitivity may also depend on the direction of the applied acceleration relative to the sensing axis of the ARS. The waveform (duration and/or the frequency components) of the applied linear acceleration may also significantly affect the sensor G- sensitivity responses. Most of the responses of ARS do not have the same shape as the applied linear acceleration waveforms. The time characteristics of the response such as the phase and recovery time followed by the linear excitation must be considered in its G- sensitivity. Therefore, the G-sensitivity must be specified and evaluated with broad amplitude and spectrum waveforms in at least three orthogonal directions (including the sensing axis) that may be required by the application conditions. The self diagnosis of an ARS is its ability to detect a sensor fault conditions and to report the status to the sensing system. Since the rollover detection is a safety related application, the system must be notified if the sensing element is not working properly. A well designed self diagnosis system detects key and major failure modes of the sensor. The understanding of the self- diagnosis system also allows the designers to implement necessary arming mechanisms on the system level. DISCRIMINATION ALGORITHMS IDEAL TREATMENT - During a rollover event, when a vehicle is no longer constrained by the road surface, it can move and rotate with six degrees of freedom. Roll, pitch, and yaw motions can occur in any combination, along with translations along the longitudinal, lateral, and vertical axes of the vehicle. The key consideration in defining a rollover is the vehicle attitude with respect to an Earth-based coordinate system. Although in this discussion we are concerned primarily with roll angle, we must realize that real-world crash events can be much more complex, involving compound angles and winding paths. Therefore, before describing discrimination and deployment logic in a low-cost practical implementation, it is instructive to consider the ideal case, where complete information is assumed to be available. A theorem of Euler states that two coordinate systems can be brought into coincidence through a single rotation about an appropriate vector. In the case of interest, we wish to relate the vehicle coordinate system, which is native to the on-board sensors, with the Earth-based system. The use of quaternions [23] defines 4 numbers to create a singularity-free representation of this translation. As opposed to SAE angles [12], which lead to ambiguous representation under several classes of free-body movement, quaternions are based on a set of three numbers to define the rotation vector, and a fourth number for the degree of rotation about that vector. Now, we can define the relationship between these two coordinate systems for accelerations as well as for angular rates. 70</page><page sequence="7">ax = cosi|/cos0Ax +sin'ļ/cos0Ay -sin0Az (3) ay = (cos'1/sin0sin&lt;|)-sin'j/cos&lt;|))Ax + (cos '|/ cos (ļ) + sin Vļ/ sin 0 sin (|))A y + cos 0 sin &lt;ļ)Az az = (cos'|/sin0cos&lt;|&gt; + sini|/sin&lt;l))Ax + (sinvļ/sin0cos(ļ)-cosvļ/sin(ļ))Ay+cos0 cos &lt;ļ)Az where the angles and accelerations are as defined in equation (4). Relationship Between Body Angular Rates and Earth Angular Rates p = (j)-iļ/ sin# q = 0 cos ^ + ^ sinocos# r = Ý cos0cosé?-é?sin0 0 = /? + sin^tan#7 + cos^tan$- 0 = cos &lt;f)q-sm&lt;f)r 'j/ - sin (ļ) sec 8q + cos ^ sec dr PRACTICAL FACTORS - A ground vehicle is not intended to be a free body in space, so there are several complicating factors which must be considered in determining the correct attitude with respect to Earth. Inertial and gravitational forces can impart acceleration to the vehicle. Gravity is assumed to always equal 1 g, however, the Earth-based vertical acceleration can also include an inertial component, for example when cresting a hill, or bottoming out. Lateral inertial forces due to cornering are very common, and the on-board accelerometers will respond to this. In general, the resolution of gravity and inertial accelerations cannot be completely separated without additional information. During cornering maneuvers, one can assume that at any given moment the vehicle is following a path tangent to a circle. This allows us to estimate the centripetal acceleration in the lateral direction as the product of the yaw rate and the vehicle speed. Making a similar assumption for vertical motions, we can compute vertical centripetal acceleration as the product of the pitch rate and the vehicle speed. Longitudinal inertial forces can be estimated by the product of the longitudinal acceleration and the cosine of the current pitch angle. These relations are shown in the next set of equations. Other practical considerations include the case when the vehicle is airborne and all four wheels are off the ground. This is a rare event, but may be of great importance to sensing and discrimination, as such a case may immediately precede a rollover. When airborne, the net acceleration sensed on-board will be zero (ignoring resonances within the vehicle and atmospheric drag). During airborne events, which are typically of short duration (if of long duration, then we are unlikely to protect the occupants) the vehicle acts as a free body in space, and acceleration signals are unreliable. (5) Estimate Inertial Accelerations Estimated Vehicle Acceleration Simple (uncoupled): / ^ Estimated Pitch Angle Earth-Longitudinal 2 - me osc/ ñ Acceleration: Ax~uc - me osc/ ñ Earth-Lateral ^ ^ ? Acceleration: y ~ u Estimated Earth-based Yaw Rate Estimated Vehicle Speed Another related case is when the vehicle is being driven on a rough road, or is experiencing a violent form of abuse. Accelerometers used for rollover are typically of high sensitivity, and thus road noise may comprise a significant fraction of their dynamic range. When road noise overwhelms true gravitational and inertial accelerations, the contributions of the accelerometers must be discounted. The means of handling these scenarios is included in the next subsection. In any sensor element, there will always be errors arising due to offset, drift, noise, and sensitivity errors. These errors are typically part-dependent, temperature sensitive, non-linear, and cannot always be calibrated out. Furthermore, each sensor typically has a characteristic bandwidth over which readings are most reliable. For these reasons, as well as to prevent aliasing in digital systems, hardware and software filters are used to condition the sensor signals. BLENDING OPERATION - At a more fundamental level, the very nature of the accelerometer and ARS signals themselves are often complementary. Specifically, an ARS is responsive to rapid changes in vehicle attitude. This makes the ARS vitally important to sensing a rollover event. However, because the ARS signal must be integrated to obtain the current roll angle, the inherent error growth of the integration process may introduce a bias to the angle calculation. In a complementary sense, accelerometers may be overly-sensitive to short-duration noise, while over a longer period of time they will tend to accurately reflect the gross vehicle attitude. This is of primary importance in distinguishing the constant Earth gravity vector from the short-lived inertial accelerations due to driving. To take full advantage of this complementarity between accelerometers and ARS, a blending scheme is used in the calculation of angles. 71</page><page sequence="8">Figure 7 shows a graphical depiction of the blending operation. In a discrete-time processor, the roll angle is estimated at each iteration as a function of the previous iteration roll angle, plus the current values of the roll rate and acceleration-based roll angle. Note that in general, the number of previous time steps used is unbounded, however, for simplicity we consider a simple forward integration with blending. For the current time step (k+1), the current angle is computed based on two components. First, is the forward integration, where the product of the current angular rate value and the time increment are added to the previous angle. Second, the current roll angle is independently determined from the current value of the accelerometers, using the inverse functions of the equations (3) above. Third, the current angle is determined as a weighted sum of these two angle calculations (forward integration ARS-based and acceleration-based angles). The sum of the weighting coefficients is unity. However, the magnitude of the coefficient for the ARS-based angle is typically much larger than the coefficient for the acceleration-based angle. The operation of this blending calculation over time is equivalent to a high-pass filter on the ARS-based angle, and a low-pass filter on the acceleration-based angle. To illustrate this point, Figure 8 shows a Bode plot (amplitude versus frequency) of the two components of the blending calculation for the case of a time step of 0.01 seconds, and coefficients of 0.99 and 0.01 for the ARS-based and accelerometer-based angles, respectively. The cutoff frequency between the two regions is set by the relative coefficient weights, and is established by the bandwidths of the two types of sensors. As mentioned above, there are conditions where the acceleration- based angle may be unreliable, due to rough roads or an airborne condition. In these cases, the blending coefficient weighting is modified dynamically to reduce the influence of the acceleration-based angle. This has the effect of applying a lower cutoff frequency to that component of the blending, making the overall angle calculation less sensitive to the accelerometer noise [4,8]- SIMPLER APPROACHES - For automotive applications, cost pressures are an important practical consideration in developing rollover sensing systems. For instance, pitchover events are quite rare [37]. A sensing system designed for rollover only may therefore eschew the pitch ARS and the longitudinal accelerometer. Furthermore, in many of today's vehicles, yaw rate sensors are already available in traction control and navigation functions. Such systems typically also compute vehicle speed, for example from wheel speed sensors. Thus, we can envision a simpler algorithm wherein the yaw ARS is also omitted from the RSM. The yaw rate and vehicle speed can be supplied across a data bus, and used as input to the equations computing lateral inertial forces. Such a rollover detection system would of necessity have reduced functionality compared to a full six degree of freedom system, yet would be considerably more affordable to the end customer. Such a system would be relatively insensitive to pitch motions, and as a result rollover events involving significant vehicle pitch can be expected to experience some error in the angle calculation. However, for purely roll events, the performance will be identical with the complete system described above [5]. In the extreme case of a low-cost rollover system, an ARS only implementation is possible. For this case, the blending coefficient is effectively unity on the ARS-based angle. It is important in such a case to employ a high- pass filter on the ARS signal to prevent offsets and drifts in the sensor from causing an error in the angle. Because such a simple system has no independent means of determining the gravity vector it is a necessary assumption that over a long period of time, the net vehicle angle is zero degrees [9,11]. Nonetheless, for the vast majority of rollover events the performance of such a simple algorithm is adequate, as will be shown in the Results section below. 72</page><page sequence="9">Figure 7. Discrete time implementation of integration with angle blending. This is equivalent to a first-order Kaiman filter. - - - - Figure 8. Bode Plot of Blending Operation 73</page><page sequence="10">DISCRIMINATION AND DEPLOYMENT -The primary task of a rollover algorithm is twofold: deploy in a timely manner during a rollover event, and inhibit deployment during all other events. This ideal situation is easily specified, but very difficult to implement. In the universe of possible vehicle events, there will always be some degree of overlap in signal strengths and characteristics between rollover and non-rollover events. The fundamental reason for this overlap is that deployment times are always required prior to rollover (as defined above), and therefore require anticipation, or prediction, of the future course of the rollover event in progress. Obviously, there is a possibility that some external force or factor will prevent a rollover between the deployment time and the anticipated occurance of rollover. Given that a perfect rollover discrimination and deployment system is impossible in practice, then we must consider how best to optimize a practical system. One approach to anticipating rollover is to extrapolate the current conditions, and test whether those conditions will exceed the rollover threshold. The realization of this method involves adding to the current roll angle the product of the current roll rate and an extrapolation time. Clearly, the tradeoffs between timeliness and immunity lie in the selection of this extrapolation time. For rapid deployment of countermeasures, a long extrapolation time is desired, while for immunity, a short time is preferred. In one implementation of such a system, the extrapolation time is dynamically adjusted within preset bounds. The adjustment is determined by the value of lateral deceleration experienced by the vehicle, as described in reference [5]. The rationale for this choice is that rollover events span a dynamic range from 50 milliseconds to 2.5 seconds, with a key differentiating factor being the presence of a tripping mechanism. Tripped rollovers in general will occur faster than non- tripped rollovers. By sensing the lateral deceleration evident in a tripped rollover, the extrapolation time of the deployment decision can be dynamically adjusted towards the lower end of the present bounds. Such an algorithm has been tested on data from 200 actual events with satisfactory results. Another approach is to consider the doublet of the current roll angle and the current roll rate. These two factors are the primary variables in an energy balance equation relating the current attitude and motion of a vehicle to the energy required to achieve rollover. Consider the case of a vehicle on level ground suddenly experiencing a momentary vertical impulse on the underside of the vehicle, offset from the center of mass. A rotational moment will be induced. As the vehicle rotates, the kinetic energy of that impulse will convert to potential energy as the vehicle center of mass is raised and the roll angle increases. Thus, there is a curve which defines the tradeoff of kinetic and potential energies, which can be converted to a tradeoff between roll rate and roll angle. By defining this boundary within an RSM, a deployment can be commanded by detecting when the doublet of rate and angle exceed this boundary. Obviously, there are many ways to enhance this simple representation, which are described in references [9] and [11]. Once a deployment logic approach has been selected, the task of optimizing the algorithm for a given vehicle design is called the calibration. Algorithms typically include adjustable parameters which may be related to such vehicle characteristics as the static stability angle, the lateral stiffness, the maximum suspension travel, and dynamic factors such as active stability control. In addition, there will typically be some adjustment required to meet the occupant safety requirements of a given vehicle manufacturer, for which there is not presently a common standard for rollover. Results of a rollover discrimination and deployment algorithm are presented in the Results section below. MINIMUM ROLLOVER TEST SET Establishing a set of tests for a calibration is a considerable challenge, since the range of possible rollover and non-rollover events is unbounded. Nevertheless, it is a strong desire on the part of every vehicle manufacturer to use the minimum number of tests possible, especially tests which cause a vehicle to be destroyed. Some progress towards a minimum test set can be made by appealing to field-relevance. As described in other works [37], certain categories of rollover events are more prevalent than others, and these should be represented in a test suite. Another approach to determining a minimum set of tests for a rollover calibration is to focus on test which bracket the extremes of roll angle, roll rate, and pre-roll conditions. Further metrics may be considered, such as the monotonicity of the event, the level of noise, or non- roll signals that may corrupt the data, and the variety of physical motions involved (e.g. a corkscrew event versus a fallover). By combining calibration experience with field relevance, the following set of rollover tests is presented as the minimum required for a robust calibration. While this recommendation is by no means a guarantee of success, it strives to achieve a balance between sufficiency and the desire for the fewest number of tests. Table 2 describes 14 specific tests, six of which will result in a significant degree of vehicle damage (numbers 1-4, 6, 7). By judicious test procedures, it may be possible to further reduce the number of vehicles destroyed by, for example, using the drivers side for one test, and the passenger side for another. A priority is assigned to each test to roughly categorize their relative importance to the production of a robust calibration. 74</page><page sequence="11">Table 2. Minimum Recommended Test Set for Rollover (NT means No-Trigger) 75 Initial Barrier Test Angle Angle/Height Speed Deploy/NT Priority Slowest 1 Fallover Ditch 0 -50 degrees TBD Deploy 1 90 degrees, enough to Low Speed height to reach 20- 2 Curb Trip 0 engage wheel 25 degrees Threshold NT 1 . 90 degrees, Fastest Field- High Speed height to Relevant 3 Curb Trip 0 engage wheel 40 kph Deploy 1 ADAC or Corkscrew 4 Ramp 0 1.14 meter TBD Severe Deploy 1 enough to 50% Ramp reach 20- 5 Jump 0 0.2 meter 25 degrees Difficult NT 1 r~~ļ . . degrees, 10.2 Overly-Severe ■ 6 FMVSS 208 23 cm high 50 kph Deploy 2 high-friction Field-relevant 7 Friction Trip 0 flat surface 40 kph Deploy 2 various Cross Slope speeds up 8 Test 0 20 degrees to 60 kph Slowest NT 2 various NT to test High G Flat radius = 50 speeds up inertial 9 Turn 0 meters to 80 kph acceleration 3 various speeds Violent NT 100% Ramp below 50 invoving 110 Jump 0 0.2 meter kph airborne flight 3 Steep Down various NT to test pitch Slope with speeds up and vertical 11 Braking 0 2:1 slope down to 80 kph accel effects 3 gpSfi various NT test for real- jptSx Drive over speeds up life curb jumps 12 bump 0 0.15 meter to 80 kph or road bumps 3 13 Tire blowout 0 0 60 kph NT event 3 friction coef. I|S Spin ROUGH on ice 0 below 0.2 30 kph NT event 3 ROUGH ROAD * 1 and ABUSE I 0 I - 1-1 NT Immunity | 3</page><page sequence="12">SIMULATION ENVIRONMENT SENSOR MODELING - In a typical rollover program development, the vehicle manufacturer will provide test data from instrumented crash tests, such as the minimum set in Table 2. Instrumentation of interest for a deploy and discrimination algorithm include three axes of rotational rate, and three axes of acceleration. Because of limitations in the range and resolution of instrument- grade accelerometers, it is desirable to have accelerometers of both high range (35-100 g) and low range (1-5 g). However, in a practical automotive application, cost pressures preclude the use of instrument grade sensors which can cost hundreds of dollars each. Thus, it is necessary to model the non- ideal behavior of the automotive-grade sensors in order to predict system performance. Figure 9 shows a schematic diagram of the sensor set and hardware filters used in Figure 4 above. The model pictured is taken from Simulink, a time-based modeling tool available from The Mathworks, Inc. (Natick, Massachussets). When the instrument-grade signals are passed into the demultiplexer, and then distributed to the various sensor and filter models, they will process the signal according to their behavior, and provide output signals. These output signals are then fed into a simulation of an ADC, which is how an embedded microprocessor transforms analog sensor signals to digital representations. The algorithm then operates on the digital signals with a loop rate of 5 to 20 milliseconds. Figure 9. Hardware Model portion of ROIIover Simulation Environment (ROSE), including sensors and discrete component filters. More detail is shown in Figure 10, where the specifics of the roll rate sensor are shown for a generic sensor model. The signal path along the top of this figure includes: an offset voltage; the frequency response of the on-board filter (represented in the Laplace domain); the sensitivity or gain of the sensor; the clamping (or saturation) of the model when the signal exceeds the supply voltage; and a random number generator to model the mechanical and electrical noise of the system. Similar models exist for the various accelerometers and discrete component filters from Figure 9. ROLL RATE SENSOR MODEL ROUTŘATE SEÑÜD FREQUENCY GAIN " SATURATION ROLL RATE RESPONSE " , , Hr 2.5 NOISE BIAS CD LONGITUDINAL x_SENSITIVITY Go ► + LATERAL Y_SENSITIVITY CD VERTICAL Z_SENSITIVITY I Figure 10. Details of generic Roll Rate sensor model, including frequency characteristics, clamping, offset and linear acceleration sensitivity. Automotive applications typically involve dramatic ranges of temperature, such as -40 C through + 85C. Sensor characteristics will change throughout this wide range, and these variations must be accounted for in the models. Within each functional block of the sensor models, the characteristic parameters are entered as a variable. During simulation, it is a common practice to run each input test data set through both worst-case low and worst-case high scenarios. This allows the calibration engineer and the customer to agree on performance across the entire expected range of temperature, part-to-part variability, and component aging. ALGORITHM MODELING - Once the deployment and discrimination algorithm has been developed, it is coded suitable for an embedded microprocessor or application- specific integrated circuit (ASIC). This coding may take one of many forms, including assembly code, register transfer level description, C program code, or a graphical description language (e.g. Stateflow by The Mathworks, Inc.) which can be compiled onto the target application. After the instrument-grade test data has been processed through the sensor models, and now represents worst case high and low automotive-grade input, the algorithm performance is simulated. The output is typically either an indication of no trigger (NT) or a deployment time referenced to an arbitrary time-zero point defined during the rollover crash test. Figure 1 1 shows the flow of data through the entire simulation environment, including data conversion, parameter extraction, model and algorithm simulation, and report generation. 76</page><page sequence="13">Figure 1 1 . Data flow for Simulation Environment For rapid development of algorithms and calibrations, many of these functions can be automated. Data conversion can be done by hand, but is prone to error, and can be time consuming when there are many data files. Automated conversion routines avoid these errors, and also facilitate storage of data, which is typically hundreds of megabytes. Raw data can be archived with the conversion routine, instead of also saving the converted data. Parameters for the hardware models, as well as for the algorithm can be stored in a relational database, and interfaced with ActiveX controls to a Matlab simulation environment (Also by The Mathworks, Inc.) By writing script files that load the converted data, extract the various parameters, call the models, and run the algorithm, outputs can be written to another relational database. Report generation can also be automated to provide results in a format suitable to the customer's needs. In this way, a simulation environment allows rapid algorithm validation as well as short-turnaround calibrations when new data becomes available. RESULTS Of paramount importance in assessing a rollover algorithm is the performance against requirements. These requirements are derived from the physics of the crash, as well as the motion of anthropomorphic test devices [38]. The requirements are specified in a required time to fire (RTTF) for deployment events, or NT for events for which safety measures are not desired. It is important to realize that these requirements are not absolutes, but depend on interior geometry, countermeasure deployment times, and vehicle manufacturer philosophy. The job of the calibration engineer is then to meet these RTTF and NT requirements as nearly as possible. However, it should be realized that there can be, and often are, cases where the requirements conflict with each other. In such cases, it is important to balance the requirements of the customer with robustness of the algorithm and calibration. In this context, robustness is defined as the ability of the algorithm to generalize to new data, other than data used during the calibration. Towards this end, it is desirable to perform additional rollover tests, beyond the minimum test set of Table 2, for the purpose of validating the calibration. In some cases, it might be necessary to re-evaluate the RTTF and NT specifications with the available sensors and make tradeoffs between requirements and performance. Figure 12 shows a graphical output of the simulation environment. Four of these subplots show an overlay of the instrument-grade sensor input and the automotive- grade sensor model output (lighter color). The bottom center plot shows the output of the arming algorithm, using the scheme described in the above sections. The bottom right plot shows the integrated angles of the algorithm. The lower trace is the actual angle, and the upper trace shows the extrapolated angle according to the description in the Algorithm section above. The hashed lines indicate the point where the extrapolated angle equals the static stability angle and a deployment is commanded. The time of this crossing, relative to the time-zero point is then the deploy time. Figure 12. Rollover crash signals for four key sensors, including a subplot of arming activation and the roll angles (actual, estimated, and forward predicted). By running all available event data through the simulation environment, using worst-case high and low parameter settings for the hardware, a report is generated comparing deploy times to RTTF, and NT performance. When characterizing the NT events, a margin calculation is used to judge the gap between the extrapolated angle and the static stability angle. It is highly desirable to maximize this margin, while still meeting all RTTF on deploy events. When all requirements are met, the calibration is complete, and ready to download into the RSM. 77</page><page sequence="14">DISCUSSION Sensing of a rollover event is a complex task involving integration of a variety of functions and techniques. The fundamental challenge is to predict a rollover in advance of the vehicle reaching its static stability angle so that safety measures can be deployed quickly enough to provide protection to the occupants. A number of factors contribute to make this a challenging task. First, the electrical system must have an architecture that adequately senses the motions of the vehicle, and is able to elicit roll motion as cleanly as possible. The architecture of the design should provide immunity to single point failures as much as possible. The use of arming sensors and diagnostic logic is employed to help prevent inadvertent deployments in the event of a component failure. Sensors are the heart of the system, and the various non-idealities must be accounted for in the sensor selection and system design. A wide range of factors must be considered, ranging from temperature performance, manufacturing compatibility, signal range and resolution, and of course component cost. Ultimately, these sensor signals feed into an algorithm which must maximize the information content and process the data to provide an appropriate output. The algorithm should be based on vehicle physics (static and dynamic) to the greatest extent possible. Pattern- recognition techniques should be avoided when at all possible, since the universe of possible crash events can produce an unbounded array of inputs, some of which may give rise to undesired performance. An ideal algorithm, based on the methods of inertial navigation, can be envisioned, but must be tempered with the practical limits of the sensors, and the number of degrees of freedom which may be cost-effectively sensed. By making certain simplifying assumptions, the number of sensors can be reduced, and an array of algorithms provided. A reasonable course of action for implementation of practical rollover systems would be to introduce the product with a minimum number of sensors. As sensor costs decrease over time, and functional up-integration drives system costs down, more sensors can be added, allowing for more sophisticated algorithms. By appealing to rollover accident statistics, and by detailed investigation into the data signals from a large library of rollover events, it is possible to define a minimum set of rollover tests which need to be performed. Augmenting such a test suite, simulated rollovers can be generated using tools such as PC- Crash, MADYMO, PAM-CRASH and LS-DYNA. These tools can be helpful in augmenting actual test data, but at the current state of development are not sufficient to replace real-world tests. It may be anticipated that further developments in lumped-parameter and finite element models, these tools will allow more events to be simulated, thus dropping development costs. This capability would be of great benefit to calibrations, since a larger fraction of the universe of rollover and near- rollover events can then be explored. To facilitate the rapid development and deployment of rollover sensing systems, a simulation environment can be used to automate many mundane tasks. Recent advances in algorithm techniques have been applied to rollover, where algorithms are crafted in a graphical programming language, and program code is automatically generated for a target microprocessor. These techniques can reduce the development time, and facilitate an increased degree of testing, in a virtual environment, to give a greater assurance of first pass success. CONCLUSION In this treatment we have covered material sufficient to convey an understanding of the electronics and sensing of rollovers. These concepts can be extended to pitchover events with a simple change of coordinate reference frame. The methods described herein express a philosophy which emphasizes safety, reliability, robustness, and adherence to the laws of physics. There are other methods of achieving the same goals. However, the techniques and technologies described here have been proven in real-world rollover events where the results have matched simulation and also met the RTTF requirements. It should be remembered that the RSM is one component in an entire vehicle-wide safety system, which includes vehicle characteristics, interior dimensions, and the location and deployment behavior of the safety restraints. Occupant size, seating position, seat belt usage and the vehicle manuevering conditions prior to the event are also important factors. This is a very demanding situation, involving enough variability that a thorough approach is warranted. It is hoped that the reader finds such an approach sufficient. ACKNOWLEDGMENTS The authors gratefully acknowledge the work of David Braun and Jason Pearcy in developing the simulation environment. The algorithm concepts covered here are protected by patents. Please contact the authors for more information. 78</page><page sequence="15">REFERENCES 1. Tony Gioustos, US Patent 5,610,575, "Method and System for Detecting Vehicle Roll-Over". 2. Andrew B. Dunwoody and Donald S. Stern, US Patent 5,825,284, "System and Method for the Detection of Vehicle Rollover Conditions". 3. Peter T. Halasz, US Patent 5,890,084, "Controller for Vehicular Safety Device." 4. Jan K. Schlffmann. US Patent 6,002,974, "Vehicle Rollover Sensing Using Extended Kaiman Filter". 5. Jan K. Schiffmann. US Patent 6,002,975, "Vehicle Rollover Sensing". 6. Volker Breunig, et. al., US Patent 6,055,472, "Arrangement for Detecting Motor-Vehicle Roll- Overs". 7. Jan K. Schiffmann. US Patent 6,038,495, "Vehicle Rollover Sensing Using Short-Term Integration". 8. Jan K. Schlffmann, US Patent 6,292, 759, "Vehicle Attitude Angle Estimation Using Sensed Signal Blending". 9. Peter J. Schubert, et. al. US Patent 6.542,792, "Vehicle Rollover Detection Apparatus and Method". 10. Peter J. Schubert, US Patent Pending. 11. Peter J. Schubert and Charles A. Cluff, US Patent 6,584,388, "Adaptive Rollover Detection Apparatus and Method." 12. Thomas Gillespie, Fundamentals of Vehicle Dynamics, Society of Automotive Engineers, Warrendale, PA, 1992. 13. Henry Kong and Andrew Betts, "Cancellation of Unknown Angular Rate Effects In Linear G Sensitivity Testing for Angular Rate Sensors," SAE technical paper series #2000-01-0056, March 2000. 14. Henry Kong and Edward Wallner, "Automotive Rollover Angular Rate Sensors," SAE #1999-01- 0430: 15. Edward Wallner and Jan Schiffmann, "Automotive Rollover Sensing," (Advanced Microsystems for Automotive Applications 2000). 16. Edward Wallner and Jan Schlffmann, "Development of an Automotive Rollove Sensor," SAE #2000-01- 1651. 17. M. Gopal, S. Rohr, M. Fitch, E. Wallner, "Challenges in Simulation and Sensor Development for Occupant Protection in Rollover Accidents", SAE #2000-01- C038: 18. M. Gopal, E. Wallner, C. Parenteau, G. Nilson "Vehicle Rollover Events: A Challenge for an Integrated Occupant Safety System", Airbag 2000 Conference. 19. A. Pascoal, I. Kaminer, P. Oliveira, "Navigation System Design using Time-Varying Complementary Filters," In IEEE Trans. Aerospace and Electronic Systems vol. 36, no. 4, Oct 2000. 20. Karen K. Ajluni, "Rollover Potential of Vehicles on Embankments, Sideslopes, and Other Roadside Features," Public Roads, Vol. 52, No. 4, March 1989. 21. P.E.M. Frere, "Problems of Using Accelerometers to Measure Angular Rate In Automobiles," Sensors and Actuators A, 25-27, pgs 821-824, 1991. 22. George M. Siourls, "Aerospace Avionics Systems: A Modern Synthesis," Academic Press, 1993, section 2.5. 23. "Vehicle Dynamics Terminology," SAE J670e, Society of Automotive Engineers, Warrendale, PA. 24. Donald L. Nordeen, "Vehicle Directional Control Equations for An Inclined Roll Axis," A-2165, General Motors Proving Ground, July 1969. 25. American Association of State Highway and Transportation Officials, A Policy on Geometric Design of Highways and Streets, USA, 1995. 26. "Fundamentals of Vehicle Directional Control," Class Notes, Vehicle Handling, Current Product Enaineerina, General Motors Cora.. 1991. 27. Gelb, A., Applied Optimal Estimation, M.l.T. Press, Cambridge, Mass., 1986. 28. Bar-Shalom, Y. and Fortmann, T., Tracking and Data Association, Academic Press, San Diego, 1988. 29. Allen, R. Wade, et al, "Vehicle Dynamic Stability and Rollover," DOT HS 807 956, June 1992. 30. Simons, D. "Kaiman Filtering," Embedded Systems, June 2001 . 31. Junlchl Yukawa et. al, "Angular Rate Sensor for Dynamic Chassis Control," SAE Technical Paper #980269, 1998. 32. Toshihiko Ichinose and Jiro Terada, "Angular Rate Sensor for Automotive Application," SAE Technical Paper #950535, 1995. 33. Peter Steiner and Stefan M. Schwehr, Springer Series, Advanced Microsystems for Automotive Applications 98, pp. 24-29, D.E. Ricken and W. Gessner Eds, 1998. 34. J. D. Johnson, S. Z. Zarabadi, D. R. Sparks, "Surface Mlcromachined Angular Rate Sensor," SAE Technical Paper #950538, 1995. 35. J. Soderkvist, "Micromachined Gyroscopes", Sensors and Actuators A, pp. 65-71 , 1994. 36. Thor Juneau and A. P. Pisano, "Micromachined Dual Input Axis Angular Rate Sensor", Solid-State Sensor and Actuators Workshop, Hilton Head, 1996. 37. Parenteau, C.S., Lenard, T.P., "US and UK Field Rollover Characteristics," SAE 2001-01-0167, (updated), March 2001 . 38. Gopal, M., et. al., "Occupant and Vehicle Responses in Rollover Crashes," to be published as an SAE Technical Paper In 2004. CONTACT Peter J. Schubert, Ph.D. Restraint Systems Electronics Delphi Delco Electronics Systems Kokomo, Indiana 46904-9005 765-451-5925 fax 3600 peter.j .schubert@delphiauto.com 79</page></plain_text>