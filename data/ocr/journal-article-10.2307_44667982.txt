<plain_text><page sequence="1">1999-01-0707 Use of a Kaiman Filter to Improve the Estimation of ATD Response During Impact Copyright © 1999 Society of Automotive Engineers, Inc. Guy S. Nusholtz DaimlerChrysler Corporation Luis C. Cattani and Paul J. Eagle University of Detroit Mercy ABSTRACT A new approach for improving estimates of the kinematic response of ATDs (anthropomorphic test devices) to vehicle crash events has been developed. This approach employs the Kaiman Filter; a state model based estima- tion approach that has been widely applied to system dynamics problems ranging from navigation to missile guidance. The Kaiman Filter approach combines mea- surements of crash event phenomena (acceleration and displacement), kinematic models of ATD behavior and statistics of sensor noise to create precise estimates of ATD motion during a crash. This paper presents an implementation of a state model and Kaiman Filter for a sensor data collected from the chest of an ATD during an out-of-position airbag deployment test. Favorable com- parisons are made between the Kaiman Filter model approach and traditional methods involving numerical integration and differentiation. INTRODUCTION Reporting the response of an ATD (anthropomorphic test device) to an impact event typically requires measure- ment of certain phenomena (acceleration and displace- ment) and estimation of others (velocity). Velocity is an important parameter to measure in certain crash tests, particularly those where differential motion of the chest is concerned. The chest cavity and associated internal organs represents a viscous environment. Reactive forces on internal organs can be a function of both chest deflection and their velocity relative to their fluid sur- roundings. An accurate way of estimating chest veloci- ties, such as the velocity of the sternum relative to the spine, is necessary in order to assess the injury potential [1-4]. Velocity is typically derived from accelerometers, dis- placement transducers or film analysis by means of vari- ous algorithms. There are few sensors that provide direct measurement of velocity. Furthermore, there are no direct measurement velocity transducers currently used in standard vehicle crash applications. Each commonly employed method of estimating velocity from related phe- nomena is subject to interpretation and measurement noise. Numerical differentiation of displacement data is inherently noisy and requires application of filtering tech- niques such as exponential smoothing, moving averaging or other "low pass" filtering strategies. Numerical integra- tion of accelerometer data is subject to drift, time shifting and emphasizes any steady state errors that may exist in the system. Film analysis is labor intensive and, at best, a coarse approximation of the actual kinematics of the event. A standard and scientifically sound approach to estimat- ing the velocities of ATD elements is necessary. This method is both accurate and traceable to the first princi- ples of physics. Kaiman Filter estimators can provide bet- ter insights into the motion of an ATD during a crash than directly observed sensor channels or filtered estimates of sensor data. This is possible due to the coupling of related observations such as acceleration and displace- ment through the state model. As a result, the injury potential of certain crash events can be more accurately characterized. STATE MODELING TECHNIQUES State models are a way to estimate the dynamics of a system. State models are common tools used in modern control theory and have been applied in numerous air- craft systems and, more recently, automotive systems, including emissions control algorithms. A state charac- terizes a dynamic system at some point in time (e.g., position and its time derivatives). An example of a state is the rectilinear kinematics of a particle, x: X X = X (1) 1092</page><page sequence="2">The column of observations suggests that the state is a vector. The state model is typically expressed in vector/ matrix formulations. The state model is a description of how the dynamics of a system is propagated over time. The modeling of a sys- tem involves determining the state transition equations. Typically, these are taken from equations of motions based on the kinematics (motion) or the kinetics (force/ motion relationships) of a system. Each state can be related to the other states by a relationship from an equa- tion of motion or an approximation made from empirical observations of a system. A simple state model for the rectilinear kinematics of a particle is given by: x, = X = Position x2 = X, = Velocity Xj - x2 - Acceleration X4 = X, =" Jerk" (2) The state of the system appears as the variables x1 ... x4. The equations of motion that describe the interrela- tionship of these variables comprise the state transition model. The state model is the combination of the state transition (how position is related to velocity, etc.), any deterministic input (such as an actuator that could drive a component from one position to the next) and the noises that corrupt the states (the system or process noise). A complete state model is shown below: X = Ax + Bu + Gw (3) The state change is determined by the state transition model (the product of A and x), the deterministic input, u, and the effect of system noise, w. B and G are used to scale the input and the noise to match the dimensions of the state. The system noise is a way to describe or com- pensate for systems that are poorly understood or inade- quately modeled. A state model that is corrupted by system noise with a large standard deviation is one that does not have a good dynamic model to describe its per- formance. The states can be measured directly or related indirectly to measurements made on the system. An example would be the relationship between the state of a vehicle (position, velocity and acceleration) and a measured phe- nomenon of motion (acceleration). A typical model for measurements in a state model format would be: z = Hx + v The measured phenomena (z) are related to the state (x) by a transformation, H. The observer sees measure- ments of the state that are corrupted by measurement noise, v. The measurement noise is a way of describing the disturbances that typically corrupt a sensor (mechan- ical or electrical interference). A measurement model corrupted by a large standard deviation measurement noise is one that has sensors providing data subject to significant interference. KALMAN FILTER ESTIMATORS Kaiman filters are tools for estimating the states of a dynamic system from available data. Kaiman filters are applied to problems where noisy, uncertain measure- ments are taken from a dynamic system and states must be estimated. These filters or estimators use a standard algorithm for state estimation that is customized based on the state transition and measurement model that applies to a specific system. These estimators provide a powerful (and possibly optimal, under certain conditions) means of dealing with: • Uncertain systems (systems that are not well under- stood and corrupted with system or process noise) • Uncertain measurements (observations that are cor- rupted by measurement noise) [5,6]. A Kaiman Filter can be applied in real time or as a way of post processing measurements. Typical applications for Kaiman Filters include: • ICBM Systems: Noisy measurements of missile acceleration are used in conjunction with a ballistic model to guide a missile. • Ground to Air Defense: Limited, noisy radar mea- surements are used to track a target (e.g., Patriot) • Aircraft Navigation: Locations are estimated based on speed, attitude and heading [6]. The Kaiman Filter is a well-documented algorithm for continuous and digital systems. There are several mod- eling environments that directly support its implementa- tion (e.g., MATLAB, Simulink and others). The process is illustrated in the flowchart below [7]: Initialize State and Error Statistics Introduce Measurement (z) ' 1 Extract State Estimate (x) _► Compute Kaiman ,r Update State Estimate Update State ~~+ Gain (Kk) with Measurement (zk) Error Statistics (P^) MEASUREMENT UPDATE (Uses observations of sensor data in conjunction with the kinematic model to create optimal state estimates) TIME UPDATE (Uses the kinematic model of the system to anticipate the state at the next interval of time) Use System Model to Use System Model (Kinematics) - Project State Error Statistics to Project the State * Forward in Time (Pk+1 ) Forward in Time (x k+i ) Figure 1 . Kaiman Filter Algorithm The Kaiman Filter operates recursively with a new mea- surement and a new estimate of the system dynamics being used to update the state at each time step. The input to the system is the measurements. The output is the estimate of the state at each time step. Implementing the algorithm is a straightforward proce- dure. However, significant engineering insight is neces- sary to apply the algorithm to a specific system. There 1093</page><page sequence="3">are several key elements to the implementation of a suc- cessful Kaiman Filter: • A reasonable state model must be created. These result from an understanding of the dynamics of the system and are generally traceable to the first princi- ples of physics. Some models are widely known for simple systems (e.g., a particle subject to a constant acceleration). • The system model must be "tuned." The tuning pro- cess requires an understanding of the system or pro- cess noise. The variance of the system noise needs to be selected. A large magnitude noise indicates that the state model is not very accurate. This does not necessarily mean that the Kaiman Filter will not provide good state estimates. The Kaiman Filter is capable of producing accurate state estimates if the system noise is properly characterized. This will fre- quently require experimental trials to effectively test the model accuracy. The amount the deviation between the actual system performance is stationary (i.e., does not vary significantly over time), the Kai- man Filter can apply measurements to create very good state estimates. • The measurement model must be tuned. The pro- cess requires an understanding the measurement noise. The variance of the measurement noise must be selected. A large magnitude measurement noise indicates that the sensors used to observe the sys- tem are highly corrupted. As with system noise, this does not meet that good estimates cannot be derived from the Kaiman Filter. Kaiman Filter estimators can produce highly accurate state estimates provided that the sensors are well understood and are subject to noise that has observable statistics. Generally, the tuning of the measurement model is much easier than the system model because the sensors are generally well understood devices and experimental techniques exist to provide accurate characterizations of sensor performance. ESTIMATION OF ATD RESPONSE One potential application for the Kaiman Filter approach is to estimate the velocities in the chest cavity of an ATD ("crash test dummy"). The chest velocity is difficult to accurately derive from sensor data collected from a typi- cal test. Typically accepted instrumentation for estimat- ing velocities in the chest of an ATD is: • accelerometers mounted to the sternum and spine • displacement transducers mounted between the ster- num and spine Each of these transducers is indirectly related to chest velocities. Current chest velocity estimation techniques typically use: • numerical integration of the difference between the chest and spine acceleration measurement channels • numerical differentiation of the displacement mea- surement channel Each of these approaches is problematic. The numerical integration is prone to drift, time shifting and accumula- tion of steady state error (the chest motion has stopped; yet, the velocity estimate shows motion is still occurring). The numerical differentiation, like virtually all numerical derivatives, is highly noisy. The following presents two examples of the types of faults that result from these numerical estimates. The examples are selected to represent extremes in condi- tions. The first example is based on an airbag deploy- ment on a 50th Percentile Male NHTSA Advanced ATD (TAD). This is a standard in-position test under the con- ditions of a standard 30-MPH crash test. This example is characterized by small deflections; consequently, the full- scale gain is set very high, resulting in a noisy signal. The second example is an out-of-position test with a 3- year-old ATD brought in contact with the airbag module while in a static test buck. This example is characterized by very high velocity changes in a small time interval. In each case, the displacement represents motion of the sternum with respect to the spine. The acceleration is the difference of the sternum and spine motion. Filtering of each data set followed SAE J21 1 guidelines. IN-POSITION EXAMPLE - Figures 2 and 3 show the sternum acceleration and displacement for the standard In-Position test. The chest motion begins at about 0.04 seconds. The acceleration profile indicates that the motion of the chest began at approximately 0.04 seconds into the test and that the sternum undergoes significant variations in acceleration during the event. As would be expected in this type of test, the overall deflection of the chest is relatively small. Figure 2. Sternum Acceleration 1094</page><page sequence="4">Figure 3. Sternum Displacement The typical estimates of velocity extracted from the accel- erometer and displacement transducer are illustrated in Figure 4. Figure 4. Velocity Comparisons The derivative of the displacement shows a large signal to noise ratio that basically occludes a reasonable esti- mate of velocity. The integral of acceleration exhibits sig- nificant accumulated error over time Various ad hoc strategies can be employed to correct the errors in the estimates of velocity based on displacement and acceleration measurements. Some common approaches include applying low pass filters to the noisy velocity measurements and using a moving average smoothing technique. The low pass filter approach requires the judicious selection of a break frequencies and number of poles. The moving average approach is highly dependent on the interval selected for the averag- ing. In both cases, parameter selection is subjective and results are inevitably corrupted by time shifts and attenu- ation of important information. Ultimately, these strate- gies are difficult to trace to first principles and find consensus among various strategists. KALMAN FILTER APPROACH TO VELOCITY ESTIMATION A Kaiman Filter approach has been applied to the esti- mation of ATD response. A state model was formulated that consisted of the equations of motion for position and the three corresponding time derivatives (velocity, accel- eration and jerk). This model was used in conjunction with observations of acceleration and position to produce estimates of the state (position, velocity and accelera- tion). The resulting estimates of velocity were compared to the estimates derived from numerical integration and differentiation of transducer measurements. Figure 5. Kaiman Filter Estimates Figure 5 shows a comparison of the velocity estimates made by numerical integration, numerical differentiation and the Kaiman Filter. The comparison of three estimation techniques shows the limitations of the numerical differentiation and integra- tion techniques. The Kaiman filter estimates clearly tracks the centroid of the derivative estimate, changing direction in a synchronized fashion with the derivative. The derivative does not tend to mask the underlying dynamics of the velocity profile and the Kaiman filter esti- mate clearly tracks them without time shifts. The signal to noise ratio of the Kaiman filter estimate is nearly an order of magnitude smaller than that exhibited by the numerical differentiation technique. The effects of the time shift and error accumulations in the numerical inte- gration technique are also shown clearly. The large changes in direction occur in the profile between 0.06 and 0.10 seconds are time shifted by nearly 0.02 sec- onds in the integral estimate. The comparisons are open to significant debate since there is no "ground truth" for the velocity. There is no direct measurement of velocity available to use as a baseline. Fortunately, there is one additional comparison that can be made to help provide some validity to the Kai- man Filter estimate. The Kaiman Filter also produces estimates of position and acceleration (adjusted by the state model for the influence of process and measure- ment noise) as well as the velocity. These three kine- matic quantities can be compared to illustrate the effectiveness of the Kaiman Filter approach as shown in Figure 6. The position and velocity are scaled so that they can be compared on the same graph. The time phasing of the kinematics follows basic principles of physics. The pro- files exhibit rapidly changing kinematics between 0.05 and 0.10 seconds. During this interval, when the dis- placement is maximum, the velocity crosses zero (the 1095</page><page sequence="5">time axis). Similarly, when the velocity is maximum or minimum, the acceleration crosses zero. These observa- tions help confirm the proper time phasing of the three kinematic quantities. Similar analysis can be done that will confirm the proper magnitudes of the quantities (using numerical integration of the acceleration and com- paring the magnitude of the result to the estimated veloc- ity). These comparisons are also favorable. Figure 6. Kinematic Comparisons OUT-OF-POSITION TEST - The technique was also applied to the demanding dynamic conditions of an Out- of-Position test with a 3-Year-Old ATD. The sternum acceleration and displacement (found in the same way as in the In-Position test) are shown in Figures 7 and 8. The comparisons of chest velocity estimates derived from numerical differentiation and integration are shown in Figure 9. 3 Year Old Out-of-Position - Sternum Acceleration 2000000 • 0 1 &gt; 1 , 1 , 1 , 1 £ ) 0.005 0.01 0.015 0.02 0.025 0.03 0.035 0.04 0.045 0.)5 I -2000000 ■ E E "g -4000000 - I -6000000 - -8000000 - -10000000 - -12000000 Time [sec] Figure 7. Acceleration Measurement Figure 8. Displacement Measurement Figure 9. Velocity Comparisons The corresponding Kaiman Filter estimates of displace- ment, velocity and acceleration are shown in Figure 10. As is the case with the In-Position test, the kinematic quantities have the appropriate time phasing to make them internally consistent. FigurelO. Kinematic Comparisons CONCLUSION The state model approach offers an accurate means of estimating quantities related to ATD response, such as velocity, that are difficult to measure directly. The state model/Kalman Filter approach can provide a standard- ized approach to estimating velocities and other dynamic responses. The standardization or wide acceptance could be made possible by the treaceability of the approach to the first principles. Ultimately, this approach could provide a way to gain a better understanding of the response of an ATD to a crash event and the associated mechanisms of injury. REFERENCES 1. Lau, I.V. and Viano, D.C., The Viscous Criterion - Bases and Applications of an Injury Severity Index for Soft Tis- sues. Thirteenth Stapp Car Crash Conference. SAE Paper 861882, 1986. 2. Lau, I.V and Viano, D.C., Influence of Impact Velocity on the Severity of Nonpenetrating Hepatic Injury, J. Trauma, 21, 115-123. 1096</page><page sequence="6">3. Kroell, C.K., Allen, S.D., Warner, C.Y. and Perl, T.R., Inter- relationship of Velocity and Chest Compression in Blunt Thoracic Impact to Swine II. Thirteenth Stapp Car Crash Conference, SAE Paper 861 881, 1986. 4. Rouhana, S.W., Lau, I.V. and Ridella, S.A., Influence of Velocity and Forced Compression on the Severity of Abdominal Injury in Blunt, Nonpenetrating Lateral Impact, J. Trauma, 25, 490-500, 1985. 5. Kaiman, R.E., "A New Approach to Linear Filtering and Prediction Problems," Trans. ASME J. Basic Eng., 82, 34- 35, 1960. 6. Gleb, A., ed., Applied Optimal Estimation, Cambridge, Massachusetts: MIT Press, 1974. 7. Lewis, F.L, Optimal Estimation, New York: Wiley, 1986. 1097</page></plain_text>